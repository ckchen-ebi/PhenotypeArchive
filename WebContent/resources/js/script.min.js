if(typeof(window.MDOC)==="undefined"){window.MDOC={}}var defaultDesc="Brief info about this panel";MDOC.gene={generalPanel:defaultDesc,generalPanelDocUrl:"/data/documentation/geneGeneralPanel.html",preQcPanel:defaultDesc,preQcPanelDocUrl:"/data/documentation/preQcPanel.html",mpPanel:defaultDesc,mpPanelDocUrl:"/data/documentation/geneMpPanel.html",imagePanel:defaultDesc,imagePanelDocUrl:"/data/documentation/geneImagePanel.html",expressionPanel:defaultDesc,expressionPanelDocUrl:"/data/documentation/geneExpressionPanel.html",allelePanel:defaultDesc,allelePanelDocUrl:"/data/documentation/allelePanel.html"};MDOC.mp={generalPanel:defaultDesc,generalPanelDocUrl:"/data/documentation/mpGeneralPanel.html",genePanel:defaultDesc,genePanelDocUrl:"/data/documentation/mpGenePanel.html",relatedMpPanel:defaultDesc,relatedMpPanelDocUrl:"/data/documentation/relatedMpPanel.html",imagePanel:defaultDesc,imagePanelDocUrl:"/data/documentation/mpImagePanel.html"};MDOC.ma={generalPanel:defaultDesc,generalPanelDocUrl:"/data/documentation/maGeneralPanel.html",mpPanel:defaultDesc,mpPanelDocUrl:"/data/documentation/maMpPanel.html",relatedMaPanel:defaultDesc,relatedMaPanelDocUrl:"/data/documentation/maRelatedMaPanel.html",expressionPanel:defaultDesc,expressionPanelDocUrl:"/data/documentation/maExpressionPanel.html"};if(typeof(window.MPI2)==="undefined"){window.MPI2={}}MPI2.buttCount=0;MPI2.searchAndFacetConfig={};var config=MPI2.searchAndFacetConfig;if(typeof solrUrl=="undefined"){solrUrl="/data/solr"}if(typeof baseUrl=="undefined"){baseUrl="/data"}config.lastParams=false;config.cores=["gene","mp","ma","pipeline","images"];config.restfulPrefix={gene:"genes",mp:"phenotypes",ma:"anatomy"};config.geneStatuses=["Phenotype Data Available","Mice Produced","Assigned for Mouse Production and Phenotyping","ES Cells Produced","Assigned for ES Cell Production","Not Assigned for ES Cell Production"];config.phenotypingStatuses={Complete:{fq:"imits_phenotype_complete",val:1},Started:{fq:"imits_phenotype_started",val:1},"Attempt Registered":{fq:"imits_phenotype_status",val:"Phenotype Attempt Registered"}};config.solrBaseURL_bytemark=solrUrl+"/";config.solrBaseURL_ebi=solrUrl+"/";config.searchSpin="<img src='img/loading_small.gif' />";config.spinner="<img src='img/loading_small.gif' /> Processing search ...";config.spinnerExport="<img src='img/loading_small.gif' /> Processing data for export, please do not interrupt ... ";config.endOfSearch="Search result";var path=window.location.pathname.replace(/^\//,"");path="/"+path.substring(0,path.indexOf("/"));var trailingPath="/search";var trailingPathDataTable="/dataTable";config.pathname=typeof baseUrl=="undefined"?path+trailingPath:baseUrl+trailingPath;config.dataTablePath=typeof baseUrl=="undefined"?path+trailingPathDataTable:baseUrl+trailingPathDataTable;var commonSolrParams={qf:"auto_suggest",defType:"edismax",wt:"json",rows:0};config.commonSolrParams=commonSolrParams;config.facetParams={geneFacet:{type:"genes",solrCoreName:"gene",tableCols:3,tableHeader:"<thead><th>Gene</th><th>Mouse Production Status</th><th>Phenotyping Status</th><th>Register for Updates</th></thead>",fq:undefined,qf:"marker_symbol^100.0 human_gene_symbol^90.0 marker_name^10.0 allele^10 marker_synonym mgi_accession_id auto_suggest",gridName:"geneGrid",gridFields:"marker_symbol,marker_synonym,marker_name,status,human_gene_symbol",filterParams:{fq:'marker_type:* -marker_type:"heritable phenotypic marker"',qf:"marker_symbol^100.0 human_gene_symbol^90.0 marker_name^10.0 marker_synonym mgi_accession_id auto_suggest",bq:'marker_type:"protein coding gene"^100'},srchParams:$.extend({},commonSolrParams,{fq:'marker_type:* -marker_type:"heritable phenotypic marker"'}),subFacet_filter_params:"",breadCrumbLabel:"Genes"},pipelineFacet:{type:"procedures",solrCoreName:"pipeline",tableCols:3,tableHeader:"<thead><th>Parameter</th><th>Procedure</th><th>Pipeline</th></thead>",fq:"pipeline_stable_id:IMPC_001",qf:"auto_suggest",defType:"edismax",wt:"json",gridFields:"parameter_name,procedure_name,pipeline_name",gridName:"pipelineGrid",filterParams:{fq:"pipeline_stable_id:IMPC_001"},breadCrumbLabel:"Procedures",srchParams:$.extend({},commonSolrParams,{fq:"pipeline_stable_id:IMPC_001"})},mpFacet:{type:"phenotypes",solrCoreName:"mp",tableCols:2,tableHeader:"<thead><th>Phenotype</th><th>Definition</th></thead>",fq:"ontology_subset:*",qf:"auto_suggest",defType:"edismax",wt:"json",gridFields:"ma_term,ma_id",gridName:"mpGrid",topLevelName:"",ontology:"mp",breadCrumbLabel:"Phenotypes",filterParams:{fq:"ontology_subset:*",fl:"mp_id,mp_term,mp_definition,top_level_mp_term"},srchParams:$.extend({},commonSolrParams,{fq:"ontology_subset:*"})},maFacet:{type:"tissues",solrCoreName:"ma",tableCols:1,tableHeader:"<thead><th>Anatomy</th></thead>",fq:"ontology_subset:IMPC_Terms AND selected_top_level_ma_term:*",qf:"auto_suggest",defType:"edismax",wt:"json",gridFields:"",gridName:"maGrid",topLevelName:"",ontology:"ma",breadCrumbLabel:"Anatomy",filterParams:{fq:"ontology_subset:IMPC_Terms AND selected_top_level_ma_term:*",fl:"ma_id,ma_term,child_ma_id,child_ma_term,child_ma_idTerm,selected_top_level_ma_term,selected_top_level_ma_id"},srchParams:$.extend({},commonSolrParams)},imagesFacet:{type:"images",solrCoreName:"images",tableCols:2,tableHeader:"<thead><th>Name</th><th>Example Images</th></thead>",fq:"annotationTermId:M* OR expName:* OR symbol:* OR higherLevelMaTermName:* OR higherLevelMpTermName:*",qf:"auto_suggest",defType:"edismax",wt:"json",gridFields:"annotationTermId,annotationTermName,expName,symbol_gene,smallThumbnailFilePath,largeThumbnailFilePath",gridName:"imagesGrid",topLevelName:"",imgViewSwitcherDisplay:"Annotation View",forceReloadImageDataTable:false,showImgView:true,breadCrumbLabel:"Images",filterParams:{fq:"annotationTermId:M* OR expName:* OR symbol:* OR higherLevelMaTermName:* OR higherLevelMpTermName:*"},srchParams:$.extend({},commonSolrParams,{fl:"higherLevelMaTermName,higherLevelMpTermName,annotationTermId,annotationTermName,expName,symbol"})}};(function(window,document,undefined){(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{if(jQuery&&!jQuery.fn.dataTable){factory(jQuery)}}}(function($){var DataTable=function(oInit){function _fnAddColumn(oSettings,nTh){var oDefaults=DataTable.defaults.columns;var iCol=oSettings.aoColumns.length;var oCol=$.extend({},DataTable.models.oColumn,oDefaults,{sSortingClass:oSettings.oClasses.sSortable,sSortingClassJUI:oSettings.oClasses.sSortJUI,nTh:nTh?nTh:document.createElement("th"),sTitle:oDefaults.sTitle?oDefaults.sTitle:nTh?nTh.innerHTML:"",aDataSort:oDefaults.aDataSort?oDefaults.aDataSort:[iCol],mData:oDefaults.mData?oDefaults.oDefaults:iCol});oSettings.aoColumns.push(oCol);if(oSettings.aoPreSearchCols[iCol]===undefined||oSettings.aoPreSearchCols[iCol]===null){oSettings.aoPreSearchCols[iCol]=$.extend({},DataTable.models.oSearch)}else{var oPre=oSettings.aoPreSearchCols[iCol];if(oPre.bRegex===undefined){oPre.bRegex=true}if(oPre.bSmart===undefined){oPre.bSmart=true}if(oPre.bCaseInsensitive===undefined){oPre.bCaseInsensitive=true}}_fnColumnOptions(oSettings,iCol,null)}function _fnColumnOptions(oSettings,iCol,oOptions){var oCol=oSettings.aoColumns[iCol];if(oOptions!==undefined&&oOptions!==null){if(oOptions.mDataProp&&!oOptions.mData){oOptions.mData=oOptions.mDataProp}if(oOptions.sType!==undefined){oCol.sType=oOptions.sType;oCol._bAutoType=false}$.extend(oCol,oOptions);_fnMap(oCol,oOptions,"sWidth","sWidthOrig");if(oOptions.iDataSort!==undefined){oCol.aDataSort=[oOptions.iDataSort]}_fnMap(oCol,oOptions,"aDataSort")}var mRender=oCol.mRender?_fnGetObjectDataFn(oCol.mRender):null;var mData=_fnGetObjectDataFn(oCol.mData);oCol.fnGetData=function(oData,sSpecific){var innerData=mData(oData,sSpecific);if(oCol.mRender&&(sSpecific&&sSpecific!=="")){return mRender(innerData,sSpecific,oData)}return innerData};oCol.fnSetData=_fnSetObjectDataFn(oCol.mData);if(!oSettings.oFeatures.bSort){oCol.bSortable=false}if(!oCol.bSortable||($.inArray("asc",oCol.asSorting)==-1&&$.inArray("desc",oCol.asSorting)==-1)){oCol.sSortingClass=oSettings.oClasses.sSortableNone;oCol.sSortingClassJUI=""}else{if($.inArray("asc",oCol.asSorting)==-1&&$.inArray("desc",oCol.asSorting)==-1){oCol.sSortingClass=oSettings.oClasses.sSortable;oCol.sSortingClassJUI=oSettings.oClasses.sSortJUI}else{if($.inArray("asc",oCol.asSorting)!=-1&&$.inArray("desc",oCol.asSorting)==-1){oCol.sSortingClass=oSettings.oClasses.sSortableAsc;oCol.sSortingClassJUI=oSettings.oClasses.sSortJUIAscAllowed}else{if($.inArray("asc",oCol.asSorting)==-1&&$.inArray("desc",oCol.asSorting)!=-1){oCol.sSortingClass=oSettings.oClasses.sSortableDesc;oCol.sSortingClassJUI=oSettings.oClasses.sSortJUIDescAllowed}}}}}function _fnAdjustColumnSizing(oSettings){if(oSettings.oFeatures.bAutoWidth===false){return false}_fnCalculateColumnWidths(oSettings);for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){oSettings.aoColumns[i].nTh.style.width=oSettings.aoColumns[i].sWidth}}function _fnVisibleToColumnIndex(oSettings,iMatch){var aiVis=_fnGetColumns(oSettings,"bVisible");return typeof aiVis[iMatch]==="number"?aiVis[iMatch]:null}function _fnColumnIndexToVisible(oSettings,iMatch){var aiVis=_fnGetColumns(oSettings,"bVisible");var iPos=$.inArray(iMatch,aiVis);return iPos!==-1?iPos:null}function _fnVisbleColumns(oSettings){return _fnGetColumns(oSettings,"bVisible").length}function _fnGetColumns(oSettings,sParam){var a=[];$.map(oSettings.aoColumns,function(val,i){if(val[sParam]){a.push(i)}});return a}function _fnDetectType(sData){var aTypes=DataTable.ext.aTypes;var iLen=aTypes.length;for(var i=0;i<iLen;i++){var sType=aTypes[i](sData);if(sType!==null){return sType}}return"string"}function _fnReOrderIndex(oSettings,sColumns){var aColumns=sColumns.split(",");var aiReturn=[];for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){for(var j=0;j<iLen;j++){if(oSettings.aoColumns[i].sName==aColumns[j]){aiReturn.push(j);break}}}return aiReturn}function _fnColumnOrdering(oSettings){var sNames="";for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){sNames+=oSettings.aoColumns[i].sName+","}if(sNames.length==iLen){return""}return sNames.slice(0,-1)}function _fnApplyColumnDefs(oSettings,aoColDefs,aoCols,fn){var i,iLen,j,jLen,k,kLen;if(aoColDefs){for(i=aoColDefs.length-1;i>=0;i--){var aTargets=aoColDefs[i].aTargets;if(!$.isArray(aTargets)){_fnLog(oSettings,1,"aTargets must be an array of targets, not a "+(typeof aTargets))}for(j=0,jLen=aTargets.length;j<jLen;j++){if(typeof aTargets[j]==="number"&&aTargets[j]>=0){while(oSettings.aoColumns.length<=aTargets[j]){_fnAddColumn(oSettings)}fn(aTargets[j],aoColDefs[i])}else{if(typeof aTargets[j]==="number"&&aTargets[j]<0){fn(oSettings.aoColumns.length+aTargets[j],aoColDefs[i])}else{if(typeof aTargets[j]==="string"){for(k=0,kLen=oSettings.aoColumns.length;k<kLen;k++){if(aTargets[j]=="_all"||$(oSettings.aoColumns[k].nTh).hasClass(aTargets[j])){fn(k,aoColDefs[i])}}}}}}}}if(aoCols){for(i=0,iLen=aoCols.length;i<iLen;i++){fn(i,aoCols[i])}}}function _fnAddData(oSettings,aDataSupplied){var oCol;var aDataIn=($.isArray(aDataSupplied))?aDataSupplied.slice():$.extend(true,{},aDataSupplied);var iRow=oSettings.aoData.length;var oData=$.extend(true,{},DataTable.models.oRow);oData._aData=aDataIn;oSettings.aoData.push(oData);var nTd,sThisType;for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){oCol=oSettings.aoColumns[i];if(typeof oCol.fnRender==="function"&&oCol.bUseRendered&&oCol.mData!==null){_fnSetCellData(oSettings,iRow,i,_fnRender(oSettings,iRow,i))}else{_fnSetCellData(oSettings,iRow,i,_fnGetCellData(oSettings,iRow,i))}if(oCol._bAutoType&&oCol.sType!="string"){var sVarType=_fnGetCellData(oSettings,iRow,i,"type");if(sVarType!==null&&sVarType!==""){sThisType=_fnDetectType(sVarType);if(oCol.sType===null){oCol.sType=sThisType}else{if(oCol.sType!=sThisType&&oCol.sType!="html"){oCol.sType="string"}}}}}oSettings.aiDisplayMaster.push(iRow);if(!oSettings.oFeatures.bDeferRender){_fnCreateTr(oSettings,iRow)}return iRow}function _fnGatherData(oSettings){var iLoop,i,iLen,j,jLen,jInner,nTds,nTrs,nTd,nTr,aLocalData,iThisIndex,iRow,iRows,iColumn,iColumns,sNodeName,oCol,oData;if(oSettings.bDeferLoading||oSettings.sAjaxSource===null){nTr=oSettings.nTBody.firstChild;while(nTr){if(nTr.nodeName.toUpperCase()=="TR"){iThisIndex=oSettings.aoData.length;nTr._DT_RowIndex=iThisIndex;oSettings.aoData.push($.extend(true,{},DataTable.models.oRow,{nTr:nTr}));oSettings.aiDisplayMaster.push(iThisIndex);nTd=nTr.firstChild;jInner=0;while(nTd){sNodeName=nTd.nodeName.toUpperCase();if(sNodeName=="TD"||sNodeName=="TH"){_fnSetCellData(oSettings,iThisIndex,jInner,$.trim(nTd.innerHTML));jInner++}nTd=nTd.nextSibling}}nTr=nTr.nextSibling}}nTrs=_fnGetTrNodes(oSettings);nTds=[];for(i=0,iLen=nTrs.length;i<iLen;i++){nTd=nTrs[i].firstChild;while(nTd){sNodeName=nTd.nodeName.toUpperCase();if(sNodeName=="TD"||sNodeName=="TH"){nTds.push(nTd)}nTd=nTd.nextSibling}}for(iColumn=0,iColumns=oSettings.aoColumns.length;iColumn<iColumns;iColumn++){oCol=oSettings.aoColumns[iColumn];if(oCol.sTitle===null){oCol.sTitle=oCol.nTh.innerHTML}var bAutoType=oCol._bAutoType,bRender=typeof oCol.fnRender==="function",bClass=oCol.sClass!==null,bVisible=oCol.bVisible,nCell,sThisType,sRendered,sValType;if(bAutoType||bRender||bClass||!bVisible){for(iRow=0,iRows=oSettings.aoData.length;iRow<iRows;iRow++){oData=oSettings.aoData[iRow];nCell=nTds[(iRow*iColumns)+iColumn];if(bAutoType&&oCol.sType!="string"){sValType=_fnGetCellData(oSettings,iRow,iColumn,"type");if(sValType!==""){sThisType=_fnDetectType(sValType);if(oCol.sType===null){oCol.sType=sThisType}else{if(oCol.sType!=sThisType&&oCol.sType!="html"){oCol.sType="string"}}}}if(oCol.mRender){nCell.innerHTML=_fnGetCellData(oSettings,iRow,iColumn,"display")}else{if(oCol.mData!==iColumn){nCell.innerHTML=_fnGetCellData(oSettings,iRow,iColumn,"display")}}if(bRender){sRendered=_fnRender(oSettings,iRow,iColumn);nCell.innerHTML=sRendered;if(oCol.bUseRendered){_fnSetCellData(oSettings,iRow,iColumn,sRendered)}}if(bClass){nCell.className+=" "+oCol.sClass}if(!bVisible){oData._anHidden[iColumn]=nCell;nCell.parentNode.removeChild(nCell)}else{oData._anHidden[iColumn]=null}if(oCol.fnCreatedCell){oCol.fnCreatedCell.call(oSettings.oInstance,nCell,_fnGetCellData(oSettings,iRow,iColumn,"display"),oData._aData,iRow,iColumn)}}}}if(oSettings.aoRowCreatedCallback.length!==0){for(i=0,iLen=oSettings.aoData.length;i<iLen;i++){oData=oSettings.aoData[i];_fnCallbackFire(oSettings,"aoRowCreatedCallback",null,[oData.nTr,oData._aData,i])}}}function _fnNodeToDataIndex(oSettings,n){return(n._DT_RowIndex!==undefined)?n._DT_RowIndex:null}function _fnNodeToColumnIndex(oSettings,iRow,n){var anCells=_fnGetTdNodes(oSettings,iRow);for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){if(anCells[i]===n){return i}}return -1}function _fnGetRowData(oSettings,iRow,sSpecific,aiColumns){var out=[];for(var i=0,iLen=aiColumns.length;i<iLen;i++){out.push(_fnGetCellData(oSettings,iRow,aiColumns[i],sSpecific))}return out}function _fnGetCellData(oSettings,iRow,iCol,sSpecific){var sData;var oCol=oSettings.aoColumns[iCol];var oData=oSettings.aoData[iRow]._aData;if((sData=oCol.fnGetData(oData,sSpecific))===undefined){if(oSettings.iDrawError!=oSettings.iDraw&&oCol.sDefaultContent===null){_fnLog(oSettings,0,"Requested unknown parameter "+(typeof oCol.mData=="function"?"{mData function}":"'"+oCol.mData+"'")+" from the data source for row "+iRow);oSettings.iDrawError=oSettings.iDraw}return oCol.sDefaultContent}if(sData===null&&oCol.sDefaultContent!==null){sData=oCol.sDefaultContent}else{if(typeof sData==="function"){return sData()}}if(sSpecific=="display"&&sData===null){return""}return sData}function _fnSetCellData(oSettings,iRow,iCol,val){var oCol=oSettings.aoColumns[iCol];var oData=oSettings.aoData[iRow]._aData;oCol.fnSetData(oData,val)}var __reArray=/\[.*?\]$/;function _fnGetObjectDataFn(mSource){if(mSource===null){return function(data,type){return null}}else{if(typeof mSource==="function"){return function(data,type,extra){return mSource(data,type,extra)}}else{if(typeof mSource==="string"&&(mSource.indexOf(".")!==-1||mSource.indexOf("[")!==-1)){var fetchData=function(data,type,src){var a=src.split(".");var arrayNotation,out,innerSrc;if(src!==""){for(var i=0,iLen=a.length;i<iLen;i++){arrayNotation=a[i].match(__reArray);if(arrayNotation){a[i]=a[i].replace(__reArray,"");if(a[i]!==""){data=data[a[i]]}out=[];a.splice(0,i+1);innerSrc=a.join(".");for(var j=0,jLen=data.length;j<jLen;j++){out.push(fetchData(data[j],type,innerSrc))}var join=arrayNotation[0].substring(1,arrayNotation[0].length-1);data=(join==="")?out:out.join(join);break}if(data===null||data[a[i]]===undefined){return undefined}data=data[a[i]]}}return data};return function(data,type){return fetchData(data,type,mSource)}}else{return function(data,type){return data[mSource]}}}}}function _fnSetObjectDataFn(mSource){if(mSource===null){return function(data,val){}}else{if(typeof mSource==="function"){return function(data,val){mSource(data,"set",val)}}else{if(typeof mSource==="string"&&(mSource.indexOf(".")!==-1||mSource.indexOf("[")!==-1)){var setData=function(data,val,src){var a=src.split("."),b;var arrayNotation,o,innerSrc;for(var i=0,iLen=a.length-1;i<iLen;i++){arrayNotation=a[i].match(__reArray);if(arrayNotation){a[i]=a[i].replace(__reArray,"");data[a[i]]=[];b=a.slice();b.splice(0,i+1);innerSrc=b.join(".");for(var j=0,jLen=val.length;j<jLen;j++){o={};setData(o,val[j],innerSrc);data[a[i]].push(o)}return}if(data[a[i]]===null||data[a[i]]===undefined){data[a[i]]={}}data=data[a[i]]}data[a[a.length-1].replace(__reArray,"")]=val};return function(data,val){return setData(data,val,mSource)}}else{return function(data,val){data[mSource]=val}}}}}function _fnGetDataMaster(oSettings){var aData=[];var iLen=oSettings.aoData.length;for(var i=0;i<iLen;i++){aData.push(oSettings.aoData[i]._aData)}return aData}function _fnClearTable(oSettings){oSettings.aoData.splice(0,oSettings.aoData.length);oSettings.aiDisplayMaster.splice(0,oSettings.aiDisplayMaster.length);oSettings.aiDisplay.splice(0,oSettings.aiDisplay.length);_fnCalculateEnd(oSettings)}function _fnDeleteIndex(a,iTarget){var iTargetIndex=-1;for(var i=0,iLen=a.length;i<iLen;i++){if(a[i]==iTarget){iTargetIndex=i}else{if(a[i]>iTarget){a[i]--}}}if(iTargetIndex!=-1){a.splice(iTargetIndex,1)}}function _fnRender(oSettings,iRow,iCol){var oCol=oSettings.aoColumns[iCol];return oCol.fnRender({iDataRow:iRow,iDataColumn:iCol,oSettings:oSettings,aData:oSettings.aoData[iRow]._aData,mDataProp:oCol.mData},_fnGetCellData(oSettings,iRow,iCol,"display"))}function _fnCreateTr(oSettings,iRow){var oData=oSettings.aoData[iRow];var nTd;if(oData.nTr===null){oData.nTr=document.createElement("tr");oData.nTr._DT_RowIndex=iRow;if(oData._aData.DT_RowId){oData.nTr.id=oData._aData.DT_RowId}if(oData._aData.DT_RowClass){oData.nTr.className=oData._aData.DT_RowClass}for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){var oCol=oSettings.aoColumns[i];nTd=document.createElement(oCol.sCellType);nTd.innerHTML=(typeof oCol.fnRender==="function"&&(!oCol.bUseRendered||oCol.mData===null))?_fnRender(oSettings,iRow,i):_fnGetCellData(oSettings,iRow,i,"display");if(oCol.sClass!==null){nTd.className=oCol.sClass}if(oCol.bVisible){oData.nTr.appendChild(nTd);oData._anHidden[i]=null}else{oData._anHidden[i]=nTd}if(oCol.fnCreatedCell){oCol.fnCreatedCell.call(oSettings.oInstance,nTd,_fnGetCellData(oSettings,iRow,i,"display"),oData._aData,iRow,i)}}_fnCallbackFire(oSettings,"aoRowCreatedCallback",null,[oData.nTr,oData._aData,iRow])}}function _fnBuildHead(oSettings){var i,nTh,iLen,j,jLen;var iThs=$("th, td",oSettings.nTHead).length;var iCorrector=0;var jqChildren;if(iThs!==0){for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){nTh=oSettings.aoColumns[i].nTh;nTh.setAttribute("role","columnheader");if(oSettings.aoColumns[i].bSortable){nTh.setAttribute("tabindex",oSettings.iTabIndex);nTh.setAttribute("aria-controls",oSettings.sTableId)}if(oSettings.aoColumns[i].sClass!==null){$(nTh).addClass(oSettings.aoColumns[i].sClass)}if(oSettings.aoColumns[i].sTitle!=nTh.innerHTML){nTh.innerHTML=oSettings.aoColumns[i].sTitle}}}else{var nTr=document.createElement("tr");for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){nTh=oSettings.aoColumns[i].nTh;nTh.innerHTML=oSettings.aoColumns[i].sTitle;nTh.setAttribute("tabindex","0");if(oSettings.aoColumns[i].sClass!==null){$(nTh).addClass(oSettings.aoColumns[i].sClass)}nTr.appendChild(nTh)}$(oSettings.nTHead).html("")[0].appendChild(nTr);_fnDetectHeader(oSettings.aoHeader,oSettings.nTHead)}$(oSettings.nTHead).children("tr").attr("role","row");if(oSettings.bJUI){for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){nTh=oSettings.aoColumns[i].nTh;var nDiv=document.createElement("div");nDiv.className=oSettings.oClasses.sSortJUIWrapper;$(nTh).contents().appendTo(nDiv);var nSpan=document.createElement("span");nSpan.className=oSettings.oClasses.sSortIcon;nDiv.appendChild(nSpan);nTh.appendChild(nDiv)}}if(oSettings.oFeatures.bSort){for(i=0;i<oSettings.aoColumns.length;i++){if(oSettings.aoColumns[i].bSortable!==false){_fnSortAttachListener(oSettings,oSettings.aoColumns[i].nTh,i)}else{$(oSettings.aoColumns[i].nTh).addClass(oSettings.oClasses.sSortableNone)}}}if(oSettings.oClasses.sFooterTH!==""){$(oSettings.nTFoot).children("tr").children("th").addClass(oSettings.oClasses.sFooterTH)}if(oSettings.nTFoot!==null){var anCells=_fnGetUniqueThs(oSettings,null,oSettings.aoFooter);for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){if(anCells[i]){oSettings.aoColumns[i].nTf=anCells[i];if(oSettings.aoColumns[i].sClass){$(anCells[i]).addClass(oSettings.aoColumns[i].sClass)}}}}}function _fnDrawHead(oSettings,aoSource,bIncludeHidden){var i,iLen,j,jLen,k,kLen,n,nLocalTr;var aoLocal=[];var aApplied=[];var iColumns=oSettings.aoColumns.length;var iRowspan,iColspan;if(bIncludeHidden===undefined){bIncludeHidden=false}for(i=0,iLen=aoSource.length;i<iLen;i++){aoLocal[i]=aoSource[i].slice();aoLocal[i].nTr=aoSource[i].nTr;for(j=iColumns-1;j>=0;j--){if(!oSettings.aoColumns[j].bVisible&&!bIncludeHidden){aoLocal[i].splice(j,1)}}aApplied.push([])}for(i=0,iLen=aoLocal.length;i<iLen;i++){nLocalTr=aoLocal[i].nTr;if(nLocalTr){while((n=nLocalTr.firstChild)){nLocalTr.removeChild(n)}}for(j=0,jLen=aoLocal[i].length;j<jLen;j++){iRowspan=1;iColspan=1;if(aApplied[i][j]===undefined){nLocalTr.appendChild(aoLocal[i][j].cell);aApplied[i][j]=1;while(aoLocal[i+iRowspan]!==undefined&&aoLocal[i][j].cell==aoLocal[i+iRowspan][j].cell){aApplied[i+iRowspan][j]=1;iRowspan++}while(aoLocal[i][j+iColspan]!==undefined&&aoLocal[i][j].cell==aoLocal[i][j+iColspan].cell){for(k=0;k<iRowspan;k++){aApplied[i+k][j+iColspan]=1}iColspan++}aoLocal[i][j].cell.rowSpan=iRowspan;aoLocal[i][j].cell.colSpan=iColspan}}}}function _fnDraw(oSettings){var aPreDraw=_fnCallbackFire(oSettings,"aoPreDrawCallback","preDraw",[oSettings]);if($.inArray(false,aPreDraw)!==-1){_fnProcessingDisplay(oSettings,false);return}var i,iLen,n;var anRows=[];var iRowCount=0;var iStripes=oSettings.asStripeClasses.length;var iOpenRows=oSettings.aoOpenRows.length;oSettings.bDrawing=true;if(oSettings.iInitDisplayStart!==undefined&&oSettings.iInitDisplayStart!=-1){if(oSettings.oFeatures.bServerSide){oSettings._iDisplayStart=oSettings.iInitDisplayStart}else{oSettings._iDisplayStart=(oSettings.iInitDisplayStart>=oSettings.fnRecordsDisplay())?0:oSettings.iInitDisplayStart}oSettings.iInitDisplayStart=-1;_fnCalculateEnd(oSettings)}if(oSettings.bDeferLoading){oSettings.bDeferLoading=false;oSettings.iDraw++}else{if(!oSettings.oFeatures.bServerSide){oSettings.iDraw++}else{if(!oSettings.bDestroying&&!_fnAjaxUpdate(oSettings)){return}}}if(oSettings.aiDisplay.length!==0){var iStart=oSettings._iDisplayStart;var iEnd=oSettings._iDisplayEnd;if(oSettings.oFeatures.bServerSide){iStart=0;iEnd=oSettings.aoData.length}for(var j=iStart;j<iEnd;j++){var aoData=oSettings.aoData[oSettings.aiDisplay[j]];if(aoData.nTr===null){_fnCreateTr(oSettings,oSettings.aiDisplay[j])}var nRow=aoData.nTr;if(iStripes!==0){var sStripe=oSettings.asStripeClasses[iRowCount%iStripes];if(aoData._sRowStripe!=sStripe){$(nRow).removeClass(aoData._sRowStripe).addClass(sStripe);aoData._sRowStripe=sStripe}}_fnCallbackFire(oSettings,"aoRowCallback",null,[nRow,oSettings.aoData[oSettings.aiDisplay[j]]._aData,iRowCount,j]);anRows.push(nRow);iRowCount++;if(iOpenRows!==0){for(var k=0;k<iOpenRows;k++){if(nRow==oSettings.aoOpenRows[k].nParent){anRows.push(oSettings.aoOpenRows[k].nTr);break}}}}}else{anRows[0]=document.createElement("tr");if(oSettings.asStripeClasses[0]){anRows[0].className=oSettings.asStripeClasses[0]}var oLang=oSettings.oLanguage;var sZero=oLang.sZeroRecords;if(oSettings.iDraw==1&&oSettings.sAjaxSource!==null&&!oSettings.oFeatures.bServerSide){sZero=oLang.sLoadingRecords}else{if(oLang.sEmptyTable&&oSettings.fnRecordsTotal()===0){sZero=oLang.sEmptyTable}}var nTd=document.createElement("td");nTd.setAttribute("valign","top");nTd.colSpan=_fnVisbleColumns(oSettings);nTd.className=oSettings.oClasses.sRowEmpty;nTd.innerHTML=_fnInfoMacros(oSettings,sZero);anRows[iRowCount].appendChild(nTd)}_fnCallbackFire(oSettings,"aoHeaderCallback","header",[$(oSettings.nTHead).children("tr")[0],_fnGetDataMaster(oSettings),oSettings._iDisplayStart,oSettings.fnDisplayEnd(),oSettings.aiDisplay]);_fnCallbackFire(oSettings,"aoFooterCallback","footer",[$(oSettings.nTFoot).children("tr")[0],_fnGetDataMaster(oSettings),oSettings._iDisplayStart,oSettings.fnDisplayEnd(),oSettings.aiDisplay]);var nAddFrag=document.createDocumentFragment(),nRemoveFrag=document.createDocumentFragment(),nBodyPar,nTrs;if(oSettings.nTBody){nBodyPar=oSettings.nTBody.parentNode;nRemoveFrag.appendChild(oSettings.nTBody);if(!oSettings.oScroll.bInfinite||!oSettings._bInitComplete||oSettings.bSorted||oSettings.bFiltered){while((n=oSettings.nTBody.firstChild)){oSettings.nTBody.removeChild(n)}}for(i=0,iLen=anRows.length;i<iLen;i++){nAddFrag.appendChild(anRows[i])}oSettings.nTBody.appendChild(nAddFrag);if(nBodyPar!==null){nBodyPar.appendChild(oSettings.nTBody)}}_fnCallbackFire(oSettings,"aoDrawCallback","draw",[oSettings]);oSettings.bSorted=false;oSettings.bFiltered=false;oSettings.bDrawing=false;if(oSettings.oFeatures.bServerSide){_fnProcessingDisplay(oSettings,false);if(!oSettings._bInitComplete){_fnInitComplete(oSettings)}}}function _fnReDraw(oSettings){if(oSettings.oFeatures.bSort){_fnSort(oSettings,oSettings.oPreviousSearch)}else{if(oSettings.oFeatures.bFilter){_fnFilterComplete(oSettings,oSettings.oPreviousSearch)}else{_fnCalculateEnd(oSettings);_fnDraw(oSettings)}}}function _fnAddOptionsHtml(oSettings){var nHolding=$("<div></div>")[0];oSettings.nTable.parentNode.insertBefore(nHolding,oSettings.nTable);oSettings.nTableWrapper=$('<div id="'+oSettings.sTableId+'_wrapper" class="'+oSettings.oClasses.sWrapper+'" role="grid"></div>')[0];oSettings.nTableReinsertBefore=oSettings.nTable.nextSibling;var nInsertNode=oSettings.nTableWrapper;var aDom=oSettings.sDom.split("");var nTmp,iPushFeature,cOption,nNewNode,cNext,sAttr,j;for(var i=0;i<aDom.length;i++){iPushFeature=0;cOption=aDom[i];if(cOption=="<"){nNewNode=$("<div></div>")[0];cNext=aDom[i+1];if(cNext=="'"||cNext=='"'){sAttr="";j=2;while(aDom[i+j]!=cNext){sAttr+=aDom[i+j];j++}if(sAttr=="H"){sAttr=oSettings.oClasses.sJUIHeader}else{if(sAttr=="F"){sAttr=oSettings.oClasses.sJUIFooter}}if(sAttr.indexOf(".")!=-1){var aSplit=sAttr.split(".");nNewNode.id=aSplit[0].substr(1,aSplit[0].length-1);nNewNode.className=aSplit[1]}else{if(sAttr.charAt(0)=="#"){nNewNode.id=sAttr.substr(1,sAttr.length-1)}else{nNewNode.className=sAttr}}i+=j}nInsertNode.appendChild(nNewNode);nInsertNode=nNewNode}else{if(cOption==">"){nInsertNode=nInsertNode.parentNode}else{if(cOption=="l"&&oSettings.oFeatures.bPaginate&&oSettings.oFeatures.bLengthChange){nTmp=_fnFeatureHtmlLength(oSettings);iPushFeature=1}else{if(cOption=="f"&&oSettings.oFeatures.bFilter){nTmp=_fnFeatureHtmlFilter(oSettings);iPushFeature=1}else{if(cOption=="r"&&oSettings.oFeatures.bProcessing){nTmp=_fnFeatureHtmlProcessing(oSettings);iPushFeature=1}else{if(cOption=="t"){nTmp=_fnFeatureHtmlTable(oSettings);iPushFeature=1}else{if(cOption=="i"&&oSettings.oFeatures.bInfo){nTmp=_fnFeatureHtmlInfo(oSettings);iPushFeature=1}else{if(cOption=="p"&&oSettings.oFeatures.bPaginate){nTmp=_fnFeatureHtmlPaginate(oSettings);iPushFeature=1}else{if(DataTable.ext.aoFeatures.length!==0){var aoFeatures=DataTable.ext.aoFeatures;for(var k=0,kLen=aoFeatures.length;k<kLen;k++){if(cOption==aoFeatures[k].cFeature){nTmp=aoFeatures[k].fnInit(oSettings);if(nTmp){iPushFeature=1}break}}}}}}}}}}}if(iPushFeature==1&&nTmp!==null){if(typeof oSettings.aanFeatures[cOption]!=="object"){oSettings.aanFeatures[cOption]=[]}oSettings.aanFeatures[cOption].push(nTmp);nInsertNode.appendChild(nTmp)}}nHolding.parentNode.replaceChild(oSettings.nTableWrapper,nHolding)}function _fnDetectHeader(aLayout,nThead){var nTrs=$(nThead).children("tr");var nTr,nCell;var i,k,l,iLen,jLen,iColShifted,iColumn,iColspan,iRowspan;var bUnique;var fnShiftCol=function(a,i,j){var k=a[i];while(k[j]){j++}return j};aLayout.splice(0,aLayout.length);for(i=0,iLen=nTrs.length;i<iLen;i++){aLayout.push([])}for(i=0,iLen=nTrs.length;i<iLen;i++){nTr=nTrs[i];iColumn=0;nCell=nTr.firstChild;while(nCell){if(nCell.nodeName.toUpperCase()=="TD"||nCell.nodeName.toUpperCase()=="TH"){iColspan=nCell.getAttribute("colspan")*1;iRowspan=nCell.getAttribute("rowspan")*1;iColspan=(!iColspan||iColspan===0||iColspan===1)?1:iColspan;iRowspan=(!iRowspan||iRowspan===0||iRowspan===1)?1:iRowspan;iColShifted=fnShiftCol(aLayout,i,iColumn);bUnique=iColspan===1?true:false;for(l=0;l<iColspan;l++){for(k=0;k<iRowspan;k++){aLayout[i+k][iColShifted+l]={cell:nCell,unique:bUnique};aLayout[i+k].nTr=nTr}}}nCell=nCell.nextSibling}}}function _fnGetUniqueThs(oSettings,nHeader,aLayout){var aReturn=[];if(!aLayout){aLayout=oSettings.aoHeader;if(nHeader){aLayout=[];_fnDetectHeader(aLayout,nHeader)}}for(var i=0,iLen=aLayout.length;i<iLen;i++){for(var j=0,jLen=aLayout[i].length;j<jLen;j++){if(aLayout[i][j].unique&&(!aReturn[j]||!oSettings.bSortCellsTop)){aReturn[j]=aLayout[i][j].cell}}}return aReturn}function _fnAjaxUpdate(oSettings){if(oSettings.bAjaxDataGet){oSettings.iDraw++;_fnProcessingDisplay(oSettings,true);var iColumns=oSettings.aoColumns.length;var aoData=_fnAjaxParameters(oSettings);_fnServerParams(oSettings,aoData);oSettings.fnServerData.call(oSettings.oInstance,oSettings.sAjaxSource,aoData,function(json){_fnAjaxUpdateDraw(oSettings,json)},oSettings);return false}else{return true}}function _fnAjaxParameters(oSettings){var iColumns=oSettings.aoColumns.length;var aoData=[],mDataProp,aaSort,aDataSort;var i,j;aoData.push({name:"sEcho",value:oSettings.iDraw});aoData.push({name:"iColumns",value:iColumns});aoData.push({name:"sColumns",value:_fnColumnOrdering(oSettings)});aoData.push({name:"iDisplayStart",value:oSettings._iDisplayStart});aoData.push({name:"iDisplayLength",value:oSettings.oFeatures.bPaginate!==false?oSettings._iDisplayLength:-1});for(i=0;i<iColumns;i++){mDataProp=oSettings.aoColumns[i].mData;aoData.push({name:"mDataProp_"+i,value:typeof(mDataProp)==="function"?"function":mDataProp})}if(oSettings.oFeatures.bFilter!==false){aoData.push({name:"sSearch",value:oSettings.oPreviousSearch.sSearch});aoData.push({name:"bRegex",value:oSettings.oPreviousSearch.bRegex});for(i=0;i<iColumns;i++){aoData.push({name:"sSearch_"+i,value:oSettings.aoPreSearchCols[i].sSearch});aoData.push({name:"bRegex_"+i,value:oSettings.aoPreSearchCols[i].bRegex});aoData.push({name:"bSearchable_"+i,value:oSettings.aoColumns[i].bSearchable})}}if(oSettings.oFeatures.bSort!==false){var iCounter=0;aaSort=(oSettings.aaSortingFixed!==null)?oSettings.aaSortingFixed.concat(oSettings.aaSorting):oSettings.aaSorting.slice();for(i=0;i<aaSort.length;i++){aDataSort=oSettings.aoColumns[aaSort[i][0]].aDataSort;for(j=0;j<aDataSort.length;j++){aoData.push({name:"iSortCol_"+iCounter,value:aDataSort[j]});aoData.push({name:"sSortDir_"+iCounter,value:aaSort[i][1]});iCounter++}}aoData.push({name:"iSortingCols",value:iCounter});for(i=0;i<iColumns;i++){aoData.push({name:"bSortable_"+i,value:oSettings.aoColumns[i].bSortable})}}return aoData}function _fnServerParams(oSettings,aoData){_fnCallbackFire(oSettings,"aoServerParams","serverParams",[aoData])}function _fnAjaxUpdateDraw(oSettings,json){if(json.sEcho!==undefined){if(json.sEcho*1<oSettings.iDraw){return}else{oSettings.iDraw=json.sEcho*1}}if(!oSettings.oScroll.bInfinite||(oSettings.oScroll.bInfinite&&(oSettings.bSorted||oSettings.bFiltered))){_fnClearTable(oSettings)}oSettings._iRecordsTotal=parseInt(json.iTotalRecords,10);oSettings._iRecordsDisplay=parseInt(json.iTotalDisplayRecords,10);var sOrdering=_fnColumnOrdering(oSettings);var bReOrder=(json.sColumns!==undefined&&sOrdering!==""&&json.sColumns!=sOrdering);var aiIndex;if(bReOrder){aiIndex=_fnReOrderIndex(oSettings,json.sColumns)}var aData=_fnGetObjectDataFn(oSettings.sAjaxDataProp)(json);for(var i=0,iLen=aData.length;i<iLen;i++){if(bReOrder){var aDataSorted=[];for(var j=0,jLen=oSettings.aoColumns.length;j<jLen;j++){aDataSorted.push(aData[i][aiIndex[j]])}_fnAddData(oSettings,aDataSorted)}else{_fnAddData(oSettings,aData[i])}}oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();oSettings.bAjaxDataGet=false;_fnDraw(oSettings);oSettings.bAjaxDataGet=true;_fnProcessingDisplay(oSettings,false)}function _fnFeatureHtmlFilter(oSettings){var oPreviousSearch=oSettings.oPreviousSearch;var sSearchStr=oSettings.oLanguage.sSearch;sSearchStr=(sSearchStr.indexOf("_INPUT_")!==-1)?sSearchStr.replace("_INPUT_",'<input type="text" />'):sSearchStr===""?'<input type="text" />':sSearchStr+' <input type="text" />';var nFilter=document.createElement("div");nFilter.className=oSettings.oClasses.sFilter;nFilter.innerHTML="<label>"+sSearchStr+"</label>";if(!oSettings.aanFeatures.f){nFilter.id=oSettings.sTableId+"_filter"}var jqFilter=$('input[type="text"]',nFilter);nFilter._DT_Input=jqFilter[0];jqFilter.val(oPreviousSearch.sSearch.replace('"',"&quot;"));jqFilter.bind("keyup.DT",function(e){var n=oSettings.aanFeatures.f;var val=this.value===""?"":this.value;for(var i=0,iLen=n.length;i<iLen;i++){if(n[i]!=$(this).parents("div.dataTables_filter")[0]){$(n[i]._DT_Input).val(val)}}if(val!=oPreviousSearch.sSearch){_fnFilterComplete(oSettings,{sSearch:val,bRegex:oPreviousSearch.bRegex,bSmart:oPreviousSearch.bSmart,bCaseInsensitive:oPreviousSearch.bCaseInsensitive})}});jqFilter.attr("aria-controls",oSettings.sTableId).bind("keypress.DT",function(e){if(e.keyCode==13){return false}});return nFilter}function _fnFilterComplete(oSettings,oInput,iForce){var oPrevSearch=oSettings.oPreviousSearch;var aoPrevSearch=oSettings.aoPreSearchCols;var fnSaveFilter=function(oFilter){oPrevSearch.sSearch=oFilter.sSearch;oPrevSearch.bRegex=oFilter.bRegex;oPrevSearch.bSmart=oFilter.bSmart;oPrevSearch.bCaseInsensitive=oFilter.bCaseInsensitive};if(!oSettings.oFeatures.bServerSide){_fnFilter(oSettings,oInput.sSearch,iForce,oInput.bRegex,oInput.bSmart,oInput.bCaseInsensitive);fnSaveFilter(oInput);for(var i=0;i<oSettings.aoPreSearchCols.length;i++){_fnFilterColumn(oSettings,aoPrevSearch[i].sSearch,i,aoPrevSearch[i].bRegex,aoPrevSearch[i].bSmart,aoPrevSearch[i].bCaseInsensitive)}_fnFilterCustom(oSettings)}else{fnSaveFilter(oInput)}oSettings.bFiltered=true;$(oSettings.oInstance).trigger("filter",oSettings);oSettings._iDisplayStart=0;_fnCalculateEnd(oSettings);_fnDraw(oSettings);_fnBuildSearchArray(oSettings,0)}function _fnFilterCustom(oSettings){var afnFilters=DataTable.ext.afnFiltering;var aiFilterColumns=_fnGetColumns(oSettings,"bSearchable");for(var i=0,iLen=afnFilters.length;i<iLen;i++){var iCorrector=0;for(var j=0,jLen=oSettings.aiDisplay.length;j<jLen;j++){var iDisIndex=oSettings.aiDisplay[j-iCorrector];var bTest=afnFilters[i](oSettings,_fnGetRowData(oSettings,iDisIndex,"filter",aiFilterColumns),iDisIndex);if(!bTest){oSettings.aiDisplay.splice(j-iCorrector,1);iCorrector++}}}}function _fnFilterColumn(oSettings,sInput,iColumn,bRegex,bSmart,bCaseInsensitive){if(sInput===""){return}var iIndexCorrector=0;var rpSearch=_fnFilterCreateSearch(sInput,bRegex,bSmart,bCaseInsensitive);for(var i=oSettings.aiDisplay.length-1;i>=0;i--){var sData=_fnDataToSearch(_fnGetCellData(oSettings,oSettings.aiDisplay[i],iColumn,"filter"),oSettings.aoColumns[iColumn].sType);if(!rpSearch.test(sData)){oSettings.aiDisplay.splice(i,1);iIndexCorrector++}}}function _fnFilter(oSettings,sInput,iForce,bRegex,bSmart,bCaseInsensitive){var i;var rpSearch=_fnFilterCreateSearch(sInput,bRegex,bSmart,bCaseInsensitive);var oPrevSearch=oSettings.oPreviousSearch;if(!iForce){iForce=0}if(DataTable.ext.afnFiltering.length!==0){iForce=1}if(sInput.length<=0){oSettings.aiDisplay.splice(0,oSettings.aiDisplay.length);oSettings.aiDisplay=oSettings.aiDisplayMaster.slice()}else{if(oSettings.aiDisplay.length==oSettings.aiDisplayMaster.length||oPrevSearch.sSearch.length>sInput.length||iForce==1||sInput.indexOf(oPrevSearch.sSearch)!==0){oSettings.aiDisplay.splice(0,oSettings.aiDisplay.length);_fnBuildSearchArray(oSettings,1);for(i=0;i<oSettings.aiDisplayMaster.length;i++){if(rpSearch.test(oSettings.asDataSearch[i])){oSettings.aiDisplay.push(oSettings.aiDisplayMaster[i])}}}else{var iIndexCorrector=0;for(i=0;i<oSettings.asDataSearch.length;i++){if(!rpSearch.test(oSettings.asDataSearch[i])){oSettings.aiDisplay.splice(i-iIndexCorrector,1);iIndexCorrector++}}}}}function _fnBuildSearchArray(oSettings,iMaster){if(!oSettings.oFeatures.bServerSide){oSettings.asDataSearch=[];var aiFilterColumns=_fnGetColumns(oSettings,"bSearchable");var aiIndex=(iMaster===1)?oSettings.aiDisplayMaster:oSettings.aiDisplay;for(var i=0,iLen=aiIndex.length;i<iLen;i++){oSettings.asDataSearch[i]=_fnBuildSearchRow(oSettings,_fnGetRowData(oSettings,aiIndex[i],"filter",aiFilterColumns))}}}function _fnBuildSearchRow(oSettings,aData){var sSearch=aData.join("  ");if(sSearch.indexOf("&")!==-1){sSearch=$("<div>").html(sSearch).text()}return sSearch.replace(/[\n\r]/g," ")}function _fnFilterCreateSearch(sSearch,bRegex,bSmart,bCaseInsensitive){var asSearch,sRegExpString;if(bSmart){asSearch=bRegex?sSearch.split(" "):_fnEscapeRegex(sSearch).split(" ");sRegExpString="^(?=.*?"+asSearch.join(")(?=.*?")+").*$";return new RegExp(sRegExpString,bCaseInsensitive?"i":"")}else{sSearch=bRegex?sSearch:_fnEscapeRegex(sSearch);return new RegExp(sSearch,bCaseInsensitive?"i":"")}}function _fnDataToSearch(sData,sType){if(typeof DataTable.ext.ofnSearch[sType]==="function"){return DataTable.ext.ofnSearch[sType](sData)}else{if(sData===null){return""}else{if(sType=="html"){return sData.replace(/[\r\n]/g," ").replace(/<.*?>/g,"")}else{if(typeof sData==="string"){return sData.replace(/[\r\n]/g," ")}}}}return sData}function _fnEscapeRegex(sVal){var acEscape=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"];var reReplace=new RegExp("(\\"+acEscape.join("|\\")+")","g");return sVal.replace(reReplace,"\\$1")}function _fnFeatureHtmlInfo(oSettings){var nInfo=document.createElement("div");nInfo.className=oSettings.oClasses.sInfo;if(!oSettings.aanFeatures.i){oSettings.aoDrawCallback.push({fn:_fnUpdateInfo,sName:"information"});nInfo.id=oSettings.sTableId+"_info"}oSettings.nTable.setAttribute("aria-describedby",oSettings.sTableId+"_info");return nInfo}function _fnUpdateInfo(oSettings){if(!oSettings.oFeatures.bInfo||oSettings.aanFeatures.i.length===0){return}var oLang=oSettings.oLanguage,iStart=oSettings._iDisplayStart+1,iEnd=oSettings.fnDisplayEnd(),iMax=oSettings.fnRecordsTotal(),iTotal=oSettings.fnRecordsDisplay(),sOut;if(iTotal===0){sOut=oLang.sInfoEmpty}else{sOut=oLang.sInfo}if(iTotal!=iMax){sOut+=" "+oLang.sInfoFiltered}sOut+=oLang.sInfoPostFix;sOut=_fnInfoMacros(oSettings,sOut);if(oLang.fnInfoCallback!==null){sOut=oLang.fnInfoCallback.call(oSettings.oInstance,oSettings,iStart,iEnd,iMax,iTotal,sOut)}var n=oSettings.aanFeatures.i;for(var i=0,iLen=n.length;i<iLen;i++){$(n[i]).html(sOut)}}function _fnInfoMacros(oSettings,str){var iStart=oSettings._iDisplayStart+1,sStart=oSettings.fnFormatNumber(iStart),iEnd=oSettings.fnDisplayEnd(),sEnd=oSettings.fnFormatNumber(iEnd),iTotal=oSettings.fnRecordsDisplay(),sTotal=oSettings.fnFormatNumber(iTotal),iMax=oSettings.fnRecordsTotal(),sMax=oSettings.fnFormatNumber(iMax);if(oSettings.oScroll.bInfinite){sStart=oSettings.fnFormatNumber(1)}return str.replace(/_START_/g,sStart).replace(/_END_/g,sEnd).replace(/_TOTAL_/g,sTotal).replace(/_MAX_/g,sMax)}function _fnInitialise(oSettings){var i,iLen,iAjaxStart=oSettings.iInitDisplayStart;if(oSettings.bInitialised===false){setTimeout(function(){_fnInitialise(oSettings)},200);return}_fnAddOptionsHtml(oSettings);_fnBuildHead(oSettings);_fnDrawHead(oSettings,oSettings.aoHeader);if(oSettings.nTFoot){_fnDrawHead(oSettings,oSettings.aoFooter)}_fnProcessingDisplay(oSettings,true);if(oSettings.oFeatures.bAutoWidth){_fnCalculateColumnWidths(oSettings)}for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){if(oSettings.aoColumns[i].sWidth!==null){oSettings.aoColumns[i].nTh.style.width=_fnStringToCss(oSettings.aoColumns[i].sWidth)}}if(oSettings.oFeatures.bSort){_fnSort(oSettings)}else{if(oSettings.oFeatures.bFilter){_fnFilterComplete(oSettings,oSettings.oPreviousSearch)}else{oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();_fnCalculateEnd(oSettings);_fnDraw(oSettings)}}if(oSettings.sAjaxSource!==null&&!oSettings.oFeatures.bServerSide){var aoData=[];_fnServerParams(oSettings,aoData);oSettings.fnServerData.call(oSettings.oInstance,oSettings.sAjaxSource,aoData,function(json){var aData=(oSettings.sAjaxDataProp!=="")?_fnGetObjectDataFn(oSettings.sAjaxDataProp)(json):json;for(i=0;i<aData.length;i++){_fnAddData(oSettings,aData[i])}oSettings.iInitDisplayStart=iAjaxStart;if(oSettings.oFeatures.bSort){_fnSort(oSettings)}else{oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();_fnCalculateEnd(oSettings);_fnDraw(oSettings)}_fnProcessingDisplay(oSettings,false);_fnInitComplete(oSettings,json)},oSettings);return}if(!oSettings.oFeatures.bServerSide){_fnProcessingDisplay(oSettings,false);_fnInitComplete(oSettings)}}function _fnInitComplete(oSettings,json){oSettings._bInitComplete=true;_fnCallbackFire(oSettings,"aoInitComplete","init",[oSettings,json])}function _fnLanguageCompat(oLanguage){var oDefaults=DataTable.defaults.oLanguage;if(!oLanguage.sEmptyTable&&oLanguage.sZeroRecords&&oDefaults.sEmptyTable==="No data available in table"){_fnMap(oLanguage,oLanguage,"sZeroRecords","sEmptyTable")}if(!oLanguage.sLoadingRecords&&oLanguage.sZeroRecords&&oDefaults.sLoadingRecords==="Loading..."){_fnMap(oLanguage,oLanguage,"sZeroRecords","sLoadingRecords")}}function _fnFeatureHtmlLength(oSettings){if(oSettings.oScroll.bInfinite){return null}var sName='name="'+oSettings.sTableId+'_length"';var sStdMenu='<select size="1" '+sName+">";var i,iLen;var aLengthMenu=oSettings.aLengthMenu;if(aLengthMenu.length==2&&typeof aLengthMenu[0]==="object"&&typeof aLengthMenu[1]==="object"){for(i=0,iLen=aLengthMenu[0].length;i<iLen;i++){sStdMenu+='<option value="'+aLengthMenu[0][i]+'">'+aLengthMenu[1][i]+"</option>"}}else{for(i=0,iLen=aLengthMenu.length;i<iLen;i++){sStdMenu+='<option value="'+aLengthMenu[i]+'">'+aLengthMenu[i]+"</option>"}}sStdMenu+="</select>";var nLength=document.createElement("div");if(!oSettings.aanFeatures.l){nLength.id=oSettings.sTableId+"_length"}nLength.className=oSettings.oClasses.sLength;nLength.innerHTML="<label>"+oSettings.oLanguage.sLengthMenu.replace("_MENU_",sStdMenu)+"</label>";$('select option[value="'+oSettings._iDisplayLength+'"]',nLength).attr("selected",true);$("select",nLength).bind("change.DT",function(e){var iVal=$(this).val();var n=oSettings.aanFeatures.l;for(i=0,iLen=n.length;i<iLen;i++){if(n[i]!=this.parentNode){$("select",n[i]).val(iVal)}}oSettings._iDisplayLength=parseInt(iVal,10);_fnCalculateEnd(oSettings);if(oSettings.fnDisplayEnd()==oSettings.fnRecordsDisplay()){oSettings._iDisplayStart=oSettings.fnDisplayEnd()-oSettings._iDisplayLength;if(oSettings._iDisplayStart<0){oSettings._iDisplayStart=0}}if(oSettings._iDisplayLength==-1){oSettings._iDisplayStart=0}_fnDraw(oSettings)});$("select",nLength).attr("aria-controls",oSettings.sTableId);return nLength}function _fnCalculateEnd(oSettings){if(oSettings.oFeatures.bPaginate===false){oSettings._iDisplayEnd=oSettings.aiDisplay.length}else{if(oSettings._iDisplayStart+oSettings._iDisplayLength>oSettings.aiDisplay.length||oSettings._iDisplayLength==-1){oSettings._iDisplayEnd=oSettings.aiDisplay.length}else{oSettings._iDisplayEnd=oSettings._iDisplayStart+oSettings._iDisplayLength}}}function _fnFeatureHtmlPaginate(oSettings){if(oSettings.oScroll.bInfinite){return null}var nPaginate=document.createElement("div");nPaginate.className=oSettings.oClasses.sPaging+oSettings.sPaginationType;DataTable.ext.oPagination[oSettings.sPaginationType].fnInit(oSettings,nPaginate,function(oSettings){_fnCalculateEnd(oSettings);_fnDraw(oSettings)});if(!oSettings.aanFeatures.p){oSettings.aoDrawCallback.push({fn:function(oSettings){DataTable.ext.oPagination[oSettings.sPaginationType].fnUpdate(oSettings,function(oSettings){_fnCalculateEnd(oSettings);_fnDraw(oSettings)})},sName:"pagination"})}return nPaginate}function _fnPageChange(oSettings,mAction){var iOldStart=oSettings._iDisplayStart;if(typeof mAction==="number"){oSettings._iDisplayStart=mAction*oSettings._iDisplayLength;if(oSettings._iDisplayStart>oSettings.fnRecordsDisplay()){oSettings._iDisplayStart=0}}else{if(mAction=="first"){oSettings._iDisplayStart=0}else{if(mAction=="previous"){oSettings._iDisplayStart=oSettings._iDisplayLength>=0?oSettings._iDisplayStart-oSettings._iDisplayLength:0;if(oSettings._iDisplayStart<0){oSettings._iDisplayStart=0}}else{if(mAction=="next"){if(oSettings._iDisplayLength>=0){if(oSettings._iDisplayStart+oSettings._iDisplayLength<oSettings.fnRecordsDisplay()){oSettings._iDisplayStart+=oSettings._iDisplayLength}}else{oSettings._iDisplayStart=0}}else{if(mAction=="last"){if(oSettings._iDisplayLength>=0){var iPages=parseInt((oSettings.fnRecordsDisplay()-1)/oSettings._iDisplayLength,10)+1;oSettings._iDisplayStart=(iPages-1)*oSettings._iDisplayLength}else{oSettings._iDisplayStart=0}}else{_fnLog(oSettings,0,"Unknown paging action: "+mAction)}}}}}$(oSettings.oInstance).trigger("page",oSettings);return iOldStart!=oSettings._iDisplayStart}function _fnFeatureHtmlProcessing(oSettings){var nProcessing=document.createElement("div");if(!oSettings.aanFeatures.r){nProcessing.id=oSettings.sTableId+"_processing"}nProcessing.innerHTML=oSettings.oLanguage.sProcessing;nProcessing.className=oSettings.oClasses.sProcessing;oSettings.nTable.parentNode.insertBefore(nProcessing,oSettings.nTable);return nProcessing}function _fnProcessingDisplay(oSettings,bShow){if(oSettings.oFeatures.bProcessing){var an=oSettings.aanFeatures.r;for(var i=0,iLen=an.length;i<iLen;i++){an[i].style.visibility=bShow?"visible":"hidden"}}$(oSettings.oInstance).trigger("processing",[oSettings,bShow])}function _fnFeatureHtmlTable(oSettings){if(oSettings.oScroll.sX===""&&oSettings.oScroll.sY===""){return oSettings.nTable}var nScroller=document.createElement("div"),nScrollHead=document.createElement("div"),nScrollHeadInner=document.createElement("div"),nScrollBody=document.createElement("div"),nScrollFoot=document.createElement("div"),nScrollFootInner=document.createElement("div"),nScrollHeadTable=oSettings.nTable.cloneNode(false),nScrollFootTable=oSettings.nTable.cloneNode(false),nThead=oSettings.nTable.getElementsByTagName("thead")[0],nTfoot=oSettings.nTable.getElementsByTagName("tfoot").length===0?null:oSettings.nTable.getElementsByTagName("tfoot")[0],oClasses=oSettings.oClasses;nScrollHead.appendChild(nScrollHeadInner);nScrollFoot.appendChild(nScrollFootInner);nScrollBody.appendChild(oSettings.nTable);nScroller.appendChild(nScrollHead);nScroller.appendChild(nScrollBody);nScrollHeadInner.appendChild(nScrollHeadTable);nScrollHeadTable.appendChild(nThead);if(nTfoot!==null){nScroller.appendChild(nScrollFoot);nScrollFootInner.appendChild(nScrollFootTable);nScrollFootTable.appendChild(nTfoot)}nScroller.className=oClasses.sScrollWrapper;nScrollHead.className=oClasses.sScrollHead;nScrollHeadInner.className=oClasses.sScrollHeadInner;nScrollBody.className=oClasses.sScrollBody;nScrollFoot.className=oClasses.sScrollFoot;nScrollFootInner.className=oClasses.sScrollFootInner;if(oSettings.oScroll.bAutoCss){nScrollHead.style.overflow="hidden";nScrollHead.style.position="relative";nScrollFoot.style.overflow="hidden";nScrollBody.style.overflow="auto"}nScrollHead.style.border="0";nScrollHead.style.width="100%";nScrollFoot.style.border="0";nScrollHeadInner.style.width=oSettings.oScroll.sXInner!==""?oSettings.oScroll.sXInner:"100%";nScrollHeadTable.removeAttribute("id");nScrollHeadTable.style.marginLeft="0";oSettings.nTable.style.marginLeft="0";if(nTfoot!==null){nScrollFootTable.removeAttribute("id");nScrollFootTable.style.marginLeft="0"}var nCaption=$(oSettings.nTable).children("caption");if(nCaption.length>0){nCaption=nCaption[0];if(nCaption._captionSide==="top"){nScrollHeadTable.appendChild(nCaption)}else{if(nCaption._captionSide==="bottom"&&nTfoot){nScrollFootTable.appendChild(nCaption)}}}if(oSettings.oScroll.sX!==""){nScrollHead.style.width=_fnStringToCss(oSettings.oScroll.sX);nScrollBody.style.width=_fnStringToCss(oSettings.oScroll.sX);if(nTfoot!==null){nScrollFoot.style.width=_fnStringToCss(oSettings.oScroll.sX)}$(nScrollBody).scroll(function(e){nScrollHead.scrollLeft=this.scrollLeft;if(nTfoot!==null){nScrollFoot.scrollLeft=this.scrollLeft}})}if(oSettings.oScroll.sY!==""){nScrollBody.style.height=_fnStringToCss(oSettings.oScroll.sY)}oSettings.aoDrawCallback.push({fn:_fnScrollDraw,sName:"scrolling"});if(oSettings.oScroll.bInfinite){$(nScrollBody).scroll(function(){if(!oSettings.bDrawing&&$(this).scrollTop()!==0){if($(this).scrollTop()+$(this).height()>$(oSettings.nTable).height()-oSettings.oScroll.iLoadGap){if(oSettings.fnDisplayEnd()<oSettings.fnRecordsDisplay()){_fnPageChange(oSettings,"next");_fnCalculateEnd(oSettings);_fnDraw(oSettings)}}}})}oSettings.nScrollHead=nScrollHead;oSettings.nScrollFoot=nScrollFoot;return nScroller}function _fnScrollDraw(o){var nScrollHeadInner=o.nScrollHead.getElementsByTagName("div")[0],nScrollHeadTable=nScrollHeadInner.getElementsByTagName("table")[0],nScrollBody=o.nTable.parentNode,i,iLen,j,jLen,anHeadToSize,anHeadSizers,anFootSizers,anFootToSize,oStyle,iVis,nTheadSize,nTfootSize,iWidth,aApplied=[],aAppliedFooter=[],iSanityWidth,nScrollFootInner=(o.nTFoot!==null)?o.nScrollFoot.getElementsByTagName("div")[0]:null,nScrollFootTable=(o.nTFoot!==null)?nScrollFootInner.getElementsByTagName("table")[0]:null,ie67=o.oBrowser.bScrollOversize,zeroOut=function(nSizer){oStyle=nSizer.style;oStyle.paddingTop="0";oStyle.paddingBottom="0";oStyle.borderTopWidth="0";oStyle.borderBottomWidth="0";oStyle.height=0};$(o.nTable).children("thead, tfoot").remove();nTheadSize=$(o.nTHead).clone()[0];o.nTable.insertBefore(nTheadSize,o.nTable.childNodes[0]);anHeadToSize=o.nTHead.getElementsByTagName("tr");anHeadSizers=nTheadSize.getElementsByTagName("tr");if(o.nTFoot!==null){nTfootSize=$(o.nTFoot).clone()[0];o.nTable.insertBefore(nTfootSize,o.nTable.childNodes[1]);anFootToSize=o.nTFoot.getElementsByTagName("tr");anFootSizers=nTfootSize.getElementsByTagName("tr")}if(o.oScroll.sX===""){nScrollBody.style.width="100%";nScrollHeadInner.parentNode.style.width="100%"}var nThs=_fnGetUniqueThs(o,nTheadSize);for(i=0,iLen=nThs.length;i<iLen;i++){iVis=_fnVisibleToColumnIndex(o,i);nThs[i].style.width=o.aoColumns[iVis].sWidth}if(o.nTFoot!==null){_fnApplyToChildren(function(n){n.style.width=""},anFootSizers)}if(o.oScroll.bCollapse&&o.oScroll.sY!==""){nScrollBody.style.height=(nScrollBody.offsetHeight+o.nTHead.offsetHeight)+"px"}iSanityWidth=$(o.nTable).outerWidth();if(o.oScroll.sX===""){o.nTable.style.width="100%";if(ie67&&($("tbody",nScrollBody).height()>nScrollBody.offsetHeight||$(nScrollBody).css("overflow-y")=="scroll")){o.nTable.style.width=_fnStringToCss($(o.nTable).outerWidth()-o.oScroll.iBarWidth)}}else{if(o.oScroll.sXInner!==""){o.nTable.style.width=_fnStringToCss(o.oScroll.sXInner)}else{if(iSanityWidth==$(nScrollBody).width()&&$(nScrollBody).height()<$(o.nTable).height()){o.nTable.style.width=_fnStringToCss(iSanityWidth-o.oScroll.iBarWidth);if($(o.nTable).outerWidth()>iSanityWidth-o.oScroll.iBarWidth){o.nTable.style.width=_fnStringToCss(iSanityWidth)}}else{o.nTable.style.width=_fnStringToCss(iSanityWidth)}}}iSanityWidth=$(o.nTable).outerWidth();_fnApplyToChildren(zeroOut,anHeadSizers);_fnApplyToChildren(function(nSizer){aApplied.push(_fnStringToCss($(nSizer).width()))},anHeadSizers);_fnApplyToChildren(function(nToSize,i){nToSize.style.width=aApplied[i]},anHeadToSize);$(anHeadSizers).height(0);if(o.nTFoot!==null){_fnApplyToChildren(zeroOut,anFootSizers);_fnApplyToChildren(function(nSizer){aAppliedFooter.push(_fnStringToCss($(nSizer).width()))},anFootSizers);_fnApplyToChildren(function(nToSize,i){nToSize.style.width=aAppliedFooter[i]},anFootToSize);$(anFootSizers).height(0)}_fnApplyToChildren(function(nSizer,i){nSizer.innerHTML="";nSizer.style.width=aApplied[i]},anHeadSizers);if(o.nTFoot!==null){_fnApplyToChildren(function(nSizer,i){nSizer.innerHTML="";nSizer.style.width=aAppliedFooter[i]},anFootSizers)}if($(o.nTable).outerWidth()<iSanityWidth){var iCorrection=((nScrollBody.scrollHeight>nScrollBody.offsetHeight||$(nScrollBody).css("overflow-y")=="scroll"))?iSanityWidth+o.oScroll.iBarWidth:iSanityWidth;if(ie67&&(nScrollBody.scrollHeight>nScrollBody.offsetHeight||$(nScrollBody).css("overflow-y")=="scroll")){o.nTable.style.width=_fnStringToCss(iCorrection-o.oScroll.iBarWidth)}nScrollBody.style.width=_fnStringToCss(iCorrection);o.nScrollHead.style.width=_fnStringToCss(iCorrection);if(o.nTFoot!==null){o.nScrollFoot.style.width=_fnStringToCss(iCorrection)}if(o.oScroll.sX===""){_fnLog(o,1,"The table cannot fit into the current element which will cause column misalignment. The table has been drawn at its minimum possible width.")}else{if(o.oScroll.sXInner!==""){_fnLog(o,1,"The table cannot fit into the current element which will cause column misalignment. Increase the sScrollXInner value or remove it to allow automatic calculation")}}}else{nScrollBody.style.width=_fnStringToCss("100%");o.nScrollHead.style.width=_fnStringToCss("100%");if(o.nTFoot!==null){o.nScrollFoot.style.width=_fnStringToCss("100%")}}if(o.oScroll.sY===""){if(ie67){nScrollBody.style.height=_fnStringToCss(o.nTable.offsetHeight+o.oScroll.iBarWidth)}}if(o.oScroll.sY!==""&&o.oScroll.bCollapse){nScrollBody.style.height=_fnStringToCss(o.oScroll.sY);var iExtra=(o.oScroll.sX!==""&&o.nTable.offsetWidth>nScrollBody.offsetWidth)?o.oScroll.iBarWidth:0;if(o.nTable.offsetHeight<nScrollBody.offsetHeight){nScrollBody.style.height=_fnStringToCss(o.nTable.offsetHeight+iExtra)}}var iOuterWidth=$(o.nTable).outerWidth();nScrollHeadTable.style.width=_fnStringToCss(iOuterWidth);nScrollHeadInner.style.width=_fnStringToCss(iOuterWidth);var bScrolling=$(o.nTable).height()>nScrollBody.clientHeight||$(nScrollBody).css("overflow-y")=="scroll";nScrollHeadInner.style.paddingRight=bScrolling?o.oScroll.iBarWidth+"px":"0px";if(o.nTFoot!==null){nScrollFootTable.style.width=_fnStringToCss(iOuterWidth);nScrollFootInner.style.width=_fnStringToCss(iOuterWidth);nScrollFootInner.style.paddingRight=bScrolling?o.oScroll.iBarWidth+"px":"0px"}$(nScrollBody).scroll();if(o.bSorted||o.bFiltered){nScrollBody.scrollTop=0}}function _fnApplyToChildren(fn,an1,an2){var index=0,i=0,iLen=an1.length;var nNode1,nNode2;while(i<iLen){nNode1=an1[i].firstChild;nNode2=an2?an2[i].firstChild:null;while(nNode1){if(nNode1.nodeType===1){if(an2){fn(nNode1,nNode2,index)}else{fn(nNode1,index)}index++}nNode1=nNode1.nextSibling;nNode2=an2?nNode2.nextSibling:null}i++}}function _fnConvertToWidth(sWidth,nParent){if(!sWidth||sWidth===null||sWidth===""){return 0}if(!nParent){nParent=document.body}var iWidth;var nTmp=document.createElement("div");nTmp.style.width=_fnStringToCss(sWidth);nParent.appendChild(nTmp);iWidth=nTmp.offsetWidth;nParent.removeChild(nTmp);return(iWidth)}function _fnCalculateColumnWidths(oSettings){var iTableWidth=oSettings.nTable.offsetWidth;var iUserInputs=0;var iTmpWidth;var iVisibleColumns=0;var iColums=oSettings.aoColumns.length;var i,iIndex,iCorrector,iWidth;var oHeaders=$("th",oSettings.nTHead);var widthAttr=oSettings.nTable.getAttribute("width");var nWrapper=oSettings.nTable.parentNode;for(i=0;i<iColums;i++){if(oSettings.aoColumns[i].bVisible){iVisibleColumns++;if(oSettings.aoColumns[i].sWidth!==null){iTmpWidth=_fnConvertToWidth(oSettings.aoColumns[i].sWidthOrig,nWrapper);if(iTmpWidth!==null){oSettings.aoColumns[i].sWidth=_fnStringToCss(iTmpWidth)}iUserInputs++}}}if(iColums==oHeaders.length&&iUserInputs===0&&iVisibleColumns==iColums&&oSettings.oScroll.sX===""&&oSettings.oScroll.sY===""){for(i=0;i<oSettings.aoColumns.length;i++){iTmpWidth=$(oHeaders[i]).width();if(iTmpWidth!==null){oSettings.aoColumns[i].sWidth=_fnStringToCss(iTmpWidth)}}}else{var nCalcTmp=oSettings.nTable.cloneNode(false),nTheadClone=oSettings.nTHead.cloneNode(true),nBody=document.createElement("tbody"),nTr=document.createElement("tr"),nDivSizing;nCalcTmp.removeAttribute("id");nCalcTmp.appendChild(nTheadClone);if(oSettings.nTFoot!==null){nCalcTmp.appendChild(oSettings.nTFoot.cloneNode(true));_fnApplyToChildren(function(n){n.style.width=""},nCalcTmp.getElementsByTagName("tr"))}nCalcTmp.appendChild(nBody);nBody.appendChild(nTr);var jqColSizing=$("thead th",nCalcTmp);if(jqColSizing.length===0){jqColSizing=$("tbody tr:eq(0)>td",nCalcTmp)}var nThs=_fnGetUniqueThs(oSettings,nTheadClone);iCorrector=0;for(i=0;i<iColums;i++){var oColumn=oSettings.aoColumns[i];if(oColumn.bVisible&&oColumn.sWidthOrig!==null&&oColumn.sWidthOrig!==""){nThs[i-iCorrector].style.width=_fnStringToCss(oColumn.sWidthOrig)}else{if(oColumn.bVisible){nThs[i-iCorrector].style.width=""}else{iCorrector++}}}for(i=0;i<iColums;i++){if(oSettings.aoColumns[i].bVisible){var nTd=_fnGetWidestNode(oSettings,i);if(nTd!==null){nTd=nTd.cloneNode(true);if(oSettings.aoColumns[i].sContentPadding!==""){nTd.innerHTML+=oSettings.aoColumns[i].sContentPadding}nTr.appendChild(nTd)}}}nWrapper.appendChild(nCalcTmp);if(oSettings.oScroll.sX!==""&&oSettings.oScroll.sXInner!==""){nCalcTmp.style.width=_fnStringToCss(oSettings.oScroll.sXInner)}else{if(oSettings.oScroll.sX!==""){nCalcTmp.style.width="";if($(nCalcTmp).width()<nWrapper.offsetWidth){nCalcTmp.style.width=_fnStringToCss(nWrapper.offsetWidth)}}else{if(oSettings.oScroll.sY!==""){nCalcTmp.style.width=_fnStringToCss(nWrapper.offsetWidth)}else{if(widthAttr){nCalcTmp.style.width=_fnStringToCss(widthAttr)}}}}nCalcTmp.style.visibility="hidden";_fnScrollingWidthAdjust(oSettings,nCalcTmp);var oNodes=$("tbody tr:eq(0)",nCalcTmp).children();if(oNodes.length===0){oNodes=_fnGetUniqueThs(oSettings,$("thead",nCalcTmp)[0])}if(oSettings.oScroll.sX!==""){var iTotal=0;iCorrector=0;for(i=0;i<oSettings.aoColumns.length;i++){if(oSettings.aoColumns[i].bVisible){if(oSettings.aoColumns[i].sWidthOrig===null){iTotal+=$(oNodes[iCorrector]).outerWidth()}else{iTotal+=parseInt(oSettings.aoColumns[i].sWidth.replace("px",""),10)+($(oNodes[iCorrector]).outerWidth()-$(oNodes[iCorrector]).width())}iCorrector++}}nCalcTmp.style.width=_fnStringToCss(iTotal);oSettings.nTable.style.width=_fnStringToCss(iTotal)}iCorrector=0;for(i=0;i<oSettings.aoColumns.length;i++){if(oSettings.aoColumns[i].bVisible){iWidth=$(oNodes[iCorrector]).width();if(iWidth!==null&&iWidth>0){oSettings.aoColumns[i].sWidth=_fnStringToCss(iWidth)}iCorrector++}}var cssWidth=$(nCalcTmp).css("width");oSettings.nTable.style.width=(cssWidth.indexOf("%")!==-1)?cssWidth:_fnStringToCss($(nCalcTmp).outerWidth());nCalcTmp.parentNode.removeChild(nCalcTmp)}if(widthAttr){oSettings.nTable.style.width=_fnStringToCss(widthAttr)}}function _fnScrollingWidthAdjust(oSettings,n){if(oSettings.oScroll.sX===""&&oSettings.oScroll.sY!==""){var iOrigWidth=$(n).width();n.style.width=_fnStringToCss($(n).outerWidth()-oSettings.oScroll.iBarWidth)}else{if(oSettings.oScroll.sX!==""){n.style.width=_fnStringToCss($(n).outerWidth())}}}function _fnGetWidestNode(oSettings,iCol){var iMaxIndex=_fnGetMaxLenString(oSettings,iCol);if(iMaxIndex<0){return null}if(oSettings.aoData[iMaxIndex].nTr===null){var n=document.createElement("td");n.innerHTML=_fnGetCellData(oSettings,iMaxIndex,iCol,"");return n}return _fnGetTdNodes(oSettings,iMaxIndex)[iCol]}function _fnGetMaxLenString(oSettings,iCol){var iMax=-1;var iMaxIndex=-1;for(var i=0;i<oSettings.aoData.length;i++){var s=_fnGetCellData(oSettings,i,iCol,"display")+"";s=s.replace(/<.*?>/g,"");if(s.length>iMax){iMax=s.length;iMaxIndex=i}}return iMaxIndex}function _fnStringToCss(s){if(s===null){return"0px"}if(typeof s=="number"){if(s<0){return"0px"}return s+"px"}var c=s.charCodeAt(s.length-1);if(c<48||c>57){return s}return s+"px"}function _fnScrollBarWidth(){var inner=document.createElement("p");var style=inner.style;style.width="100%";style.height="200px";style.padding="0px";var outer=document.createElement("div");style=outer.style;style.position="absolute";style.top="0px";style.left="0px";style.visibility="hidden";style.width="200px";style.height="150px";style.padding="0px";style.overflow="hidden";outer.appendChild(inner);document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow="scroll";var w2=inner.offsetWidth;if(w1==w2){w2=outer.clientWidth}document.body.removeChild(outer);return(w1-w2)}function _fnSort(oSettings,bApplyClasses){var i,iLen,j,jLen,k,kLen,sDataType,nTh,aaSort=[],aiOrig=[],oSort=DataTable.ext.oSort,aoData=oSettings.aoData,aoColumns=oSettings.aoColumns,oAria=oSettings.oLanguage.oAria;if(!oSettings.oFeatures.bServerSide&&(oSettings.aaSorting.length!==0||oSettings.aaSortingFixed!==null)){aaSort=(oSettings.aaSortingFixed!==null)?oSettings.aaSortingFixed.concat(oSettings.aaSorting):oSettings.aaSorting.slice();for(i=0;i<aaSort.length;i++){var iColumn=aaSort[i][0];var iVisColumn=_fnColumnIndexToVisible(oSettings,iColumn);sDataType=oSettings.aoColumns[iColumn].sSortDataType;if(DataTable.ext.afnSortData[sDataType]){var aData=DataTable.ext.afnSortData[sDataType].call(oSettings.oInstance,oSettings,iColumn,iVisColumn);if(aData.length===aoData.length){for(j=0,jLen=aoData.length;j<jLen;j++){_fnSetCellData(oSettings,j,iColumn,aData[j])}}else{_fnLog(oSettings,0,"Returned data sort array (col "+iColumn+") is the wrong length")}}}for(i=0,iLen=oSettings.aiDisplayMaster.length;i<iLen;i++){aiOrig[oSettings.aiDisplayMaster[i]]=i}var iSortLen=aaSort.length;var fnSortFormat,aDataSort;for(i=0,iLen=aoData.length;i<iLen;i++){for(j=0;j<iSortLen;j++){aDataSort=aoColumns[aaSort[j][0]].aDataSort;for(k=0,kLen=aDataSort.length;k<kLen;k++){sDataType=aoColumns[aDataSort[k]].sType;fnSortFormat=oSort[(sDataType?sDataType:"string")+"-pre"];aoData[i]._aSortData[aDataSort[k]]=fnSortFormat?fnSortFormat(_fnGetCellData(oSettings,i,aDataSort[k],"sort")):_fnGetCellData(oSettings,i,aDataSort[k],"sort")}}}oSettings.aiDisplayMaster.sort(function(a,b){var k,l,lLen,iTest,aDataSort,sDataType;for(k=0;k<iSortLen;k++){aDataSort=aoColumns[aaSort[k][0]].aDataSort;for(l=0,lLen=aDataSort.length;l<lLen;l++){sDataType=aoColumns[aDataSort[l]].sType;iTest=oSort[(sDataType?sDataType:"string")+"-"+aaSort[k][1]](aoData[a]._aSortData[aDataSort[l]],aoData[b]._aSortData[aDataSort[l]]);if(iTest!==0){return iTest}}}return oSort["numeric-asc"](aiOrig[a],aiOrig[b])})}if((bApplyClasses===undefined||bApplyClasses)&&!oSettings.oFeatures.bDeferRender){_fnSortingClasses(oSettings)}for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){var sTitle=aoColumns[i].sTitle.replace(/<.*?>/g,"");nTh=aoColumns[i].nTh;nTh.removeAttribute("aria-sort");nTh.removeAttribute("aria-label");if(aoColumns[i].bSortable){if(aaSort.length>0&&aaSort[0][0]==i){nTh.setAttribute("aria-sort",aaSort[0][1]=="asc"?"ascending":"descending");var nextSort=(aoColumns[i].asSorting[aaSort[0][2]+1])?aoColumns[i].asSorting[aaSort[0][2]+1]:aoColumns[i].asSorting[0];nTh.setAttribute("aria-label",sTitle+(nextSort=="asc"?oAria.sSortAscending:oAria.sSortDescending))}else{nTh.setAttribute("aria-label",sTitle+(aoColumns[i].asSorting[0]=="asc"?oAria.sSortAscending:oAria.sSortDescending))}}else{nTh.setAttribute("aria-label",sTitle)}}oSettings.bSorted=true;$(oSettings.oInstance).trigger("sort",oSettings);if(oSettings.oFeatures.bFilter){_fnFilterComplete(oSettings,oSettings.oPreviousSearch,1)}else{oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();oSettings._iDisplayStart=0;_fnCalculateEnd(oSettings);_fnDraw(oSettings)}}function _fnSortAttachListener(oSettings,nNode,iDataIndex,fnCallback){_fnBindAction(nNode,{},function(e){if(oSettings.aoColumns[iDataIndex].bSortable===false){return}var fnInnerSorting=function(){var iColumn,iNextSort;if(e.shiftKey){var bFound=false;for(var i=0;i<oSettings.aaSorting.length;i++){if(oSettings.aaSorting[i][0]==iDataIndex){bFound=true;iColumn=oSettings.aaSorting[i][0];iNextSort=oSettings.aaSorting[i][2]+1;if(!oSettings.aoColumns[iColumn].asSorting[iNextSort]){oSettings.aaSorting.splice(i,1)}else{oSettings.aaSorting[i][1]=oSettings.aoColumns[iColumn].asSorting[iNextSort];oSettings.aaSorting[i][2]=iNextSort}break}}if(bFound===false){oSettings.aaSorting.push([iDataIndex,oSettings.aoColumns[iDataIndex].asSorting[0],0])}}else{if(oSettings.aaSorting.length==1&&oSettings.aaSorting[0][0]==iDataIndex){iColumn=oSettings.aaSorting[0][0];iNextSort=oSettings.aaSorting[0][2]+1;if(!oSettings.aoColumns[iColumn].asSorting[iNextSort]){iNextSort=0}oSettings.aaSorting[0][1]=oSettings.aoColumns[iColumn].asSorting[iNextSort];oSettings.aaSorting[0][2]=iNextSort}else{oSettings.aaSorting.splice(0,oSettings.aaSorting.length);oSettings.aaSorting.push([iDataIndex,oSettings.aoColumns[iDataIndex].asSorting[0],0])}}_fnSort(oSettings)};if(!oSettings.oFeatures.bProcessing){fnInnerSorting()}else{_fnProcessingDisplay(oSettings,true);setTimeout(function(){fnInnerSorting();if(!oSettings.oFeatures.bServerSide){_fnProcessingDisplay(oSettings,false)}},0)}if(typeof fnCallback=="function"){fnCallback(oSettings)}})}function _fnSortingClasses(oSettings){var i,iLen,j,jLen,iFound;var aaSort,sClass;var iColumns=oSettings.aoColumns.length;var oClasses=oSettings.oClasses;for(i=0;i<iColumns;i++){if(oSettings.aoColumns[i].bSortable){$(oSettings.aoColumns[i].nTh).removeClass(oClasses.sSortAsc+" "+oClasses.sSortDesc+" "+oSettings.aoColumns[i].sSortingClass)}}if(oSettings.aaSortingFixed!==null){aaSort=oSettings.aaSortingFixed.concat(oSettings.aaSorting)}else{aaSort=oSettings.aaSorting.slice()}for(i=0;i<oSettings.aoColumns.length;i++){if(oSettings.aoColumns[i].bSortable){sClass=oSettings.aoColumns[i].sSortingClass;iFound=-1;for(j=0;j<aaSort.length;j++){if(aaSort[j][0]==i){sClass=(aaSort[j][1]=="asc")?oClasses.sSortAsc:oClasses.sSortDesc;iFound=j;break}}$(oSettings.aoColumns[i].nTh).addClass(sClass);if(oSettings.bJUI){var jqSpan=$("span."+oClasses.sSortIcon,oSettings.aoColumns[i].nTh);jqSpan.removeClass(oClasses.sSortJUIAsc+" "+oClasses.sSortJUIDesc+" "+oClasses.sSortJUI+" "+oClasses.sSortJUIAscAllowed+" "+oClasses.sSortJUIDescAllowed);var sSpanClass;if(iFound==-1){sSpanClass=oSettings.aoColumns[i].sSortingClassJUI}else{if(aaSort[iFound][1]=="asc"){sSpanClass=oClasses.sSortJUIAsc}else{sSpanClass=oClasses.sSortJUIDesc}}jqSpan.addClass(sSpanClass)}}else{$(oSettings.aoColumns[i].nTh).addClass(oSettings.aoColumns[i].sSortingClass)}}sClass=oClasses.sSortColumn;if(oSettings.oFeatures.bSort&&oSettings.oFeatures.bSortClasses){var nTds=_fnGetTdNodes(oSettings);var iClass,iTargetCol;var asClasses=[];for(i=0;i<iColumns;i++){asClasses.push("")}for(i=0,iClass=1;i<aaSort.length;i++){iTargetCol=parseInt(aaSort[i][0],10);asClasses[iTargetCol]=sClass+iClass;if(iClass<3){iClass++}}var reClass=new RegExp(sClass+"[123]");var sTmpClass,sCurrentClass,sNewClass;for(i=0,iLen=nTds.length;i<iLen;i++){iTargetCol=i%iColumns;sCurrentClass=nTds[i].className;sNewClass=asClasses[iTargetCol];sTmpClass=sCurrentClass.replace(reClass,sNewClass);if(sTmpClass!=sCurrentClass){nTds[i].className=$.trim(sTmpClass)}else{if(sNewClass.length>0&&sCurrentClass.indexOf(sNewClass)==-1){nTds[i].className=sCurrentClass+" "+sNewClass}}}}}function _fnSaveState(oSettings){if(!oSettings.oFeatures.bStateSave||oSettings.bDestroying){return}var i,iLen,bInfinite=oSettings.oScroll.bInfinite;var oState={iCreate:new Date().getTime(),iStart:(bInfinite?0:oSettings._iDisplayStart),iEnd:(bInfinite?oSettings._iDisplayLength:oSettings._iDisplayEnd),iLength:oSettings._iDisplayLength,aaSorting:$.extend(true,[],oSettings.aaSorting),oSearch:$.extend(true,{},oSettings.oPreviousSearch),aoSearchCols:$.extend(true,[],oSettings.aoPreSearchCols),abVisCols:[]};for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){oState.abVisCols.push(oSettings.aoColumns[i].bVisible)}_fnCallbackFire(oSettings,"aoStateSaveParams","stateSaveParams",[oSettings,oState]);oSettings.fnStateSave.call(oSettings.oInstance,oSettings,oState)}function _fnLoadState(oSettings,oInit){if(!oSettings.oFeatures.bStateSave){return}var oData=oSettings.fnStateLoad.call(oSettings.oInstance,oSettings);if(!oData){return}var abStateLoad=_fnCallbackFire(oSettings,"aoStateLoadParams","stateLoadParams",[oSettings,oData]);if($.inArray(false,abStateLoad)!==-1){return}oSettings.oLoadedState=$.extend(true,{},oData);oSettings._iDisplayStart=oData.iStart;oSettings.iInitDisplayStart=oData.iStart;oSettings._iDisplayEnd=oData.iEnd;oSettings._iDisplayLength=oData.iLength;oSettings.aaSorting=oData.aaSorting.slice();oSettings.saved_aaSorting=oData.aaSorting.slice();$.extend(oSettings.oPreviousSearch,oData.oSearch);$.extend(true,oSettings.aoPreSearchCols,oData.aoSearchCols);oInit.saved_aoColumns=[];for(var i=0;i<oData.abVisCols.length;i++){oInit.saved_aoColumns[i]={};oInit.saved_aoColumns[i].bVisible=oData.abVisCols[i]}_fnCallbackFire(oSettings,"aoStateLoaded","stateLoaded",[oSettings,oData])}function _fnCreateCookie(sName,sValue,iSecs,sBaseName,fnCallback){var date=new Date();date.setTime(date.getTime()+(iSecs*1000));var aParts=window.location.pathname.split("/");var sNameFile=sName+"_"+aParts.pop().replace(/[\/:]/g,"").toLowerCase();var sFullCookie,oData;if(fnCallback!==null){oData=(typeof $.parseJSON==="function")?$.parseJSON(sValue):eval("("+sValue+")");sFullCookie=fnCallback(sNameFile,oData,date.toGMTString(),aParts.join("/")+"/")}else{sFullCookie=sNameFile+"="+encodeURIComponent(sValue)+"; expires="+date.toGMTString()+"; path="+aParts.join("/")+"/"}var aCookies=document.cookie.split(";"),iNewCookieLen=sFullCookie.split(";")[0].length,aOldCookies=[];if(iNewCookieLen+document.cookie.length+10>4096){for(var i=0,iLen=aCookies.length;i<iLen;i++){if(aCookies[i].indexOf(sBaseName)!=-1){var aSplitCookie=aCookies[i].split("=");try{oData=eval("("+decodeURIComponent(aSplitCookie[1])+")");if(oData&&oData.iCreate){aOldCookies.push({name:aSplitCookie[0],time:oData.iCreate})}}catch(e){}}}aOldCookies.sort(function(a,b){return b.time-a.time});while(iNewCookieLen+document.cookie.length+10>4096){if(aOldCookies.length===0){return}var old=aOldCookies.pop();document.cookie=old.name+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path="+aParts.join("/")+"/"}}document.cookie=sFullCookie}function _fnReadCookie(sName){var aParts=window.location.pathname.split("/"),sNameEQ=sName+"_"+aParts[aParts.length-1].replace(/[\/:]/g,"").toLowerCase()+"=",sCookieContents=document.cookie.split(";");for(var i=0;i<sCookieContents.length;i++){var c=sCookieContents[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(sNameEQ)===0){return decodeURIComponent(c.substring(sNameEQ.length,c.length))}}return null}function _fnSettingsFromNode(nTable){for(var i=0;i<DataTable.settings.length;i++){if(DataTable.settings[i].nTable===nTable){return DataTable.settings[i]}}return null}function _fnGetTrNodes(oSettings){var aNodes=[];var aoData=oSettings.aoData;for(var i=0,iLen=aoData.length;i<iLen;i++){if(aoData[i].nTr!==null){aNodes.push(aoData[i].nTr)}}return aNodes}function _fnGetTdNodes(oSettings,iIndividualRow){var anReturn=[];var iCorrector;var anTds,nTd;var iRow,iRows=oSettings.aoData.length,iColumn,iColumns,oData,sNodeName,iStart=0,iEnd=iRows;if(iIndividualRow!==undefined){iStart=iIndividualRow;iEnd=iIndividualRow+1}for(iRow=iStart;iRow<iEnd;iRow++){oData=oSettings.aoData[iRow];if(oData.nTr!==null){anTds=[];nTd=oData.nTr.firstChild;while(nTd){sNodeName=nTd.nodeName.toLowerCase();if(sNodeName=="td"||sNodeName=="th"){anTds.push(nTd)}nTd=nTd.nextSibling}iCorrector=0;for(iColumn=0,iColumns=oSettings.aoColumns.length;iColumn<iColumns;iColumn++){if(oSettings.aoColumns[iColumn].bVisible){anReturn.push(anTds[iColumn-iCorrector])}else{anReturn.push(oData._anHidden[iColumn]);iCorrector++}}}}return anReturn}function _fnLog(oSettings,iLevel,sMesg){var sAlert=(oSettings===null)?"DataTables warning: "+sMesg:"DataTables warning (table id = '"+oSettings.sTableId+"'): "+sMesg;if(iLevel===0){if(DataTable.ext.sErrMode=="alert"){alert(sAlert)}else{throw new Error(sAlert)}return}else{if(window.console&&console.log){console.log(sAlert)}}}function _fnMap(oRet,oSrc,sName,sMappedName){if(sMappedName===undefined){sMappedName=sName}if(oSrc[sName]!==undefined){oRet[sMappedName]=oSrc[sName]}}function _fnExtend(oOut,oExtender){var val;for(var prop in oExtender){if(oExtender.hasOwnProperty(prop)){val=oExtender[prop];if(typeof oInit[prop]==="object"&&val!==null&&$.isArray(val)===false){$.extend(true,oOut[prop],val)}else{oOut[prop]=val}}}return oOut}function _fnBindAction(n,oData,fn){$(n).bind("click.DT",oData,function(e){n.blur();fn(e)}).bind("keypress.DT",oData,function(e){if(e.which===13){fn(e)}}).bind("selectstart.DT",function(){return false})}function _fnCallbackReg(oSettings,sStore,fn,sName){if(fn){oSettings[sStore].push({fn:fn,sName:sName})}}function _fnCallbackFire(oSettings,sStore,sTrigger,aArgs){var aoStore=oSettings[sStore];var aRet=[];for(var i=aoStore.length-1;i>=0;i--){aRet.push(aoStore[i].fn.apply(oSettings.oInstance,aArgs))}if(sTrigger!==null){$(oSettings.oInstance).trigger(sTrigger,aArgs)}return aRet}var _fnJsonString=(window.JSON)?JSON.stringify:function(o){var sType=typeof o;if(sType!=="object"||o===null){if(sType==="string"){o='"'+o+'"'}return o+""}var sProp,mValue,json=[],bArr=$.isArray(o);for(sProp in o){mValue=o[sProp];sType=typeof mValue;if(sType==="string"){mValue='"'+mValue+'"'}else{if(sType==="object"&&mValue!==null){mValue=_fnJsonString(mValue)}}json.push((bArr?"":'"'+sProp+'":')+mValue)}return(bArr?"[":"{")+json+(bArr?"]":"}")};function _fnBrowserDetect(oSettings){var n=$('<div style="position:absolute; top:0; left:0; height:1px; width:1px; overflow:hidden"><div style="position:absolute; top:1px; left:1px; width:100px; overflow:scroll;"><div id="DT_BrowserTest" style="width:100%; height:10px;"></div></div></div>')[0];document.body.appendChild(n);oSettings.oBrowser.bScrollOversize=$("#DT_BrowserTest",n)[0].offsetWidth===100?true:false;document.body.removeChild(n)}this.$=function(sSelector,oOpts){var i,iLen,a=[],tr;var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);var aoData=oSettings.aoData;var aiDisplay=oSettings.aiDisplay;var aiDisplayMaster=oSettings.aiDisplayMaster;if(!oOpts){oOpts={}}oOpts=$.extend({},{filter:"none",order:"current",page:"all"},oOpts);if(oOpts.page=="current"){for(i=oSettings._iDisplayStart,iLen=oSettings.fnDisplayEnd();i<iLen;i++){tr=aoData[aiDisplay[i]].nTr;if(tr){a.push(tr)}}}else{if(oOpts.order=="current"&&oOpts.filter=="none"){for(i=0,iLen=aiDisplayMaster.length;i<iLen;i++){tr=aoData[aiDisplayMaster[i]].nTr;if(tr){a.push(tr)}}}else{if(oOpts.order=="current"&&oOpts.filter=="applied"){for(i=0,iLen=aiDisplay.length;i<iLen;i++){tr=aoData[aiDisplay[i]].nTr;if(tr){a.push(tr)}}}else{if(oOpts.order=="original"&&oOpts.filter=="none"){for(i=0,iLen=aoData.length;i<iLen;i++){tr=aoData[i].nTr;if(tr){a.push(tr)}}}else{if(oOpts.order=="original"&&oOpts.filter=="applied"){for(i=0,iLen=aoData.length;i<iLen;i++){tr=aoData[i].nTr;if($.inArray(i,aiDisplay)!==-1&&tr){a.push(tr)}}}else{_fnLog(oSettings,1,"Unknown selection options")}}}}}var jqA=$(a);var jqTRs=jqA.filter(sSelector);var jqDescendants=jqA.find(sSelector);return $([].concat($.makeArray(jqTRs),$.makeArray(jqDescendants)))};this._=function(sSelector,oOpts){var aOut=[];var i,iLen,iIndex;var aTrs=this.$(sSelector,oOpts);for(i=0,iLen=aTrs.length;i<iLen;i++){aOut.push(this.fnGetData(aTrs[i]))}return aOut};this.fnAddData=function(mData,bRedraw){if(mData.length===0){return[]}var aiReturn=[];var iTest;var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(typeof mData[0]==="object"&&mData[0]!==null){for(var i=0;i<mData.length;i++){iTest=_fnAddData(oSettings,mData[i]);if(iTest==-1){return aiReturn}aiReturn.push(iTest)}}else{iTest=_fnAddData(oSettings,mData);if(iTest==-1){return aiReturn}aiReturn.push(iTest)}oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();if(bRedraw===undefined||bRedraw){_fnReDraw(oSettings)}return aiReturn};this.fnAdjustColumnSizing=function(bRedraw){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnAdjustColumnSizing(oSettings);if(bRedraw===undefined||bRedraw){this.fnDraw(false)}else{if(oSettings.oScroll.sX!==""||oSettings.oScroll.sY!==""){this.oApi._fnScrollDraw(oSettings)}}};this.fnClearTable=function(bRedraw){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnClearTable(oSettings);if(bRedraw===undefined||bRedraw){_fnDraw(oSettings)}};this.fnClose=function(nTr){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);for(var i=0;i<oSettings.aoOpenRows.length;i++){if(oSettings.aoOpenRows[i].nParent==nTr){var nTrParent=oSettings.aoOpenRows[i].nTr.parentNode;if(nTrParent){nTrParent.removeChild(oSettings.aoOpenRows[i].nTr)}oSettings.aoOpenRows.splice(i,1);return 0}}return 1};this.fnDeleteRow=function(mTarget,fnCallBack,bRedraw){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);var i,iLen,iAODataIndex;iAODataIndex=(typeof mTarget==="object")?_fnNodeToDataIndex(oSettings,mTarget):mTarget;var oData=oSettings.aoData.splice(iAODataIndex,1);for(i=0,iLen=oSettings.aoData.length;i<iLen;i++){if(oSettings.aoData[i].nTr!==null){oSettings.aoData[i].nTr._DT_RowIndex=i}}var iDisplayIndex=$.inArray(iAODataIndex,oSettings.aiDisplay);oSettings.asDataSearch.splice(iDisplayIndex,1);_fnDeleteIndex(oSettings.aiDisplayMaster,iAODataIndex);_fnDeleteIndex(oSettings.aiDisplay,iAODataIndex);if(typeof fnCallBack==="function"){fnCallBack.call(this,oSettings,oData)}if(oSettings._iDisplayStart>=oSettings.fnRecordsDisplay()){oSettings._iDisplayStart-=oSettings._iDisplayLength;if(oSettings._iDisplayStart<0){oSettings._iDisplayStart=0}}if(bRedraw===undefined||bRedraw){_fnCalculateEnd(oSettings);_fnDraw(oSettings)}return oData};this.fnDestroy=function(bRemove){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);var nOrig=oSettings.nTableWrapper.parentNode;var nBody=oSettings.nTBody;var i,iLen;bRemove=(bRemove===undefined)?false:bRemove;oSettings.bDestroying=true;_fnCallbackFire(oSettings,"aoDestroyCallback","destroy",[oSettings]);if(!bRemove){for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){if(oSettings.aoColumns[i].bVisible===false){this.fnSetColumnVis(i,true)}}}$(oSettings.nTableWrapper).find("*").andSelf().unbind(".DT");$("tbody>tr>td."+oSettings.oClasses.sRowEmpty,oSettings.nTable).parent().remove();if(oSettings.nTable!=oSettings.nTHead.parentNode){$(oSettings.nTable).children("thead").remove();oSettings.nTable.appendChild(oSettings.nTHead)}if(oSettings.nTFoot&&oSettings.nTable!=oSettings.nTFoot.parentNode){$(oSettings.nTable).children("tfoot").remove();oSettings.nTable.appendChild(oSettings.nTFoot)}oSettings.nTable.parentNode.removeChild(oSettings.nTable);$(oSettings.nTableWrapper).remove();oSettings.aaSorting=[];oSettings.aaSortingFixed=[];_fnSortingClasses(oSettings);$(_fnGetTrNodes(oSettings)).removeClass(oSettings.asStripeClasses.join(" "));$("th, td",oSettings.nTHead).removeClass([oSettings.oClasses.sSortable,oSettings.oClasses.sSortableAsc,oSettings.oClasses.sSortableDesc,oSettings.oClasses.sSortableNone].join(" "));if(oSettings.bJUI){$("th span."+oSettings.oClasses.sSortIcon+", td span."+oSettings.oClasses.sSortIcon,oSettings.nTHead).remove();$("th, td",oSettings.nTHead).each(function(){var jqWrapper=$("div."+oSettings.oClasses.sSortJUIWrapper,this);var kids=jqWrapper.contents();$(this).append(kids);jqWrapper.remove()})}if(!bRemove&&oSettings.nTableReinsertBefore){nOrig.insertBefore(oSettings.nTable,oSettings.nTableReinsertBefore)}else{if(!bRemove){nOrig.appendChild(oSettings.nTable)}}for(i=0,iLen=oSettings.aoData.length;i<iLen;i++){if(oSettings.aoData[i].nTr!==null){nBody.appendChild(oSettings.aoData[i].nTr)}}if(oSettings.oFeatures.bAutoWidth===true){oSettings.nTable.style.width=_fnStringToCss(oSettings.sDestroyWidth)}iLen=oSettings.asDestroyStripes.length;if(iLen){var anRows=$(nBody).children("tr");for(i=0;i<iLen;i++){anRows.filter(":nth-child("+iLen+"n + "+i+")").addClass(oSettings.asDestroyStripes[i])}}for(i=0,iLen=DataTable.settings.length;i<iLen;i++){if(DataTable.settings[i]==oSettings){DataTable.settings.splice(i,1)}}oSettings=null;oInit=null};this.fnDraw=function(bComplete){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(bComplete===false){_fnCalculateEnd(oSettings);_fnDraw(oSettings)}else{_fnReDraw(oSettings)}};this.fnFilter=function(sInput,iColumn,bRegex,bSmart,bShowGlobal,bCaseInsensitive){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(!oSettings.oFeatures.bFilter){return}if(bRegex===undefined||bRegex===null){bRegex=false}if(bSmart===undefined||bSmart===null){bSmart=true}if(bShowGlobal===undefined||bShowGlobal===null){bShowGlobal=true}if(bCaseInsensitive===undefined||bCaseInsensitive===null){bCaseInsensitive=true}if(iColumn===undefined||iColumn===null){_fnFilterComplete(oSettings,{sSearch:sInput+"",bRegex:bRegex,bSmart:bSmart,bCaseInsensitive:bCaseInsensitive},1);if(bShowGlobal&&oSettings.aanFeatures.f){var n=oSettings.aanFeatures.f;for(var i=0,iLen=n.length;i<iLen;i++){try{if(n[i]._DT_Input!=document.activeElement){$(n[i]._DT_Input).val(sInput)}}catch(e){$(n[i]._DT_Input).val(sInput)}}}}else{$.extend(oSettings.aoPreSearchCols[iColumn],{sSearch:sInput+"",bRegex:bRegex,bSmart:bSmart,bCaseInsensitive:bCaseInsensitive});_fnFilterComplete(oSettings,oSettings.oPreviousSearch,1)}};this.fnGetData=function(mRow,iCol){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(mRow!==undefined){var iRow=mRow;if(typeof mRow==="object"){var sNode=mRow.nodeName.toLowerCase();if(sNode==="tr"){iRow=_fnNodeToDataIndex(oSettings,mRow)}else{if(sNode==="td"){iRow=_fnNodeToDataIndex(oSettings,mRow.parentNode);iCol=_fnNodeToColumnIndex(oSettings,iRow,mRow)}}}if(iCol!==undefined){return _fnGetCellData(oSettings,iRow,iCol,"")}return(oSettings.aoData[iRow]!==undefined)?oSettings.aoData[iRow]._aData:null}return _fnGetDataMaster(oSettings)};this.fnGetNodes=function(iRow){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(iRow!==undefined){return(oSettings.aoData[iRow]!==undefined)?oSettings.aoData[iRow].nTr:null}return _fnGetTrNodes(oSettings)};this.fnGetPosition=function(nNode){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);var sNodeName=nNode.nodeName.toUpperCase();if(sNodeName=="TR"){return _fnNodeToDataIndex(oSettings,nNode)}else{if(sNodeName=="TD"||sNodeName=="TH"){var iDataIndex=_fnNodeToDataIndex(oSettings,nNode.parentNode);var iColumnIndex=_fnNodeToColumnIndex(oSettings,iDataIndex,nNode);return[iDataIndex,_fnColumnIndexToVisible(oSettings,iColumnIndex),iColumnIndex]}}return null};this.fnIsOpen=function(nTr){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);var aoOpenRows=oSettings.aoOpenRows;for(var i=0;i<oSettings.aoOpenRows.length;i++){if(oSettings.aoOpenRows[i].nParent==nTr){return true}}return false};this.fnOpen=function(nTr,mHtml,sClass){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);var nTableRows=_fnGetTrNodes(oSettings);if($.inArray(nTr,nTableRows)===-1){return}this.fnClose(nTr);var nNewRow=document.createElement("tr");var nNewCell=document.createElement("td");nNewRow.appendChild(nNewCell);nNewCell.className=sClass;nNewCell.colSpan=_fnVisbleColumns(oSettings);if(typeof mHtml==="string"){nNewCell.innerHTML=mHtml}else{$(nNewCell).html(mHtml)}var nTrs=$("tr",oSettings.nTBody);if($.inArray(nTr,nTrs)!=-1){$(nNewRow).insertAfter(nTr)}oSettings.aoOpenRows.push({nTr:nNewRow,nParent:nTr});return nNewRow};this.fnPageChange=function(mAction,bRedraw){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnPageChange(oSettings,mAction);_fnCalculateEnd(oSettings);if(bRedraw===undefined||bRedraw){_fnDraw(oSettings)}};this.fnSetColumnVis=function(iCol,bShow,bRedraw){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);var i,iLen;var aoColumns=oSettings.aoColumns;var aoData=oSettings.aoData;var nTd,bAppend,iBefore;if(aoColumns[iCol].bVisible==bShow){return}if(bShow){var iInsert=0;for(i=0;i<iCol;i++){if(aoColumns[i].bVisible){iInsert++}}bAppend=(iInsert>=_fnVisbleColumns(oSettings));if(!bAppend){for(i=iCol;i<aoColumns.length;i++){if(aoColumns[i].bVisible){iBefore=i;break}}}for(i=0,iLen=aoData.length;i<iLen;i++){if(aoData[i].nTr!==null){if(bAppend){aoData[i].nTr.appendChild(aoData[i]._anHidden[iCol])}else{aoData[i].nTr.insertBefore(aoData[i]._anHidden[iCol],_fnGetTdNodes(oSettings,i)[iBefore])}}}}else{for(i=0,iLen=aoData.length;i<iLen;i++){if(aoData[i].nTr!==null){nTd=_fnGetTdNodes(oSettings,i)[iCol];aoData[i]._anHidden[iCol]=nTd;nTd.parentNode.removeChild(nTd)}}}aoColumns[iCol].bVisible=bShow;_fnDrawHead(oSettings,oSettings.aoHeader);if(oSettings.nTFoot){_fnDrawHead(oSettings,oSettings.aoFooter)}for(i=0,iLen=oSettings.aoOpenRows.length;i<iLen;i++){oSettings.aoOpenRows[i].nTr.colSpan=_fnVisbleColumns(oSettings)}if(bRedraw===undefined||bRedraw){_fnAdjustColumnSizing(oSettings);_fnDraw(oSettings)}_fnSaveState(oSettings)};this.fnSettings=function(){return _fnSettingsFromNode(this[DataTable.ext.iApiIndex])};this.fnSort=function(aaSort){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);oSettings.aaSorting=aaSort;_fnSort(oSettings)};this.fnSortListener=function(nNode,iColumn,fnCallback){_fnSortAttachListener(_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),nNode,iColumn,fnCallback)};this.fnUpdate=function(mData,mRow,iColumn,bRedraw,bAction){var oSettings=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);var i,iLen,sDisplay;var iRow=(typeof mRow==="object")?_fnNodeToDataIndex(oSettings,mRow):mRow;if($.isArray(mData)&&iColumn===undefined){oSettings.aoData[iRow]._aData=mData.slice();for(i=0;i<oSettings.aoColumns.length;i++){this.fnUpdate(_fnGetCellData(oSettings,iRow,i),iRow,i,false,false)}}else{if($.isPlainObject(mData)&&iColumn===undefined){oSettings.aoData[iRow]._aData=$.extend(true,{},mData);for(i=0;i<oSettings.aoColumns.length;i++){this.fnUpdate(_fnGetCellData(oSettings,iRow,i),iRow,i,false,false)}}else{_fnSetCellData(oSettings,iRow,iColumn,mData);sDisplay=_fnGetCellData(oSettings,iRow,iColumn,"display");var oCol=oSettings.aoColumns[iColumn];if(oCol.fnRender!==null){sDisplay=_fnRender(oSettings,iRow,iColumn);if(oCol.bUseRendered){_fnSetCellData(oSettings,iRow,iColumn,sDisplay)}}if(oSettings.aoData[iRow].nTr!==null){_fnGetTdNodes(oSettings,iRow)[iColumn].innerHTML=sDisplay}}}var iDisplayIndex=$.inArray(iRow,oSettings.aiDisplay);oSettings.asDataSearch[iDisplayIndex]=_fnBuildSearchRow(oSettings,_fnGetRowData(oSettings,iRow,"filter",_fnGetColumns(oSettings,"bSearchable")));if(bAction===undefined||bAction){_fnAdjustColumnSizing(oSettings)}if(bRedraw===undefined||bRedraw){_fnReDraw(oSettings)}return 0};this.fnVersionCheck=DataTable.ext.fnVersionCheck;function _fnExternApiFunc(sFunc){return function(){var aArgs=[_fnSettingsFromNode(this[DataTable.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return DataTable.ext.oApi[sFunc].apply(this,aArgs)}}this.oApi={_fnExternApiFunc:_fnExternApiFunc,_fnInitialise:_fnInitialise,_fnInitComplete:_fnInitComplete,_fnLanguageCompat:_fnLanguageCompat,_fnAddColumn:_fnAddColumn,_fnColumnOptions:_fnColumnOptions,_fnAddData:_fnAddData,_fnCreateTr:_fnCreateTr,_fnGatherData:_fnGatherData,_fnBuildHead:_fnBuildHead,_fnDrawHead:_fnDrawHead,_fnDraw:_fnDraw,_fnReDraw:_fnReDraw,_fnAjaxUpdate:_fnAjaxUpdate,_fnAjaxParameters:_fnAjaxParameters,_fnAjaxUpdateDraw:_fnAjaxUpdateDraw,_fnServerParams:_fnServerParams,_fnAddOptionsHtml:_fnAddOptionsHtml,_fnFeatureHtmlTable:_fnFeatureHtmlTable,_fnScrollDraw:_fnScrollDraw,_fnAdjustColumnSizing:_fnAdjustColumnSizing,_fnFeatureHtmlFilter:_fnFeatureHtmlFilter,_fnFilterComplete:_fnFilterComplete,_fnFilterCustom:_fnFilterCustom,_fnFilterColumn:_fnFilterColumn,_fnFilter:_fnFilter,_fnBuildSearchArray:_fnBuildSearchArray,_fnBuildSearchRow:_fnBuildSearchRow,_fnFilterCreateSearch:_fnFilterCreateSearch,_fnDataToSearch:_fnDataToSearch,_fnSort:_fnSort,_fnSortAttachListener:_fnSortAttachListener,_fnSortingClasses:_fnSortingClasses,_fnFeatureHtmlPaginate:_fnFeatureHtmlPaginate,_fnPageChange:_fnPageChange,_fnFeatureHtmlInfo:_fnFeatureHtmlInfo,_fnUpdateInfo:_fnUpdateInfo,_fnFeatureHtmlLength:_fnFeatureHtmlLength,_fnFeatureHtmlProcessing:_fnFeatureHtmlProcessing,_fnProcessingDisplay:_fnProcessingDisplay,_fnVisibleToColumnIndex:_fnVisibleToColumnIndex,_fnColumnIndexToVisible:_fnColumnIndexToVisible,_fnNodeToDataIndex:_fnNodeToDataIndex,_fnVisbleColumns:_fnVisbleColumns,_fnCalculateEnd:_fnCalculateEnd,_fnConvertToWidth:_fnConvertToWidth,_fnCalculateColumnWidths:_fnCalculateColumnWidths,_fnScrollingWidthAdjust:_fnScrollingWidthAdjust,_fnGetWidestNode:_fnGetWidestNode,_fnGetMaxLenString:_fnGetMaxLenString,_fnStringToCss:_fnStringToCss,_fnDetectType:_fnDetectType,_fnSettingsFromNode:_fnSettingsFromNode,_fnGetDataMaster:_fnGetDataMaster,_fnGetTrNodes:_fnGetTrNodes,_fnGetTdNodes:_fnGetTdNodes,_fnEscapeRegex:_fnEscapeRegex,_fnDeleteIndex:_fnDeleteIndex,_fnReOrderIndex:_fnReOrderIndex,_fnColumnOrdering:_fnColumnOrdering,_fnLog:_fnLog,_fnClearTable:_fnClearTable,_fnSaveState:_fnSaveState,_fnLoadState:_fnLoadState,_fnCreateCookie:_fnCreateCookie,_fnReadCookie:_fnReadCookie,_fnDetectHeader:_fnDetectHeader,_fnGetUniqueThs:_fnGetUniqueThs,_fnScrollBarWidth:_fnScrollBarWidth,_fnApplyToChildren:_fnApplyToChildren,_fnMap:_fnMap,_fnGetRowData:_fnGetRowData,_fnGetCellData:_fnGetCellData,_fnSetCellData:_fnSetCellData,_fnGetObjectDataFn:_fnGetObjectDataFn,_fnSetObjectDataFn:_fnSetObjectDataFn,_fnApplyColumnDefs:_fnApplyColumnDefs,_fnBindAction:_fnBindAction,_fnExtend:_fnExtend,_fnCallbackReg:_fnCallbackReg,_fnCallbackFire:_fnCallbackFire,_fnJsonString:_fnJsonString,_fnRender:_fnRender,_fnNodeToColumnIndex:_fnNodeToColumnIndex,_fnInfoMacros:_fnInfoMacros,_fnBrowserDetect:_fnBrowserDetect,_fnGetColumns:_fnGetColumns};$.extend(DataTable.ext.oApi,this.oApi);for(var sFunc in DataTable.ext.oApi){if(sFunc){this[sFunc]=_fnExternApiFunc(sFunc)}}var _that=this;this.each(function(){var i=0,iLen,j,jLen,k,kLen;var sId=this.getAttribute("id");var bInitHandedOff=false;var bUsePassedData=false;if(this.nodeName.toLowerCase()!="table"){_fnLog(null,0,"Attempted to initialise DataTables on a node which is not a table: "+this.nodeName);return}for(i=0,iLen=DataTable.settings.length;i<iLen;i++){if(DataTable.settings[i].nTable==this){if(oInit===undefined||oInit.bRetrieve){return DataTable.settings[i].oInstance}else{if(oInit.bDestroy){DataTable.settings[i].oInstance.fnDestroy();break}else{_fnLog(DataTable.settings[i],0,"Cannot reinitialise DataTable.\n\nTo retrieve the DataTables object for this table, pass no arguments or see the docs for bRetrieve and bDestroy");return}}}if(DataTable.settings[i].sTableId==this.id){DataTable.settings.splice(i,1);break}}if(sId===null||sId===""){sId="DataTables_Table_"+(DataTable.ext._oExternConfig.iNextUnique++);this.id=sId}var oSettings=$.extend(true,{},DataTable.models.oSettings,{nTable:this,oApi:_that.oApi,oInit:oInit,sDestroyWidth:$(this).width(),sInstance:sId,sTableId:sId});DataTable.settings.push(oSettings);oSettings.oInstance=(_that.length===1)?_that:$(this).dataTable();if(!oInit){oInit={}}if(oInit.oLanguage){_fnLanguageCompat(oInit.oLanguage)}oInit=_fnExtend($.extend(true,{},DataTable.defaults),oInit);_fnMap(oSettings.oFeatures,oInit,"bPaginate");_fnMap(oSettings.oFeatures,oInit,"bLengthChange");_fnMap(oSettings.oFeatures,oInit,"bFilter");_fnMap(oSettings.oFeatures,oInit,"bSort");_fnMap(oSettings.oFeatures,oInit,"bInfo");_fnMap(oSettings.oFeatures,oInit,"bProcessing");_fnMap(oSettings.oFeatures,oInit,"bAutoWidth");_fnMap(oSettings.oFeatures,oInit,"bSortClasses");_fnMap(oSettings.oFeatures,oInit,"bServerSide");_fnMap(oSettings.oFeatures,oInit,"bDeferRender");_fnMap(oSettings.oScroll,oInit,"sScrollX","sX");_fnMap(oSettings.oScroll,oInit,"sScrollXInner","sXInner");_fnMap(oSettings.oScroll,oInit,"sScrollY","sY");_fnMap(oSettings.oScroll,oInit,"bScrollCollapse","bCollapse");_fnMap(oSettings.oScroll,oInit,"bScrollInfinite","bInfinite");_fnMap(oSettings.oScroll,oInit,"iScrollLoadGap","iLoadGap");_fnMap(oSettings.oScroll,oInit,"bScrollAutoCss","bAutoCss");_fnMap(oSettings,oInit,"asStripeClasses");_fnMap(oSettings,oInit,"asStripClasses","asStripeClasses");_fnMap(oSettings,oInit,"fnServerData");_fnMap(oSettings,oInit,"fnFormatNumber");_fnMap(oSettings,oInit,"sServerMethod");_fnMap(oSettings,oInit,"aaSorting");_fnMap(oSettings,oInit,"aaSortingFixed");_fnMap(oSettings,oInit,"aLengthMenu");_fnMap(oSettings,oInit,"sPaginationType");_fnMap(oSettings,oInit,"sAjaxSource");_fnMap(oSettings,oInit,"sAjaxDataProp");_fnMap(oSettings,oInit,"iCookieDuration");_fnMap(oSettings,oInit,"sCookiePrefix");_fnMap(oSettings,oInit,"sDom");_fnMap(oSettings,oInit,"bSortCellsTop");_fnMap(oSettings,oInit,"iTabIndex");_fnMap(oSettings,oInit,"oSearch","oPreviousSearch");_fnMap(oSettings,oInit,"aoSearchCols","aoPreSearchCols");_fnMap(oSettings,oInit,"iDisplayLength","_iDisplayLength");_fnMap(oSettings,oInit,"bJQueryUI","bJUI");_fnMap(oSettings,oInit,"fnCookieCallback");_fnMap(oSettings,oInit,"fnStateLoad");_fnMap(oSettings,oInit,"fnStateSave");_fnMap(oSettings.oLanguage,oInit,"fnInfoCallback");_fnCallbackReg(oSettings,"aoDrawCallback",oInit.fnDrawCallback,"user");_fnCallbackReg(oSettings,"aoServerParams",oInit.fnServerParams,"user");_fnCallbackReg(oSettings,"aoStateSaveParams",oInit.fnStateSaveParams,"user");_fnCallbackReg(oSettings,"aoStateLoadParams",oInit.fnStateLoadParams,"user");_fnCallbackReg(oSettings,"aoStateLoaded",oInit.fnStateLoaded,"user");_fnCallbackReg(oSettings,"aoRowCallback",oInit.fnRowCallback,"user");_fnCallbackReg(oSettings,"aoRowCreatedCallback",oInit.fnCreatedRow,"user");_fnCallbackReg(oSettings,"aoHeaderCallback",oInit.fnHeaderCallback,"user");_fnCallbackReg(oSettings,"aoFooterCallback",oInit.fnFooterCallback,"user");_fnCallbackReg(oSettings,"aoInitComplete",oInit.fnInitComplete,"user");_fnCallbackReg(oSettings,"aoPreDrawCallback",oInit.fnPreDrawCallback,"user");if(oSettings.oFeatures.bServerSide&&oSettings.oFeatures.bSort&&oSettings.oFeatures.bSortClasses){_fnCallbackReg(oSettings,"aoDrawCallback",_fnSortingClasses,"server_side_sort_classes")}else{if(oSettings.oFeatures.bDeferRender){_fnCallbackReg(oSettings,"aoDrawCallback",_fnSortingClasses,"defer_sort_classes")}}if(oInit.bJQueryUI){$.extend(oSettings.oClasses,DataTable.ext.oJUIClasses);if(oInit.sDom===DataTable.defaults.sDom&&DataTable.defaults.sDom==="lfrtip"){oSettings.sDom='<"H"lfr>t<"F"ip>'}}else{$.extend(oSettings.oClasses,DataTable.ext.oStdClasses)}$(this).addClass(oSettings.oClasses.sTable);if(oSettings.oScroll.sX!==""||oSettings.oScroll.sY!==""){oSettings.oScroll.iBarWidth=_fnScrollBarWidth()}if(oSettings.iInitDisplayStart===undefined){oSettings.iInitDisplayStart=oInit.iDisplayStart;oSettings._iDisplayStart=oInit.iDisplayStart}if(oInit.bStateSave){oSettings.oFeatures.bStateSave=true;_fnLoadState(oSettings,oInit);_fnCallbackReg(oSettings,"aoDrawCallback",_fnSaveState,"state_save")}if(oInit.iDeferLoading!==null){oSettings.bDeferLoading=true;var tmp=$.isArray(oInit.iDeferLoading);oSettings._iRecordsDisplay=tmp?oInit.iDeferLoading[0]:oInit.iDeferLoading;oSettings._iRecordsTotal=tmp?oInit.iDeferLoading[1]:oInit.iDeferLoading}if(oInit.aaData!==null){bUsePassedData=true}if(oInit.oLanguage.sUrl!==""){oSettings.oLanguage.sUrl=oInit.oLanguage.sUrl;$.getJSON(oSettings.oLanguage.sUrl,null,function(json){_fnLanguageCompat(json);$.extend(true,oSettings.oLanguage,oInit.oLanguage,json);_fnInitialise(oSettings)});bInitHandedOff=true}else{$.extend(true,oSettings.oLanguage,oInit.oLanguage)}if(oInit.asStripeClasses===null){oSettings.asStripeClasses=[oSettings.oClasses.sStripeOdd,oSettings.oClasses.sStripeEven]}iLen=oSettings.asStripeClasses.length;oSettings.asDestroyStripes=[];if(iLen){var bStripeRemove=false;var anRows=$(this).children("tbody").children("tr:lt("+iLen+")");for(i=0;i<iLen;i++){if(anRows.hasClass(oSettings.asStripeClasses[i])){bStripeRemove=true;oSettings.asDestroyStripes.push(oSettings.asStripeClasses[i])}}if(bStripeRemove){anRows.removeClass(oSettings.asStripeClasses.join(" "))}}var anThs=[];var aoColumnsInit;var nThead=this.getElementsByTagName("thead");if(nThead.length!==0){_fnDetectHeader(oSettings.aoHeader,nThead[0]);anThs=_fnGetUniqueThs(oSettings)}if(oInit.aoColumns===null){aoColumnsInit=[];for(i=0,iLen=anThs.length;i<iLen;i++){aoColumnsInit.push(null)}}else{aoColumnsInit=oInit.aoColumns}for(i=0,iLen=aoColumnsInit.length;i<iLen;i++){if(oInit.saved_aoColumns!==undefined&&oInit.saved_aoColumns.length==iLen){if(aoColumnsInit[i]===null){aoColumnsInit[i]={}}aoColumnsInit[i].bVisible=oInit.saved_aoColumns[i].bVisible}_fnAddColumn(oSettings,anThs?anThs[i]:null)}_fnApplyColumnDefs(oSettings,oInit.aoColumnDefs,aoColumnsInit,function(iCol,oDef){_fnColumnOptions(oSettings,iCol,oDef)});for(i=0,iLen=oSettings.aaSorting.length;i<iLen;i++){if(oSettings.aaSorting[i][0]>=oSettings.aoColumns.length){oSettings.aaSorting[i][0]=0}var oColumn=oSettings.aoColumns[oSettings.aaSorting[i][0]];if(oSettings.aaSorting[i][2]===undefined){oSettings.aaSorting[i][2]=0}if(oInit.aaSorting===undefined&&oSettings.saved_aaSorting===undefined){oSettings.aaSorting[i][1]=oColumn.asSorting[0]}for(j=0,jLen=oColumn.asSorting.length;j<jLen;j++){if(oSettings.aaSorting[i][1]==oColumn.asSorting[j]){oSettings.aaSorting[i][2]=j;break}}}_fnSortingClasses(oSettings);_fnBrowserDetect(oSettings);var captions=$(this).children("caption").each(function(){this._captionSide=$(this).css("caption-side")});var thead=$(this).children("thead");if(thead.length===0){thead=[document.createElement("thead")];this.appendChild(thead[0])}oSettings.nTHead=thead[0];var tbody=$(this).children("tbody");if(tbody.length===0){tbody=[document.createElement("tbody")];this.appendChild(tbody[0])}oSettings.nTBody=tbody[0];oSettings.nTBody.setAttribute("role","alert");oSettings.nTBody.setAttribute("aria-live","polite");oSettings.nTBody.setAttribute("aria-relevant","all");var tfoot=$(this).children("tfoot");if(tfoot.length===0&&captions.length>0&&(oSettings.oScroll.sX!==""||oSettings.oScroll.sY!=="")){tfoot=[document.createElement("tfoot")];this.appendChild(tfoot[0])}if(tfoot.length>0){oSettings.nTFoot=tfoot[0];_fnDetectHeader(oSettings.aoFooter,oSettings.nTFoot)}if(bUsePassedData){for(i=0;i<oInit.aaData.length;i++){_fnAddData(oSettings,oInit.aaData[i])}}else{_fnGatherData(oSettings)}oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();oSettings.bInitialised=true;if(bInitHandedOff===false){_fnInitialise(oSettings)}});_that=null;return this};DataTable.fnVersionCheck=function(sVersion){var fnZPad=function(Zpad,count){while(Zpad.length<count){Zpad+="0"}return Zpad};var aThis=DataTable.ext.sVersion.split(".");var aThat=sVersion.split(".");var sThis="",sThat="";for(var i=0,iLen=aThat.length;i<iLen;i++){sThis+=fnZPad(aThis[i],3);sThat+=fnZPad(aThat[i],3)}return parseInt(sThis,10)>=parseInt(sThat,10)};DataTable.fnIsDataTable=function(nTable){var o=DataTable.settings;for(var i=0;i<o.length;i++){if(o[i].nTable===nTable||o[i].nScrollHead===nTable||o[i].nScrollFoot===nTable){return true}}return false};DataTable.fnTables=function(bVisible){var out=[];jQuery.each(DataTable.settings,function(i,o){if(!bVisible||(bVisible===true&&$(o.nTable).is(":visible"))){out.push(o.nTable)}});return out};DataTable.version="1.9.4";DataTable.settings=[];DataTable.models={};DataTable.models.ext={afnFiltering:[],afnSortData:[],aoFeatures:[],aTypes:[],fnVersionCheck:DataTable.fnVersionCheck,iApiIndex:0,ofnSearch:{},oApi:{},oStdClasses:{},oJUIClasses:{},oPagination:{},oSort:{},sVersion:DataTable.version,sErrMode:"alert",_oExternConfig:{iNextUnique:0}};DataTable.models.oSearch={bCaseInsensitive:true,sSearch:"",bRegex:false,bSmart:true};DataTable.models.oRow={nTr:null,_aData:[],_aSortData:[],_anHidden:[],_sRowStripe:""};DataTable.models.oColumn={aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bUseRendered:null,bVisible:null,_bAutoType:true,fnCreatedCell:null,fnGetData:null,fnRender:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null};DataTable.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:true,bDeferRender:false,bDestroy:false,bFilter:true,bInfo:true,bJQueryUI:false,bLengthChange:true,bPaginate:true,bProcessing:false,bRetrieve:false,bScrollAutoCss:true,bScrollCollapse:false,bScrollInfinite:false,bServerSide:false,bSort:true,bSortCellsTop:false,bSortClasses:true,bStateSave:false,fnCookieCallback:null,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(iIn){if(iIn<1000){return iIn}var s=(iIn+""),a=s.split(""),out="",iLen=s.length;for(var i=0;i<iLen;i++){if(i%3===0&&i!==0){out=this.oLanguage.sInfoThousands+out}out=a[iLen-i-1]+out}return out},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:function(sUrl,aoData,fnCallback,oSettings){oSettings.jqXHR=$.ajax({url:sUrl,data:aoData,success:function(json){if(json.sError){oSettings.oApi._fnLog(oSettings,0,json.sError)}$(oSettings.oInstance).trigger("xhr",[oSettings,json]);fnCallback(json)},dataType:"json",cache:false,type:oSettings.sServerMethod,error:function(xhr,error,thrown){if(error=="parsererror"){oSettings.oApi._fnLog(oSettings,0,"DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}}})},fnServerParams:null,fnStateLoad:function(oSettings){var sData=this.oApi._fnReadCookie(oSettings.sCookiePrefix+oSettings.sInstance);var oData;try{oData=(typeof $.parseJSON==="function")?$.parseJSON(sData):eval("("+sData+")")}catch(e){oData=null}return oData},fnStateLoadParams:null,fnStateLoaded:null,fnStateSave:function(oSettings,oData){this.oApi._fnCreateCookie(oSettings.sCookiePrefix+oSettings.sInstance,this.oApi._fnJsonString(oData),oSettings.iCookieDuration,oSettings.sCookiePrefix,oSettings.fnCookieCallback)},fnStateSaveParams:null,iCookieDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iScrollLoadGap:100,iTabIndex:0,oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sInfoThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sUrl:"",sZeroRecords:"No matching records found"},oSearch:$.extend({},DataTable.models.oSearch),sAjaxDataProp:"aaData",sAjaxSource:null,sCookiePrefix:"SpryMedia_DataTables_",sDom:"lfrtip",sPaginationType:"two_button",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET"};DataTable.defaults.columns={aDataSort:null,asSorting:["asc","desc"],bSearchable:true,bSortable:true,bUseRendered:true,bVisible:true,fnCreatedCell:null,fnRender:null,iDataSort:-1,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null};DataTable.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortClasses:null,bStateSave:null},oScroll:{bAutoCss:null,bCollapse:null,bInfinite:null,iBarWidth:0,iLoadGap:null,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:false},aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],asDataSearch:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:null,asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:false,bInitialised:false,aoOpenRows:[],sDom:null,sPaginationType:"two_button",iCookieDuration:0,sCookiePrefix:"",fnCookieCallback:null,aoStateSave:[],aoStateLoad:[],oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:true,jqXHR:null,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:false,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iDisplayEnd:10,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:false,bSorted:false,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){if(this.oFeatures.bServerSide){return parseInt(this._iRecordsTotal,10)}else{return this.aiDisplayMaster.length}},fnRecordsDisplay:function(){if(this.oFeatures.bServerSide){return parseInt(this._iRecordsDisplay,10)}else{return this.aiDisplay.length}},fnDisplayEnd:function(){if(this.oFeatures.bServerSide){if(this.oFeatures.bPaginate===false||this._iDisplayLength==-1){return this._iDisplayStart+this.aiDisplay.length}else{return Math.min(this._iDisplayStart+this._iDisplayLength,this._iRecordsDisplay)}}else{return this._iDisplayEnd}},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null};DataTable.ext=$.extend(true,{},DataTable.models.ext);$.extend(DataTable.ext.oStdClasses,{sTable:"dataTable",sPagePrevEnabled:"paginate_enabled_previous",sPagePrevDisabled:"paginate_disabled_previous",sPageNextEnabled:"paginate_enabled_next",sPageNextDisabled:"paginate_disabled_next",sPageJUINext:"",sPageJUIPrev:"",sPageButton:"paginate_button",sPageButtonActive:"paginate_active",sPageButtonStaticDisabled:"paginate_button paginate_button_disabled",sPageFirst:"first",sPagePrevious:"previous",sPageNext:"next",sPageLast:"last",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sFooterTH:"",sJUIHeader:"",sJUIFooter:""});$.extend(DataTable.ext.oJUIClasses,DataTable.ext.oStdClasses,{sPagePrevEnabled:"fg-button ui-button ui-state-default ui-corner-left",sPagePrevDisabled:"fg-button ui-button ui-state-default ui-corner-left ui-state-disabled",sPageNextEnabled:"fg-button ui-button ui-state-default ui-corner-right",sPageNextDisabled:"fg-button ui-button ui-state-default ui-corner-right ui-state-disabled",sPageJUINext:"ui-icon ui-icon-circle-arrow-e",sPageJUIPrev:"ui-icon ui-icon-circle-arrow-w",sPageButton:"fg-button ui-button ui-state-default",sPageButtonActive:"fg-button ui-button ui-state-default ui-state-disabled",sPageButtonStaticDisabled:"fg-button ui-button ui-state-default ui-state-disabled",sPageFirst:"first ui-corner-tl ui-corner-bl",sPageLast:"last ui-corner-tr ui-corner-br",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:"ui-state-default",sSortDesc:"ui-state-default",sSortable:"ui-state-default",sSortableAsc:"ui-state-default",sSortableDesc:"ui-state-default",sSortableNone:"ui-state-default",sSortJUIAsc:"css_right ui-icon ui-icon-triangle-1-n",sSortJUIDesc:"css_right ui-icon ui-icon-triangle-1-s",sSortJUI:"css_right ui-icon ui-icon-carat-2-n-s",sSortJUIAscAllowed:"css_right ui-icon ui-icon-carat-1-n",sSortJUIDescAllowed:"css_right ui-icon ui-icon-carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead ui-state-default",sScrollFoot:"dataTables_scrollFoot ui-state-default",sFooterTH:"ui-state-default",sJUIHeader:"fg-toolbar ui-toolbar ui-widget-header ui-corner-tl ui-corner-tr ui-helper-clearfix",sJUIFooter:"fg-toolbar ui-toolbar ui-widget-header ui-corner-bl ui-corner-br ui-helper-clearfix"});$.extend(DataTable.ext.oPagination,{two_button:{fnInit:function(oSettings,nPaging,fnCallbackDraw){var oLang=oSettings.oLanguage.oPaginate;var oClasses=oSettings.oClasses;var fnClickHandler=function(e){if(oSettings.oApi._fnPageChange(oSettings,e.data.action)){fnCallbackDraw(oSettings)}};var sAppend=(!oSettings.bJUI)?'<a class="'+oSettings.oClasses.sPagePrevDisabled+'" tabindex="'+oSettings.iTabIndex+'" role="button">'+oLang.sPrevious+'</a><a class="'+oSettings.oClasses.sPageNextDisabled+'" tabindex="'+oSettings.iTabIndex+'" role="button">'+oLang.sNext+"</a>":'<a class="'+oSettings.oClasses.sPagePrevDisabled+'" tabindex="'+oSettings.iTabIndex+'" role="button"><span class="'+oSettings.oClasses.sPageJUIPrev+'"></span></a><a class="'+oSettings.oClasses.sPageNextDisabled+'" tabindex="'+oSettings.iTabIndex+'" role="button"><span class="'+oSettings.oClasses.sPageJUINext+'"></span></a>';$(nPaging).append(sAppend);var els=$("a",nPaging);var nPrevious=els[0],nNext=els[1];oSettings.oApi._fnBindAction(nPrevious,{action:"previous"},fnClickHandler);oSettings.oApi._fnBindAction(nNext,{action:"next"},fnClickHandler);if(!oSettings.aanFeatures.p){nPaging.id=oSettings.sTableId+"_paginate";nPrevious.id=oSettings.sTableId+"_previous";nNext.id=oSettings.sTableId+"_next";nPrevious.setAttribute("aria-controls",oSettings.sTableId);nNext.setAttribute("aria-controls",oSettings.sTableId)}},fnUpdate:function(oSettings,fnCallbackDraw){if(!oSettings.aanFeatures.p){return}var oClasses=oSettings.oClasses;var an=oSettings.aanFeatures.p;var nNode;for(var i=0,iLen=an.length;i<iLen;i++){nNode=an[i].firstChild;if(nNode){nNode.className=(oSettings._iDisplayStart===0)?oClasses.sPagePrevDisabled:oClasses.sPagePrevEnabled;nNode=nNode.nextSibling;nNode.className=(oSettings.fnDisplayEnd()==oSettings.fnRecordsDisplay())?oClasses.sPageNextDisabled:oClasses.sPageNextEnabled}}}},iFullNumbersShowPages:5,full_numbers:{fnInit:function(oSettings,nPaging,fnCallbackDraw){var oLang=oSettings.oLanguage.oPaginate;var oClasses=oSettings.oClasses;var fnClickHandler=function(e){if(oSettings.oApi._fnPageChange(oSettings,e.data.action)){fnCallbackDraw(oSettings)}};$(nPaging).append('<a  tabindex="'+oSettings.iTabIndex+'" class="'+oClasses.sPageButton+" "+oClasses.sPageFirst+'">'+oLang.sFirst+'</a><a  tabindex="'+oSettings.iTabIndex+'" class="'+oClasses.sPageButton+" "+oClasses.sPagePrevious+'">'+oLang.sPrevious+'</a><span></span><a tabindex="'+oSettings.iTabIndex+'" class="'+oClasses.sPageButton+" "+oClasses.sPageNext+'">'+oLang.sNext+'</a><a tabindex="'+oSettings.iTabIndex+'" class="'+oClasses.sPageButton+" "+oClasses.sPageLast+'">'+oLang.sLast+"</a>");var els=$("a",nPaging);var nFirst=els[0],nPrev=els[1],nNext=els[2],nLast=els[3];oSettings.oApi._fnBindAction(nFirst,{action:"first"},fnClickHandler);oSettings.oApi._fnBindAction(nPrev,{action:"previous"},fnClickHandler);oSettings.oApi._fnBindAction(nNext,{action:"next"},fnClickHandler);oSettings.oApi._fnBindAction(nLast,{action:"last"},fnClickHandler);if(!oSettings.aanFeatures.p){nPaging.id=oSettings.sTableId+"_paginate";nFirst.id=oSettings.sTableId+"_first";nPrev.id=oSettings.sTableId+"_previous";nNext.id=oSettings.sTableId+"_next";nLast.id=oSettings.sTableId+"_last"}},fnUpdate:function(oSettings,fnCallbackDraw){if(!oSettings.aanFeatures.p){return}var iPageCount=DataTable.ext.oPagination.iFullNumbersShowPages;var iPageCountHalf=Math.floor(iPageCount/2);var iPages=Math.ceil((oSettings.fnRecordsDisplay())/oSettings._iDisplayLength);var iCurrentPage=Math.ceil(oSettings._iDisplayStart/oSettings._iDisplayLength)+1;var sList="";var iStartButton,iEndButton,i,iLen;var oClasses=oSettings.oClasses;var anButtons,anStatic,nPaginateList,nNode;var an=oSettings.aanFeatures.p;var fnBind=function(j){oSettings.oApi._fnBindAction(this,{page:j+iStartButton-1},function(e){oSettings.oApi._fnPageChange(oSettings,e.data.page);fnCallbackDraw(oSettings);e.preventDefault()})};if(oSettings._iDisplayLength===-1){iStartButton=1;iEndButton=1;iCurrentPage=1}else{if(iPages<iPageCount){iStartButton=1;iEndButton=iPages}else{if(iCurrentPage<=iPageCountHalf){iStartButton=1;iEndButton=iPageCount}else{if(iCurrentPage>=(iPages-iPageCountHalf)){iStartButton=iPages-iPageCount+1;iEndButton=iPages}else{iStartButton=iCurrentPage-Math.ceil(iPageCount/2)+1;iEndButton=iStartButton+iPageCount-1}}}}for(i=iStartButton;i<=iEndButton;i++){sList+=(iCurrentPage!==i)?'<a tabindex="'+oSettings.iTabIndex+'" class="'+oClasses.sPageButton+'">'+oSettings.fnFormatNumber(i)+"</a>":'<a tabindex="'+oSettings.iTabIndex+'" class="'+oClasses.sPageButtonActive+'">'+oSettings.fnFormatNumber(i)+"</a>"}for(i=0,iLen=an.length;i<iLen;i++){nNode=an[i];if(!nNode.hasChildNodes()){continue}$("span:eq(0)",nNode).html(sList).children("a").each(fnBind);anButtons=nNode.getElementsByTagName("a");anStatic=[anButtons[0],anButtons[1],anButtons[anButtons.length-2],anButtons[anButtons.length-1]];$(anStatic).removeClass(oClasses.sPageButton+" "+oClasses.sPageButtonActive+" "+oClasses.sPageButtonStaticDisabled);$([anStatic[0],anStatic[1]]).addClass((iCurrentPage==1)?oClasses.sPageButtonStaticDisabled:oClasses.sPageButton);$([anStatic[2],anStatic[3]]).addClass((iPages===0||iCurrentPage===iPages||oSettings._iDisplayLength===-1)?oClasses.sPageButtonStaticDisabled:oClasses.sPageButton)}}}});$.extend(DataTable.ext.oSort,{"string-pre":function(a){if(typeof a!="string"){a=(a!==null&&a.toString)?a.toString():""}return a.toLowerCase()},"string-asc":function(x,y){return((x<y)?-1:((x>y)?1:0))},"string-desc":function(x,y){return((x<y)?1:((x>y)?-1:0))},"html-pre":function(a){return a.replace(/<.*?>/g,"").toLowerCase()},"html-asc":function(x,y){return((x<y)?-1:((x>y)?1:0))},"html-desc":function(x,y){return((x<y)?1:((x>y)?-1:0))},"date-pre":function(a){var x=Date.parse(a);if(isNaN(x)||x===""){x=Date.parse("01/01/1970 00:00:00")}return x},"date-asc":function(x,y){return x-y},"date-desc":function(x,y){return y-x},"numeric-pre":function(a){return(a=="-"||a==="")?0:a*1},"numeric-asc":function(x,y){return x-y},"numeric-desc":function(x,y){return y-x}});$.extend(DataTable.ext.aTypes,[function(sData){if(typeof sData==="number"){return"numeric"}else{if(typeof sData!=="string"){return null}}var sValidFirstChars="0123456789-";var sValidChars="0123456789.";var Char;var bDecimal=false;Char=sData.charAt(0);if(sValidFirstChars.indexOf(Char)==-1){return null}for(var i=1;i<sData.length;i++){Char=sData.charAt(i);if(sValidChars.indexOf(Char)==-1){return null}if(Char=="."){if(bDecimal){return null}bDecimal=true}}return"numeric"},function(sData){var iParse=Date.parse(sData);if((iParse!==null&&!isNaN(iParse))||(typeof sData==="string"&&sData.length===0)){return"date"}return null},function(sData){if(typeof sData==="string"&&sData.indexOf("<")!=-1&&sData.indexOf(">")!=-1){return"html"}return null}]);$.fn.DataTable=DataTable;$.fn.dataTable=DataTable;$.fn.dataTableSettings=DataTable.settings;$.fn.dataTableExt=DataTable.ext}))}(window,document));function _fnFeatureHtmlFilter(d){var a=d.oPreviousSearch;var e=d.oLanguage.sSearch;e=(e.indexOf("_INPUT_")!==-1)?e.replace("_INPUT_",'<input type="text" />'):e===""?'<input type="text" />':e+' <input type="text" />';var b=document.createElement("div");b.className=d.oClasses.sFilter;b.innerHTML="<label>"+e+"</label>";if(!d.aanFeatures.f){b.id=d.sTableId+"_filter"}var c=$('input[type="text"]',b);b._DT_Input=c[0];c.val(a.sSearch.replace('"',"&quot;"));c.bind("keyup.DT",function(h){var k=d.aanFeatures.f;var j=this.value===""?"":this.value;for(var g=0,f=k.length;g<f;g++){if(k[g]!=$(this).parents("div.dataTables_filter")[0]){$(k[g]._DT_Input).val(j)}}if(j!=a.sSearch){_fnFilterComplete(d,{sSearch:j,bRegex:a.bRegex,bSmart:a.bSmart,bCaseInsensitive:a.bCaseInsensitive})}});c.attr("aria-controls",d.sTableId).bind("keypress.DT",function(f){if(f.keyCode==13){return false}});return b}function _fnFilterComplete(c,g,f){var b=c.oPreviousSearch;var e=c.aoPreSearchCols;var d=function(h){b.sSearch=h.sSearch;b.bRegex=h.bRegex;b.bSmart=h.bSmart;b.bCaseInsensitive=h.bCaseInsensitive};if(!c.oFeatures.bServerSide){_fnFilter(c,g.sSearch,f,g.bRegex,g.bSmart,g.bCaseInsensitive);d(g);for(var a=0;a<c.aoPreSearchCols.length;a++){_fnFilterColumn(c,e[a].sSearch,a,e[a].bRegex,e[a].bSmart,e[a].bCaseInsensitive)}_fnFilterCustom(c)}else{d(g)}c.bFiltered=true;$(c.oInstance).trigger("filter",c);c._iDisplayStart=0;_fnCalculateEnd(c);_fnDraw(c);_fnBuildSearchArray(c,0)}function _fnFilterCustom(a){var k=DataTable.ext.afnFiltering;var g=_fnGetColumns(a,"bSearchable");for(var d=0,b=k.length;d<b;d++){var l=0;for(var c=0,h=a.aiDisplay.length;c<h;c++){var f=a.aiDisplay[c-l];var e=k[d](a,_fnGetRowData(a,f,"filter",g),f);if(!e){a.aiDisplay.splice(c-l,1);l++}}}}function _fnFilterColumn(a,k,e,g,j,f){if(k===""){return}var b=0;var c=_fnFilterCreateSearch(k,g,j,f);for(var d=a.aiDisplay.length-1;d>=0;d--){var h=_fnDataToSearch(_fnGetCellData(a,a.aiDisplay[d],e,"filter"),a.aoColumns[e].sType);if(!c.test(h)){a.aiDisplay.splice(d,1);b++}}}function _fnFilter(d,k,b,h,j,g){var f;var e=_fnFilterCreateSearch(k,h,j,g);var a=d.oPreviousSearch;if(!b){b=0}if(DataTable.ext.afnFiltering.length!==0){b=1}if(k.length<=0){d.aiDisplay.splice(0,d.aiDisplay.length);d.aiDisplay=d.aiDisplayMaster.slice()}else{if(d.aiDisplay.length==d.aiDisplayMaster.length||a.sSearch.length>k.length||b==1||k.indexOf(a.sSearch)!==0){d.aiDisplay.splice(0,d.aiDisplay.length);_fnBuildSearchArray(d,1);for(f=0;f<d.aiDisplayMaster.length;f++){if(e.test(d.asDataSearch[f])){d.aiDisplay.push(d.aiDisplayMaster[f])}}}else{var c=0;for(f=0;f<d.asDataSearch.length;f++){if(!e.test(d.asDataSearch[f])){d.aiDisplay.splice(f-c,1);c++}}}}}function _fnBuildSearchArray(f,e){if(!f.oFeatures.bServerSide){f.asDataSearch=[];var b=_fnGetColumns(f,"bSearchable");var d=(e===1)?f.aiDisplayMaster:f.aiDisplay;for(var c=0,a=d.length;c<a;c++){f.asDataSearch[c]=_fnBuildSearchRow(f,_fnGetRowData(f,d[c],"filter",b))}}}function _fnBuildSearchRow(c,a){var b=a.join("  ");if(b.indexOf("&")!==-1){b=$("<div>").html(b).text()}return b.replace(/[\n\r]/g," ")}function _fnFilterCreateSearch(e,b,d,a){var c,f;if(d){c=b?e.split(" "):_fnEscapeRegex(e).split(" ");f="^(?=.*?"+c.join(")(?=.*?")+").*$";return new RegExp(f,a?"i":"")}else{e=b?e:_fnEscapeRegex(e);return new RegExp(e,a?"i":"")}}function _fnDataToSearch(a,b){if(typeof DataTable.ext.ofnSearch[b]==="function"){return DataTable.ext.ofnSearch[b](a)}else{if(a===null){return""}else{if(b=="html"){return a.replace(/[\r\n]/g," ").replace(/<.*?>/g,"")}else{if(typeof a==="string"){return a.replace(/[\r\n]/g," ")}}}}return a}function _fnEscapeRegex(a){var b=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"];var c=new RegExp("(\\"+b.join("|\\")+")","g");return a.replace(c,"\\$1")}var ZeroClipboard_TableTools={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(b){"string"==typeof b&&(b=document.getElementById(b));b.addClass||(b.hide=function(){this.style.display="none"},b.show=function(){this.style.display=""},b.addClass=function(c){this.removeClass(c);this.className+=" "+c},b.removeClass=function(c){this.className=this.className.replace(RegExp("\\s*"+c+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},b.hasClass=function(c){return !!this.className.match(RegExp("\\s*"+c+"\\s*"))});return b},setMoviePath:function(b){this.moviePath=b},dispatch:function(e,d,f){(e=this.clients[e])&&e.receiveEvent(d,f)},register:function(d,c){this.clients[d]=c},getDOMObjectPosition:function(d){var c={left:0,top:0,width:d.width?d.width:d.offsetWidth,height:d.height?d.height:d.offsetHeight};""!=d.style.width&&(c.width=d.style.width.replace("px",""));""!=d.style.height&&(c.height=d.style.height.replace("px",""));for(;d;){c.left+=d.offsetLeft,c.top+=d.offsetTop,d=d.offsetParent}return c},Client:function(b){this.handlers={};this.id=ZeroClipboard_TableTools.nextId++;this.movieId="ZeroClipboard_TableToolsMovie_"+this.id;ZeroClipboard_TableTools.register(this.id,this);b&&this.glue(b)}};ZeroClipboard_TableTools.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,glue:function(g,f){this.domElement=ZeroClipboard_TableTools.$(g);var k=99;this.domElement.style.zIndex&&(k=parseInt(this.domElement.style.zIndex)+1);var j=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);this.div=document.createElement("div");var h=this.div.style;h.position="absolute";h.left="0px";h.top="0px";h.width=j.width+"px";h.height=j.height+"px";h.zIndex=k;"undefined"!=typeof f&&""!=f&&(this.div.title=f);0!=j.width&&0!=j.height&&(this.sized=!0);this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(j.width,j.height))},positionElement:function(){var d=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement),c=this.div.style;c.position="absolute";c.width=d.width+"px";c.height=d.height+"px";0!=d.width&&0!=d.height&&(this.sized=!0,c=this.div.childNodes[0],c.width=d.width,c.height=d.height)},getHTML:function(g,f){var k="",j="id="+this.id+"&width="+g+"&height="+f;if(navigator.userAgent.match(/MSIE/)){var h=location.href.match(/^https/i)?"https://":"http://",k=k+('<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+h+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+g+'" height="'+f+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard_TableTools.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+j+'"/><param name="wmode" value="transparent"/></object>')}else{k+='<embed id="'+this.movieId+'" src="'+ZeroClipboard_TableTools.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+g+'" height="'+f+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+j+'" wmode="transparent" />'}return k},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide();this.div.innerHTML="";var d=document.getElementsByTagName("body")[0];try{d.removeChild(this.div)}catch(c){}this.div=this.domElement=null}},reposition:function(d){d&&((this.domElement=ZeroClipboard_TableTools.$(d))||this.hide());if(this.domElement&&this.div){var d=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement),c=this.div.style;c.left=""+d.left+"px";c.top=""+d.top+"px"}},clearText:function(){this.clipText="";this.ready&&this.movie.clearText()},appendText:function(b){this.clipText+=b;this.ready&&this.movie.appendText(b)},setText:function(b){this.clipText=b;this.ready&&this.movie.setText(b)},setCharSet:function(b){this.charSet=b;this.ready&&this.movie.setCharSet(b)},setBomInc:function(b){this.incBom=b;this.ready&&this.movie.setBomInc(b)},setFileName:function(b){this.fileName=b;this.ready&&this.movie.setFileName(b)},setAction:function(b){this.action=b;this.ready&&this.movie.setAction(b)},addEventListener:function(d,c){d=d.toString().toLowerCase().replace(/^on/,"");this.handlers[d]||(this.handlers[d]=[]);this.handlers[d].push(c)},setHandCursor:function(b){this.handCursorEnabled=b;this.ready&&this.movie.setHandCursor(b)},setCSSEffects:function(b){this.cssEffects=!!b},receiveEvent:function(h,g){h=h.toString().toLowerCase().replace(/^on/,"");switch(h){case"load":this.movie=document.getElementById(this.movieId);if(!this.movie){var m=this;setTimeout(function(){m.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){m=this;setTimeout(function(){m.receiveEvent("load",null)},100);this.ready=!0;return}this.ready=!0;this.movie.clearText();this.movie.appendText(this.clipText);this.movie.setFileName(this.fileName);this.movie.setAction(this.action);this.movie.setCharSet(this.charSet);this.movie.setBomInc(this.incBom);this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[h]){for(var l=0,k=this.handlers[h].length;l<k;l++){var j=this.handlers[h][l];if("function"==typeof j){j(this,g)}else{if("object"==typeof j&&2==j.length){j[0][j[1]](this,g)}else{if("string"==typeof j){window[j](this,g)}}}}}}};var TableTools;(function(b,c,a){TableTools=function(e,d){!this instanceof TableTools&&alert("Warning: TableTools must be initialised with the keyword 'new'");this.s={that:this,dt:e.fnSettings(),print:{saveStart:-1,saveLength:-1,saveScroll:-1,funcEnd:function(){}},buttonCounter:0,select:{type:"",selected:[],preRowSelect:null,postSelected:null,postDeselected:null,all:!1,selectedClass:""},custom:{},swfPath:"",buttonSet:[],master:!1,tags:{}};this.dom={container:null,table:null,print:{hidden:[],message:null},collection:{collection:null,background:null}};this.classes=b.extend(!0,{},TableTools.classes);this.s.dt.bJUI&&b.extend(!0,this.classes,TableTools.classes_themeroller);this.fnSettings=function(){return this.s};"undefined"==typeof d&&(d={});this._fnConstruct(d);return this};TableTools.prototype={fnGetSelected:function(g){var f=[],k=this.s.dt.aoData,j=this.s.dt.aiDisplay,h;if(g){g=0;for(h=j.length;g<h;g++){k[j[g]]._DTTT_selected&&f.push(k[j[g]].nTr)}}else{g=0;for(h=k.length;g<h;g++){k[g]._DTTT_selected&&f.push(k[g].nTr)}}return f},fnGetSelectedData:function(){var f=[],e=this.s.dt.aoData,h,g;h=0;for(g=e.length;h<g;h++){e[h]._DTTT_selected&&f.push(this.s.dt.oInstance.fnGetData(h))}return f},fnIsSelected:function(d){d=this.s.dt.oInstance.fnGetPosition(d);return !0===this.s.dt.aoData[d]._DTTT_selected?!0:!1},fnSelectAll:function(e){var d=this._fnGetMasterSettings();this._fnRowSelect(!0===e?d.dt.aiDisplay:d.dt.aoData)},fnSelectNone:function(d){this._fnGetMasterSettings();this._fnRowDeselect(this.fnGetSelected(d))},fnSelect:function(d){"single"==this.s.select.type?(this.fnSelectNone(),this._fnRowSelect(d)):"multi"==this.s.select.type&&this._fnRowSelect(d)},fnDeselect:function(d){this._fnRowDeselect(d)},fnGetTitle:function(e){var d="";"undefined"!=typeof e.sTitle&&""!==e.sTitle?d=e.sTitle:(e=a.getElementsByTagName("title"),0<e.length&&(d=e[0].innerHTML));return 4>"\u00a1".toString().length?d.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""):d.replace(/[^a-zA-Z0-9_\.,\-_ !\(\)]/g,"")},fnCalcColRatios:function(j){var h=this.s.dt.aoColumns,j=this._fnColumnTargets(j.mColumns),o=[],n=0,m=0,l,k;l=0;for(k=j.length;l<k;l++){j[l]&&(n=h[l].nTh.offsetWidth,m+=n,o.push(n))}l=0;for(k=o.length;l<k;l++){o[l]/=m}return o.join("\t")},fnGetTableData:function(d){if(this.s.dt){return this._fnGetDataTablesData(d)}},fnSetText:function(e,d){this._fnFlashSetText(e,d)},fnResizeButtons:function(){for(var e in ZeroClipboard_TableTools.clients){if(e){var d=ZeroClipboard_TableTools.clients[e];"undefined"!=typeof d.domElement&&d.domElement.parentNode&&d.positionElement()}}},fnResizeRequired:function(){for(var e in ZeroClipboard_TableTools.clients){if(e){var d=ZeroClipboard_TableTools.clients[e];if("undefined"!=typeof d.domElement&&d.domElement.parentNode==this.dom.container&&!1===d.sized){return !0}}}return !1},fnPrint:function(e,d){void 0===d&&(d={});void 0===e||e?this._fnPrintStart(d):this._fnPrintEnd()},fnInfo:function(e,d){var f=a.createElement("div");f.className=this.classes.print.info;f.innerHTML=e;a.body.appendChild(f);setTimeout(function(){b(f).fadeOut("normal",function(){a.body.removeChild(f)})},d)},_fnConstruct:function(e){var d=this;this._fnCustomiseSettings(e);this.dom.container=a.createElement(this.s.tags.container);this.dom.container.className=this.classes.container;"none"!=this.s.select.type&&this._fnRowSelectConfig();this._fnButtonDefinations(this.s.buttonSet,this.dom.container);this.s.dt.aoDestroyCallback.push({sName:"TableTools",fn:function(){d.dom.container.innerHTML=""}})},_fnCustomiseSettings:function(d){"undefined"==typeof this.s.dt._TableToolsInit&&(this.s.master=!0,this.s.dt._TableToolsInit=!0);this.dom.table=this.s.dt.nTable;this.s.custom=b.extend({},TableTools.DEFAULTS,d);this.s.swfPath=this.s.custom.sSwfPath;"undefined"!=typeof ZeroClipboard_TableTools&&(ZeroClipboard_TableTools.moviePath=this.s.swfPath);this.s.select.type=this.s.custom.sRowSelect;this.s.select.preRowSelect=this.s.custom.fnPreRowSelect;this.s.select.postSelected=this.s.custom.fnRowSelected;this.s.select.postDeselected=this.s.custom.fnRowDeselected;this.s.custom.sSelectedClass&&(this.classes.select.row=this.s.custom.sSelectedClass);this.s.tags=this.s.custom.oTags;this.s.buttonSet=this.s.custom.aButtons},_fnButtonDefinations:function(g,f){for(var k,j=0,h=g.length;j<h;j++){if("string"==typeof g[j]){if("undefined"==typeof TableTools.BUTTONS[g[j]]){alert("TableTools: Warning - unknown button type: "+g[j]);continue}k=b.extend({},TableTools.BUTTONS[g[j]],!0)}else{if("undefined"==typeof TableTools.BUTTONS[g[j].sExtends]){alert("TableTools: Warning - unknown button type: "+g[j].sExtends);continue}k=b.extend({},TableTools.BUTTONS[g[j].sExtends],!0);k=b.extend(k,g[j],!0)}f.appendChild(this._fnCreateButton(k,b(f).hasClass(this.classes.collection.container)))}},_fnCreateButton:function(e,d){var f=this._fnButtonBase(e,d);e.sAction.match(/flash/)?this._fnFlashConfig(f,e):"text"==e.sAction?this._fnTextConfig(f,e):"div"==e.sAction?this._fnTextConfig(f,e):"collection"==e.sAction&&(this._fnTextConfig(f,e),this._fnCollectionConfig(f,e));return f},_fnButtonBase:function(h,g){var m,l,k;g?(m="default"!==h.sTag?h.sTag:this.s.tags.collection.button,l="default"!==h.sLinerTag?h.sLiner:this.s.tags.collection.liner,k=this.classes.collection.buttons.normal):(m="default"!==h.sTag?h.sTag:this.s.tags.button,l="default"!==h.sLinerTag?h.sLiner:this.s.tags.liner,k=this.classes.buttons.normal);m=a.createElement(m);l=a.createElement(l);var j=this._fnGetMasterSettings();m.className=k+" "+h.sButtonClass;m.setAttribute("id","ToolTables_"+this.s.dt.sInstance+"_"+j.buttonCounter);m.appendChild(l);l.innerHTML=h.sButtonText;j.buttonCounter++;return m},_fnGetMasterSettings:function(){if(this.s.master){return this.s}for(var e=TableTools._aInstances,d=0,f=e.length;d<f;d++){if(this.dom.table==e[d].s.dt.nTable){return e[d].s}}},_fnCollectionConfig:function(e,d){var f=a.createElement(this.s.tags.collection.container);f.style.display="none";f.className=this.classes.collection.container;d._collection=f;a.body.appendChild(f);this._fnButtonDefinations(d.aButtons,f)},_fnCollectionShow:function(w,v){var u=this,t=b(w).offset(),s=v._collection,q=t.left,t=t.top+b(w).outerHeight(),g=b(c).height(),r=b(a).height(),p=b(c).width(),f=b(a).width();s.style.position="absolute";s.style.left=q+"px";s.style.top=t+"px";s.style.display="block";b(s).css("opacity",0);var n=a.createElement("div");n.style.position="absolute";n.style.left="0px";n.style.top="0px";n.style.height=(g>r?g:r)+"px";n.style.width=(p>f?p:f)+"px";n.className=this.classes.collection.background;b(n).css("opacity",0);a.body.appendChild(n);a.body.appendChild(s);g=b(s).outerWidth();p=b(s).outerHeight();q+g>f&&(s.style.left=f-g+"px");t+p>r&&(s.style.top=t-p-b(w).outerHeight()+"px");this.dom.collection.collection=s;this.dom.collection.background=n;setTimeout(function(){b(s).animate({opacity:1},500);b(n).animate({opacity:0.25},500)},10);this.fnResizeButtons();b(n).click(function(){u._fnCollectionHide.call(u,null,null)})},_fnCollectionHide:function(e,d){!(null!==d&&"collection"==d.sExtends)&&null!==this.dom.collection.collection&&(b(this.dom.collection.collection).animate({opacity:0},500,function(){this.style.display="none"}),b(this.dom.collection.background).animate({opacity:0},500,function(){this.parentNode.removeChild(this)}),this.dom.collection.collection=null,this.dom.collection.background=null)},_fnRowSelectConfig:function(){if(this.s.master){var e=this,d=this.s.dt;b(d.nTable).addClass(this.classes.select.table);b("tr",d.nTBody).live("click",function(f){this.parentNode==d.nTBody&&null!==d.oInstance.fnGetData(this)&&(e.fnIsSelected(this)?e._fnRowDeselect(this,f):"single"==e.s.select.type?(e.fnSelectNone(),e._fnRowSelect(this,f)):"multi"==e.s.select.type&&e._fnRowSelect(this,f))});d.oApi._fnCallbackReg(d,"aoRowCreatedCallback",function(h,g,f){d.aoData[f]._DTTT_selected&&b(h).addClass(e.classes.select.row)},"TableTools-SelectAll")}},_fnRowSelect:function(g,f){var m=this._fnSelectData(g),l=[],k,h;k=0;for(h=m.length;k<h;k++){m[k].nTr&&l.push(m[k].nTr)}if(null===this.s.select.preRowSelect||this.s.select.preRowSelect.call(this,f,l,!0)){k=0;for(h=m.length;k<h;k++){m[k]._DTTT_selected=!0,m[k].nTr&&b(m[k].nTr).addClass(this.classes.select.row)}null!==this.s.select.postSelected&&this.s.select.postSelected.call(this,l);TableTools._fnEventDispatch(this,"select",l,!0)}},_fnRowDeselect:function(g,f){var m=this._fnSelectData(g),l=[],k,h;k=0;for(h=m.length;k<h;k++){m[k].nTr&&l.push(m[k].nTr)}if(null===this.s.select.preRowSelect||this.s.select.preRowSelect.call(this,f,l,!1)){k=0;for(h=m.length;k<h;k++){m[k]._DTTT_selected=!1,m[k].nTr&&b(m[k].nTr).removeClass(this.classes.select.row)}null!==this.s.select.postDeselected&&this.s.select.postDeselected.call(this,l);TableTools._fnEventDispatch(this,"select",l,!1)}},_fnSelectData:function(g){var f=[],k,j,h;if(g.nodeName){k=this.s.dt.oInstance.fnGetPosition(g),f.push(this.s.dt.aoData[k])}else{if("undefined"!==typeof g.length){j=0;for(h=g.length;j<h;j++){g[j].nodeName?(k=this.s.dt.oInstance.fnGetPosition(g[j]),f.push(this.s.dt.aoData[k])):"number"===typeof g[j]?f.push(this.s.dt.aoData[g[j]]):f.push(g[j])}}else{f.push(g)}}return f},_fnTextConfig:function(e,d){var f=this;null!==d.fnInit&&d.fnInit.call(this,e,d);""!==d.sToolTip&&(e.title=d.sToolTip);b(e).hover(function(){d.fnMouseover!==null&&d.fnMouseover.call(this,e,d,null)},function(){d.fnMouseout!==null&&d.fnMouseout.call(this,e,d,null)});null!==d.fnSelect&&TableTools._fnEventListen(this,"select",function(g){d.fnSelect.call(f,e,d,g)});b(e).click(function(){d.fnClick!==null&&d.fnClick.call(f,e,d,null);d.fnComplete!==null&&d.fnComplete.call(f,e,d,null,null);f._fnCollectionHide(e,d)})},_fnFlashConfig:function(f,e){var h=this,g=new ZeroClipboard_TableTools.Client;null!==e.fnInit&&e.fnInit.call(this,f,e);g.setHandCursor(!0);"flash_save"==e.sAction?(g.setAction("save"),g.setCharSet("utf16le"==e.sCharSet?"UTF16LE":"UTF8"),g.setBomInc(e.bBomInc),g.setFileName(e.sFileName.replace("*",this.fnGetTitle(e)))):"flash_pdf"==e.sAction?(g.setAction("pdf"),g.setFileName(e.sFileName.replace("*",this.fnGetTitle(e)))):g.setAction("copy");g.addEventListener("mouseOver",function(){e.fnMouseover!==null&&e.fnMouseover.call(h,f,e,g)});g.addEventListener("mouseOut",function(){e.fnMouseout!==null&&e.fnMouseout.call(h,f,e,g)});g.addEventListener("mouseDown",function(){e.fnClick!==null&&e.fnClick.call(h,f,e,g)});g.addEventListener("complete",function(j,d){e.fnComplete!==null&&e.fnComplete.call(h,f,e,g,d);h._fnCollectionHide(f,e)});this._fnFlashGlue(g,f,e.sToolTip)},_fnFlashGlue:function(g,f,k){var j=this,h=f.getAttribute("id");a.getElementById(h)?g.glue(f,k):setTimeout(function(){j._fnFlashGlue(g,f,k)},100)},_fnFlashSetText:function(g,f){var k=this._fnChunkData(f,8192);g.clearText();for(var j=0,h=k.length;j<h;j++){g.appendText(k[j])}},_fnColumnTargets:function(e){var d=[],f=this.s.dt;if("object"==typeof e){i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(!1)}i=0;for(iLen=e.length;i<iLen;i++){d[e[i]]=!0}}else{if("visible"==e){i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(f.aoColumns[i].bVisible?!0:!1)}}else{if("hidden"==e){i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(f.aoColumns[i].bVisible?!1:!0)}}else{if("sortable"==e){i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(f.aoColumns[i].bSortable?!0:!1)}}else{i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(!0)}}}}}return d},_fnNewline:function(d){return"auto"==d.sNewLine?navigator.userAgent.match(/Windows/)?"\r\n":"\n":d.sNewLine},_fnGetDataTablesData:function(A){var z,y,x,w,t,v=[],u="",s=this.s.dt,m,r=RegExp(A.sFieldBoundary,"g"),q=this._fnColumnTargets(A.mColumns);x="undefined"!=typeof A.bSelectedOnly?A.bSelectedOnly:!1;if(A.bHeader){t=[];z=0;for(y=s.aoColumns.length;z<y;z++){q[z]&&(u=s.aoColumns[z].sTitle.replace(/\n/g," ").replace(/<.*?>/g,"").replace(/^\s+|\s+$/g,""),u=this._fnHtmlDecode(u),t.push(this._fnBoundData(u,A.sFieldBoundary,r)))}v.push(t.join(A.sFieldSeperator))}var f=s.aiDisplay;w=this.fnGetSelected();if("none"!==this.s.select.type&&x&&0!==w.length){f=[];z=0;for(y=w.length;z<y;z++){f.push(s.oInstance.fnGetPosition(w[z]))}}x=0;for(w=f.length;x<w;x++){m=s.aoData[f[x]].nTr;t=[];z=0;for(y=s.aoColumns.length;z<y;z++){q[z]&&(u=s.oApi._fnGetCellData(s,f[x],z,"display"),A.fnCellRender?u=A.fnCellRender(u,z,m,f[x])+"":"string"==typeof u?(u=u.replace(/\n/g," "),u=u.replace(/<img.*?\s+alt\s*=\s*(?:"([^"]+)"|'([^']+)'|([^\s>]+)).*?>/gi,"$1$2$3"),u=u.replace(/<.*?>/g,"")):u+="",u=u.replace(/^\s+/,"").replace(/\s+$/,""),u=this._fnHtmlDecode(u),t.push(this._fnBoundData(u,A.sFieldBoundary,r)))}v.push(t.join(A.sFieldSeperator));A.bOpenRows&&(z=b.grep(s.aoOpenRows,function(d){return d.nParent===m}),1===z.length&&(u=this._fnBoundData(b("td",z[0].nTr).html(),A.sFieldBoundary,r),v.push(u)))}if(A.bFooter&&null!==s.nTFoot){t=[];z=0;for(y=s.aoColumns.length;z<y;z++){q[z]&&null!==s.aoColumns[z].nTf&&(u=s.aoColumns[z].nTf.innerHTML.replace(/\n/g," ").replace(/<.*?>/g,""),u=this._fnHtmlDecode(u),t.push(this._fnBoundData(u,A.sFieldBoundary,r)))}v.push(t.join(A.sFieldSeperator))}return _sLastData=v.join(this._fnNewline(A))},_fnBoundData:function(e,d,f){return""===d?e:d+e.replace(f,d+d)+d},_fnChunkData:function(g,f){for(var k=[],j=g.length,h=0;h<j;h+=f){h+f<j?k.push(g.substring(h,h+f)):k.push(g.substring(h,j))}return k},_fnHtmlDecode:function(e){if(-1===e.indexOf("&")){return e}var d=a.createElement("div");return e.replace(/&([^\s]*);/g,function(f,g){if("#"===f.substr(1,1)){return String.fromCharCode(Number(g.substr(1)))}d.innerHTML=f;return d.childNodes[0].nodeValue})},_fnPrintStart:function(h){var g=this,o=this.s.dt;this._fnPrintHideNodes(o.nTable);this.s.print.saveStart=o._iDisplayStart;this.s.print.saveLength=o._iDisplayLength;h.bShowAll&&(o._iDisplayStart=0,o._iDisplayLength=-1,o.oApi._fnCalculateEnd(o),o.oApi._fnDraw(o));if(""!==o.oScroll.sX||""!==o.oScroll.sY){this._fnPrintScrollStart(o),b(this.s.dt.nTable).bind("draw.DTTT_Print",function(){g._fnPrintScrollStart(o)})}var n=o.aanFeatures,l;for(l in n){if("i"!=l&&"t"!=l&&1==l.length){for(var k=0,f=n[l].length;k<f;k++){this.dom.print.hidden.push({node:n[l][k],display:"block"}),n[l][k].style.display="none"}}}b(a.body).addClass(this.classes.print.body);""!==h.sInfo&&this.fnInfo(h.sInfo,3000);h.sMessage&&(this.dom.print.message=a.createElement("div"),this.dom.print.message.className=this.classes.print.message,this.dom.print.message.innerHTML=h.sMessage,a.body.insertBefore(this.dom.print.message,a.body.childNodes[0]));this.s.print.saveScroll=b(c).scrollTop();c.scrollTo(0,0);b(a).bind("keydown.DTTT",function(d){if(d.keyCode==27){d.preventDefault();g._fnPrintEnd.call(g,d)}})},_fnPrintEnd:function(){var e=this.s.dt,d=this.s.print,f=this.dom.print;this._fnPrintShowNodes();if(""!==e.oScroll.sX||""!==e.oScroll.sY){b(this.s.dt.nTable).unbind("draw.DTTT_Print"),this._fnPrintScrollEnd()}c.scrollTo(0,d.saveScroll);null!==f.message&&(a.body.removeChild(f.message),f.message=null);b(a.body).removeClass("DTTT_Print");e._iDisplayStart=d.saveStart;e._iDisplayLength=d.saveLength;e.oApi._fnCalculateEnd(e);e.oApi._fnDraw(e);b(a).unbind("keydown.DTTT")},_fnPrintScrollStart:function(){var e=this.s.dt;e.nScrollHead.getElementsByTagName("div")[0].getElementsByTagName("table");var d=e.nTable.parentNode,f=e.nTable.getElementsByTagName("thead");0<f.length&&e.nTable.removeChild(f[0]);null!==e.nTFoot&&(f=e.nTable.getElementsByTagName("tfoot"),0<f.length&&e.nTable.removeChild(f[0]));f=e.nTHead.cloneNode(!0);e.nTable.insertBefore(f,e.nTable.childNodes[0]);null!==e.nTFoot&&(f=e.nTFoot.cloneNode(!0),e.nTable.insertBefore(f,e.nTable.childNodes[1]));""!==e.oScroll.sX&&(e.nTable.style.width=b(e.nTable).outerWidth()+"px",d.style.width=b(e.nTable).outerWidth()+"px",d.style.overflow="visible");""!==e.oScroll.sY&&(d.style.height=b(e.nTable).outerHeight()+"px",d.style.overflow="visible")},_fnPrintScrollEnd:function(){var e=this.s.dt,d=e.nTable.parentNode;""!==e.oScroll.sX&&(d.style.width=e.oApi._fnStringToCss(e.oScroll.sX),d.style.overflow="auto");""!==e.oScroll.sY&&(d.style.height=e.oApi._fnStringToCss(e.oScroll.sY),d.style.overflow="auto")},_fnPrintShowNodes:function(){for(var e=this.dom.print.hidden,d=0,f=e.length;d<f;d++){e[d].node.style.display=e[d].display}e.splice(0,e.length)},_fnPrintHideNodes:function(j){for(var h=this.dom.print.hidden,o=j.parentNode,n=o.childNodes,l=0,k=n.length;l<k;l++){if(n[l]!=j&&1==n[l].nodeType){var f=b(n[l]).css("display");"none"!=f&&(h.push({node:n[l],display:f}),n[l].style.display="none")}}"BODY"!=o.nodeName&&this._fnPrintHideNodes(o)}};TableTools._aInstances=[];TableTools._aListeners=[];TableTools.fnGetMasters=function(){for(var e=[],d=0,f=TableTools._aInstances.length;d<f;d++){TableTools._aInstances[d].s.master&&e.push(TableTools._aInstances[d])}return e};TableTools.fnGetInstance=function(e){"object"!=typeof e&&(e=a.getElementById(e));for(var d=0,f=TableTools._aInstances.length;d<f;d++){if(TableTools._aInstances[d].s.master&&TableTools._aInstances[d].dom.table==e){return TableTools._aInstances[d]}}return null};TableTools._fnEventListen=function(e,d,f){TableTools._aListeners.push({that:e,type:d,fn:f})};TableTools._fnEventDispatch=function(j,h,o,n){for(var m=TableTools._aListeners,l=0,k=m.length;l<k;l++){j.dom.table==m[l].that.dom.table&&m[l].type==h&&m[l].fn(o,n)}};TableTools.buttonBase={sAction:"text",sTag:"default",sLinerTag:"default",sButtonClass:"DTTT_button_text",sButtonText:"Button text",sTitle:"",sToolTip:"",sCharSet:"utf8",bBomInc:!1,sFileName:"*.csv",sFieldBoundary:"",sFieldSeperator:"\t",sNewLine:"auto",mColumns:"all",bHeader:!0,bFooter:!0,bOpenRows:!1,bSelectedOnly:!1,fnMouseover:null,fnMouseout:null,fnClick:null,fnSelect:null,fnComplete:null,fnInit:null,fnCellRender:null};TableTools.BUTTONS={csv:b.extend({},TableTools.buttonBase,{sAction:"flash_save",sButtonClass:"DTTT_button_csv",sButtonText:"CSV",sFieldBoundary:'"',sFieldSeperator:",",fnClick:function(e,d,f){this.fnSetText(f,this.fnGetTableData(d))}}),xls:b.extend({},TableTools.buttonBase,{sAction:"flash_save",sCharSet:"utf16le",bBomInc:!0,sButtonClass:"DTTT_button_xls",sButtonText:"Excel",fnClick:function(e,d,f){this.fnSetText(f,this.fnGetTableData(d))}}),copy:b.extend({},TableTools.buttonBase,{sAction:"flash_copy",sButtonClass:"DTTT_button_copy",sButtonText:"Copy",fnClick:function(e,d,f){this.fnSetText(f,this.fnGetTableData(d))},fnComplete:function(f,e,h,g){f=g.split("\n").length;f=null===this.s.dt.nTFoot?f-1:f-2;this.fnInfo("<h6>Table copied</h6><p>Copied "+f+" row"+(1==f?"":"s")+" to the clipboard.</p>",1500)}}),pdf:b.extend({},TableTools.buttonBase,{sAction:"flash_pdf",sNewLine:"\n",sFileName:"*.pdf",sButtonClass:"DTTT_button_pdf",sButtonText:"PDF",sPdfOrientation:"portrait",sPdfSize:"A4",sPdfMessage:"",fnClick:function(e,d,f){this.fnSetText(f,"title:"+this.fnGetTitle(d)+"\nmessage:"+d.sPdfMessage+"\ncolWidth:"+this.fnCalcColRatios(d)+"\norientation:"+d.sPdfOrientation+"\nsize:"+d.sPdfSize+"\n--/TableToolsOpts--\n"+this.fnGetTableData(d))}}),print:b.extend({},TableTools.buttonBase,{sInfo:"<h6>Print view</h6><p>Please use your browser's print function to print this table. Press escape when finished.",sMessage:null,bShowAll:!0,sToolTip:"View print view",sButtonClass:"DTTT_button_print",sButtonText:"Print",fnClick:function(e,d){this.fnPrint(!0,d)}}),text:b.extend({},TableTools.buttonBase),select:b.extend({},TableTools.buttonBase,{sButtonText:"Select button",fnSelect:function(d){0!==this.fnGetSelected().length?b(d).removeClass(this.classes.buttons.disabled):b(d).addClass(this.classes.buttons.disabled)},fnInit:function(d){b(d).addClass(this.classes.buttons.disabled)}}),select_single:b.extend({},TableTools.buttonBase,{sButtonText:"Select button",fnSelect:function(d){1==this.fnGetSelected().length?b(d).removeClass(this.classes.buttons.disabled):b(d).addClass(this.classes.buttons.disabled)},fnInit:function(d){b(d).addClass(this.classes.buttons.disabled)}}),select_all:b.extend({},TableTools.buttonBase,{sButtonText:"Select all",fnClick:function(){this.fnSelectAll()},fnSelect:function(d){this.fnGetSelected().length==this.s.dt.fnRecordsDisplay()?b(d).addClass(this.classes.buttons.disabled):b(d).removeClass(this.classes.buttons.disabled)}}),select_none:b.extend({},TableTools.buttonBase,{sButtonText:"Deselect all",fnClick:function(){this.fnSelectNone()},fnSelect:function(d){0!==this.fnGetSelected().length?b(d).removeClass(this.classes.buttons.disabled):b(d).addClass(this.classes.buttons.disabled)},fnInit:function(d){b(d).addClass(this.classes.buttons.disabled)}}),ajax:b.extend({},TableTools.buttonBase,{sAjaxUrl:"/xhr.php",sButtonText:"Ajax button",fnClick:function(e,d){var f=this.fnGetTableData(d);b.ajax({url:d.sAjaxUrl,data:[{name:"tableData",value:f}],success:d.fnAjaxComplete,dataType:"json",type:"POST",cache:!1,error:function(){alert("Error detected when sending table data to server")}})},fnAjaxComplete:function(){alert("Ajax complete")}}),div:b.extend({},TableTools.buttonBase,{sAction:"div",sTag:"div",sButtonClass:"DTTT_nonbutton",sButtonText:"Text button"}),collection:b.extend({},TableTools.buttonBase,{sAction:"collection",sButtonClass:"DTTT_button_collection",sButtonText:"Collection",fnClick:function(e,d){this._fnCollectionShow(e,d)}})};TableTools.classes={container:"DTTT_container",buttons:{normal:"DTTT_button",disabled:"DTTT_disabled"},collection:{container:"DTTT_collection",background:"DTTT_collection_background",buttons:{normal:"DTTT_button",disabled:"DTTT_disabled"}},select:{table:"DTTT_selectable",row:"DTTT_selected"},print:{body:"DTTT_Print",info:"DTTT_print_info",message:"DTTT_PrintMessage"}};TableTools.classes_themeroller={container:"DTTT_container ui-buttonset ui-buttonset-multi",buttons:{normal:"DTTT_button ui-button ui-state-default"},collection:{container:"DTTT_collection ui-buttonset ui-buttonset-multi"}};TableTools.DEFAULTS={sSwfPath:"media/swf/copy_csv_xls_pdf.swf",sRowSelect:"none",sSelectedClass:null,fnPreRowSelect:null,fnRowSelected:null,fnRowDeselected:null,aButtons:["copy","csv","xls","pdf","print"],oTags:{container:"div",button:"a",liner:"span",collection:{container:"div",button:"a",liner:"span"}}};TableTools.prototype.CLASS="TableTools";TableTools.VERSION="2.1.4";TableTools.prototype.VERSION=TableTools.VERSION;"function"==typeof b.fn.dataTable&&"function"==typeof b.fn.dataTableExt.fnVersionCheck&&b.fn.dataTableExt.fnVersionCheck("1.9.0")?b.fn.dataTableExt.aoFeatures.push({fnInit:function(d){d=new TableTools(d.oInstance,"undefined"!=typeof d.oInit.oTableTools?d.oInit.oTableTools:{});TableTools._aInstances.push(d);return d.dom.container},cFeature:"T",sFeature:"TableTools"}):alert("Warning: TableTools 2 requires DataTables 1.9.0 or newer - www.datatables.net/download");b.fn.DataTable.TableTools=TableTools})(jQuery,window,document);(function($){$.fn.qTip=function(pageName){$("div.documentation a").each(function(){var key=$(this).attr("class");$(this).attr("href",MDOC[pageName][key+"DocUrl"]);$(this).qtip({content:MDOC[pageName][key],style:{delay:1,width:200,padding:5,background:"#CCCCCC",color:"black",textAlign:"center",border:{width:1,radius:5,color:"#CCCCCC"},tip:"bottomMiddle",name:"dark"},show:{event:"mouseover",delay:0},hide:{event:"mouseout"},position:{corner:{target:"topLeft",tooltip:"middleRight"},adjust:{x:105,y:-55}}})})};$.fn.setHashUrl=function(q,core){var hashParams={};hashParams.q=q;hashParams.core=core;hashParams.fq=MPI2.searchAndFacetConfig.facetParams[core+"Facet"].fq;window.location.hash=$.fn.stringifyJsonAsUrlParams(hashParams)};$.fn.updateBreadCrumb=function(coreName){var hashParams=$.fn.parseHashString(window.location.hash.substring(1));var breadcrumbBox=$("p.ikmcbreadcrumb");var baseLinks="<a href="+drupalBaseUrl+">Home</a> &raquo; <a href="+baseUrl+"/search>Search</a> &raquo; ";if(coreName&&!hashParams.coreName){hashParams.coreName=coreName;hashParams.fq="undefined"}else{if(!coreName&&!hashParams.q){hashParams.q="*:*";hashParams.coreName="gene";hashParams.fq="undefined"}}baseLinks+=fetchFacetLink(hashParams);breadcrumbBox.html(baseLinks)};function fetchFacetLink(hashParams){var coreName=hashParams.coreName;var fq=MPI2.searchAndFacetConfig.facetParams[coreName+"Facet"].fq;var breadCrumbLabel=MPI2.searchAndFacetConfig.facetParams[coreName+"Facet"].breadCrumbLabel;var url=encodeURI(baseUrl+"/search#q=*:*&core="+hashParams.coreName+"&fq="+fq);return"<a href="+url+">"+breadCrumbLabel+"</a>"}$.fn.openFacet=function(core){$("div.facetCatList").hide();$("div.facetCat").removeClass("facetCatUp");if(core=="gene"){$("div#geneFacet div.facetCatList").show();$("div#geneFacet div.facetCat").addClass("facetCatUp")}else{if(core=="mp"){$("div#mpFacet div.facetCatList").show();$("div#mpFacet div.facetCat").addClass("facetCatUp")}else{if(core=="ma"){$("div#maFacet div.facetCatList").show();$("div#maFacet div.facetCat").addClass("facetCatUp")}else{if(core=="pipeline"){$("div#pipelineFacet div.facetCatList").show();$("div#pipelineFacet div.facetCat").addClass("facetCatUp")}else{if(core=="images"){$("div#imagesFacet div.facetCatList").show();$("div#imagesFacet div.facetCat").addClass("facetCatUp")}}}}}};$.fn.invokeFacetDataTable=function(oSolrSrchParams,facetDivId,gridName,hashState){var self=this;var oVal=MPI2.searchAndFacetConfig.facetParams[facetDivId];if(hashState&&facetDivId=="imagesFacet"){oVal.forceReloadImageDataTable=true}var sTopLevelTerm=oVal.topLevelName;if($("table#"+gridName).size()==1&&$("div#"+facetDivId+" .facetTable td.highlight").size()==0&&sTopLevelTerm==undefined&&!oVal.forceReloadImageDataTable){return}else{oVal.topLevelName="";var oInfos={};oInfos.params=$.fn.stringifyJsonAsUrlParams(oSolrSrchParams);oInfos.solrCoreName=oVal.solrCoreName;oInfos.mode=oVal.gridName;oInfos.dataTablePath=MPI2.searchAndFacetConfig.dataTablePath;var facetLabel=MPI2.searchAndFacetConfig.facetParams[oVal.solrCoreName+"Facet"].breadCrumbLabel.toLowerCase();var dTable=$("<table></table>").attr({id:oInfos.mode});var thead=oVal.tableHeader;var tds="";for(var i=0;i<oVal.tableCols;i++){tds+="<td></td>"}var tbody=$("<tbody><tr>"+tds+"</tr></tbody>");dTable.append(thead,tbody);var facetCount=oSolrSrchParams.facetCount;var gridTitle=$("<div></div>").attr({"class":"gridTitle"});var searchKW=" search keyword: "+(oSolrSrchParams.q=="*:*"&&facetDivId=="maFacet"?"IMPC MA slim terms":oSolrSrchParams.q);$("div#mpi2-search").html("");$.fn.updateBreadCrumb(oSolrSrchParams.coreName);if(facetDivId=="imagesFacet"){var viewLabel,viewMode;if(oVal.imgViewSwitcherDisplay=="Annotation View"){viewLabel="Image View: lists annotations to an image";viewMode="imageView"}else{viewLabel="Annotation View: groups images by annotation";viewMode="annotView"}if(oVal.showImgView){dTable.find("th:nth-child(2)").text("Image")}gridTitle.append($("<div></div>").attr({id:"imgView",rel:viewMode}).html("<span id='imgViewSubTitle'>"+viewLabel+"</span><span id='imgViewSwitcher'>Show "+oVal.imgViewSwitcherDisplay+"</span>")).append($("<div></div>").attr({"class":"gridSubTitle"}).html(""));if(facetDivId!=="imagesFacet"&&!hashState){$.fn.invokeDataTable(oInfos)}var unit=facetCount>1?"images":"image";var imgParams="/images?q=*:*&q.option=AND&qf=auto_suggest&defType=edismax&wt=json";var imgUrl=encodeURI(baseUrl+imgParams);var imgUrlLink="<a href="+imgUrl+">"+facetCount+" "+unit+"</a>";gridTitle.append(imgUrlLink+" for "+searchKW);$("div#mpi2-search").append(gridTitle,dTable);oInfos.showImgView=oVal.showImgView;$.fn.invokeDataTable(oInfos);$("span#imgViewSwitcher").click(function(){if(oVal.imgViewSwitcherDisplay=="Annotation View"){oVal.imgViewSwitcherDisplay="Image View";oVal.showImgView=false}else{oVal.imgViewSwitcherDisplay="Annotation View";oVal.showImgView=true}oVal.forceReloadImageDataTable=true;if(!oVal.showImgView){delete (oSolrSrchParams.fq)}$.fn.invokeFacetDataTable(oSolrSrchParams,facetDivId,gridName)})}else{var unit=facetCount>1?facetLabel:facetLabel.replace(/s$/,"");if(facetDivId=="maFacet"){if(oSolrSrchParams.topLevelName!=undefined){unit+=" terms for Top level term: "+oSolrSrchParams.topLevelName}else{unit+=" terms"}}gridTitle.html(facetCount+" "+unit+" for "+searchKW);$("div#mpi2-search").append(gridTitle,dTable);$.fn.invokeDataTable(oInfos)}}};$.fn.fetchFilteredDataTable=function(obj,facetDivId,q,facetFilter){var facetCount;var topLevelName;var oSolrSrchParams={};var displayedTopLevelName;var type=MPI2.searchAndFacetConfig.facetParams[facetDivId].type;var imgParamStr,imgFacetParams;var oVal=MPI2.searchAndFacetConfig.facetParams[facetDivId];var dTable=$.fn.fetchEmptyTable(oVal.tableHeader,oVal.tableCols,oVal.gridName);var title=$.fn.upperCaseFirstLetter(oVal.type);var gridTitle=$("<div></div>").attr({"class":"gridTitle"}).html("");var searchKw=" AND search keyword: ";if(facetDivId=="maFacet"&&q=="*:*"){searchKw+="IMPC MA slim terms"}else{searchKw+=q}var resultMsg=$("<div></div>").attr("id","resultMsg");var ontology=oVal.ontology;if(ontology){topLevelName=obj.attr("rel");$("div#"+facetDivId+" table td."+ontology+"TopLevel").removeClass("highlight");obj.parent().siblings("td."+ontology+"TopLevel").addClass("highlight");facetCount=obj.parent().siblings("td."+ontology+"TopLevel").attr("rel");if(ontology=="mp"){oSolrSrchParams=$.extend({},oVal.filterParams,MPI2.searchAndFacetConfig.commonSolrParams);oSolrSrchParams.fq='ontology_subset:* AND top_level_mp_term:"'+topLevelName+'"';displayedTopLevelName=$("<div></div>").attr({"class":"gridSubTitle"}).html("Top level term: "+topLevelName.replace(" phenotype",""))}else{if(ontology=="ma"){oSolrSrchParams=$.extend({},oVal.filterParams,MPI2.searchAndFacetConfig.commonSolrParams);oSolrSrchParams.fq='ontology_subset:IMPC_Terms AND selected_top_level_ma_term:"'+topLevelName+'"';displayedTopLevelName=$("<div></div>").attr({"class":"gridSubTitle"}).html("Top level term: "+topLevelName)}}}else{if(facetDivId=="geneFacet"){topLevelName=obj.attr("rel");var topLevelNameOri=topLevelName;$("table#gFacet td").removeClass("highlight");obj.parent().siblings("td.geneSubfacet").addClass("highlight");facetCount=obj.parent().siblings("td.geneSubfacet").attr("rel");var subFacetName=obj.attr("class");if(topLevelName=="1"&&subFacetName.indexOf("phenotype_started")!=-1){topLevelName="Started"}else{if(topLevelName=="1"&&subFacetName.indexOf("phenotype_complete")!=-1){topLevelName="Complete"}}var subFacetFilter=subFacetName+':"'+topLevelNameOri+'"';MPI2.searchAndFacetConfig.facetParams[facetDivId].subFacet_filter_params=subFacetFilter;oSolrSrchParams=$.extend({},MPI2.searchAndFacetConfig.commonSolrParams,MPI2.searchAndFacetConfig.facetParams[facetDivId].filterParams);oSolrSrchParams.fq=subFacetFilter;var label=$.fn.upperCaseFirstLetter(subFacetName).replace(/_/g," ");if(label.indexOf("Imits phenotype")!=-1){label="Phenotyping status";topLevelName=topLevelName.replace("Phenotype ","")}else{if(label=="Status"){label="Mouse production status"}}displayedTopLevelName=$("<div></div>").attr({"class":"gridSubTitle"}).html(label+": "+topLevelName)}else{if(facetDivId=="pipelineFacet"){topLevelName=obj.parent().siblings("td[class^=procedure]").text();$("table#pipeline td[class^=procedure]").removeClass("highlight");obj.parent().siblings("td[class^=procedure]").addClass("highlight");facetCount=obj.parent().siblings("td[class^=procedure]").attr("rel");var proc_stable_id=obj.attr("rel");var hiddenSid="<span class='hiddenId'>"+proc_stable_id+"</span>";oSolrSrchParams=$.extend({},oVal,MPI2.searchAndFacetConfig.commonSolrParams);oSolrSrchParams.fq="procedure_stable_id:"+proc_stable_id;displayedTopLevelName=$("<div></div>").attr({"class":"gridSubTitle"}).html("Procedure: "+topLevelName+hiddenSid)}else{if(facetDivId=="imagesFacet"){var oInfos=eval("("+obj.attr("rel")+")");oSolrSrchParams.fq=obj.attr("class");topLevelName=oInfos.imgSubName;$("table#imgFacet td.imgSubfacet").removeClass("highlight");obj.parent().siblings("td.imgSubfacet").addClass("highlight");facetCount=obj.parent().siblings("td.imgSubfacet").attr("rel");imgParamStr=oInfos.params+"&facetCount="+facetCount;var unit=facetCount>1?"images":"image";var imgCountInfo="<a href='"+oInfos.fullLink+"'>"+oInfos.imgCount+" "+unit+"</a>";var title="<span class='imgTitle'>"+oInfos.imgType+": "+topLevelName+"</span>";displayedTopLevelName=$("<div></div>").attr({"class":"gridSubTitle"}).html(imgCountInfo+" for "+title+searchKw);resultMsg.append(displayedTopLevelName);var viewLabel,imgViewSwitcherDisplay,viewMode;if(oVal.showImgView){dTable.find("th:nth-child(2)").text("Image");viewLabel="Image View: lists annotations to an image";imgViewSwitcherDisplay="Show Annotation View";viewMode="imageView"}else{viewLabel="Annotation View: groups images by annotation";imgViewSwitcherDisplay="Show Image View";viewMode="annotView"}gridTitle.append($("<div></div>").attr({id:"imgView",rel:viewMode}).html("<span id='imgViewSubTitle'>"+viewLabel+"</span><span id='imgViewSwitcher'>"+imgViewSwitcherDisplay+"</span>"));$("span#imgViewSwitcher").click(function(){console.log("switcher click");oVal.showImgView=oVal.showImgView?false:true;$.fn.fetchFilteredDataTable(obj,facetDivId,q,"imgSwitcher")})}}}}oVal.topLevelName=topLevelName;oSolrSrchParams.q=q;oSolrSrchParams.facetCount=facetCount;var oInfos={};oInfos.solrCoreName=oVal.solrCoreName;oInfos.mode=oVal.gridName;oInfos.dataTablePath=MPI2.searchAndFacetConfig.dataTablePath;var facetLabel=MPI2.searchAndFacetConfig.facetParams[facetDivId].breadCrumbLabel.toLowerCase();if(facetDivId=="imagesFacet"){oInfos.params=imgParamStr;oInfos.showImgView=oVal.showImgView}else{oInfos.params=$.fn.stringifyJsonAsUrlParams(oSolrSrchParams);if(facetDivId=="geneFacet"){oInfos.params+="&fq="+MPI2.searchAndFacetConfig.facetParams[facetDivId].filterParams.fq}var unit=facetCount>1?facetLabel:facetLabel.replace(/s$/,"");if(facetDivId=="maFacet"){unit+=" terms"}var resultCount="<span>"+facetCount+" "+unit+" for </span>";resultMsg.append(resultCount,displayedTopLevelName,searchKw)}var hashParams={};hashParams.q=oSolrSrchParams.q;hashParams.core=oVal.solrCoreName;hashParams.fq=oSolrSrchParams.fq;var hashParamStr=$.fn.stringifyJsonAsUrlParams(hashParams);if((hashParamStr==MPI2.searchAndFacetConfig.lastParams&&facetFilter=="imgSwitcher")||(hashParamStr!=MPI2.searchAndFacetConfig.lastParams)){$("div#mpi2-search").html("");if(facetDivId!="imagesFacet"){$("div#mpi2-search").append(resultMsg,dTable)}else{$("div#mpi2-search").append(gridTitle,resultMsg,dTable);$("span#imgViewSwitcher").click(function(){oVal.showImgView=oVal.showImgView?false:true;$.fn.fetchFilteredDataTable(obj,facetDivId,q,"imgSwitcher")})}window.location.hash=hashParamStr;MPI2.searchAndFacetConfig.lastParams=hashParamStr;$.fn.updateBreadCrumb();$.fn.invokeDataTable(oInfos)}};$.fn.ieCheck=function(){if($.browser.msie&&$.browser.version<8){var msg="<div id='noSupport'>Dear user:<p><p>It appears that you are using Internet Explorer 7 or earlier version.<p>To ensure that IMPC is supporting the best browsing features, functionalities and experiences, and considering the security issues of older IEs, we decided not to support IE7 and earlier versions.<p>We are sorry if this has caused your inconvenience.<p>Here is a list of supported browsers: <a href='http://www.mozilla.org'>Firefox</a>, <a href='http://www.google.com/chrome'>Google chrome</a>, <a href='http://support.apple.com/downloads/#internet'>Apple safari</a>.<p>IMPC team.</div>";$("div.navbar").siblings("div.container").html(msg);return false}};$.fn.inverseSimpleJSON=function(json){var newJson={};for(var i in json){newJson[json[i]]=i}return newJson};$.fn.endsWith=function(str,suffix){return str.indexOf(suffix,str.length-suffix.length)!==-1};$.fn.composeSelectUI=function(aFormats,selName){var oSelect=$("<select></select>").attr({name:selName});for(var i=0;i<aFormats.length;i++){oSelect.append("<option>"+aFormats[i])}return oSelect};$.fn.loadFileExporterUI=function(conf){var oFormatSelector=conf.formatSelector;var label=conf.label;var iconDiv=$("<div></div>").attr({"class":"fileIcons"}).html(label);for(var f in oFormatSelector){var btn=$("<button></button>").attr({"class":oFormatSelector[f]+" "+conf["class"]}).html(f);$(iconDiv).append(btn)}return iconDiv};$.fn.stringifyJsonAsUrlParams=function(json){var aStr=[];for(var i in json){aStr.push(i+"="+json[i])}return aStr.join("&")};$.fn.parseUrlString=function(sUrl){var params={};var parts=decodeURI(sUrl).replace(/[?|#&]+([^=&]+)=([^&]*)/gi,function(m,key,value){params[key]=value});return params};$.fn.updateFacetAndDataTableDisplay=function(hashParams){var core=hashParams.coreName;var facetDivId=core+"Facet";var caller=$("div#"+facetDivId);MPI2.searchAndFacetConfig.backButton=1;if(typeof core==="undefined"){if(hashParams.q!="*"&&hashParams.q!="*:*"&&hashParams.q!=""){document.location.reload()}else{$("div#geneFacet").find("span.facetCount").click()}}else{if(core=="gene"){if(typeof hashParams.fq==="undefined"){MPI2.setHashChange=1;caller.find("span.facetCount").click()}else{var aKV=hashParams.fq.split(":");var sClass=aKV[0];var sRel=aKV[1].replace(/"/g,"");$.fn.fetchFilteredDataTable($('a[rel="'+sRel+'"]'),"geneFacet",hashParams.q)}}else{if(core=="mp"){if(hashParams.fq=="ontology_subset:*"){MPI2.setHashChange=1;caller.find("span.facetCount").click()}else{var fqText=hashParams.fq.replace("ontology_subset:* AND top_level_mp_term:","").replace(/"/g,"");$.fn.fetchFilteredDataTable($('a[rel="'+fqText+'"]'),"mpFacet",hashParams.q)}}else{if(core=="ma"){if(hashParams.fq=="ontology_subset:IMPC_Terms AND selected_top_level_ma_term:*"){MPI2.setHashChange=1;caller.find("span.facetCount").click()}else{var fqText=hashParams.fq.replace("ontology_subset:IMPC_Terms AND selected_top_level_ma_term:","").replace(/"/g,"");$.fn.fetchFilteredDataTable($('a[rel="'+fqText+'"]'),"maFacet",hashParams.q)}}else{if(core=="pipeline"){if(hashParams.fq=="pipeline_stable_id:IMPC_001"){MPI2.setHashChange=1;caller.find("span.facetCount").click()}else{var fqText=hashParams.fq.replace("procedure_stable_id:","");$.fn.fetchFilteredDataTable($('a[rel="'+fqText+'"]'),"pipelineFacet",hashParams.q)}}else{if(core=="images"){if(hashParams.fq==MPI2.searchAndFacetConfig.facetParams[facetDivId].fq){MPI2.setHashChange=1;caller.find("span.facetCount").click()}else{var fqText=hashParams.fq;$.fn.fetchFilteredDataTable($('a[class="'+fqText+'"]'),"imagesFacet",hashParams.q)}}}}}}}if(!caller.find(".facetCatList").is(":visible")){caller.find("div.facetCat").click()}};$.fn.parseHashString=function(sHash){var hashParams={};var aKV=decodeURI(sHash).split("&");var m;for(var i=0;i<aKV.length;i++){if(aKV[i].indexOf("core=")==0){m=aKV[i].match(/core=(.+)/);hashParams.coreName=m[1]}else{if(aKV[i].indexOf("gridSubTitle=")==0){m=aKV[i].match(/gridSubTitle=(.+)/);hashParams.gridSubTitle=m[1]}else{if(aKV[i].indexOf("q=")==0){m=aKV[i].match(/q=(.+)/);if(m===null){m=[];m[1]="*"}hashParams.q=m[1]}else{if(aKV[i].indexOf("fq=")==0){if(aKV[i]=="fq="+MPI2.searchAndFacetConfig.facetParams.imagesFacet.fq||aKV[i]=="fq=annotationTermId:M* OR expName:* OR symbol:*"||aKV[i].match(/fq=expName.+|fq=higherLevel.+|fq=subtype.+/)||aKV[i].match(/fq=ontology_subset:\* AND top_level_mp_term.+/)||aKV[i].match(/fq=ontology_subset:IMPC_Terms AND selected_top_level_ma_term.+/)||aKV[i].match(/fq=ontology_subset:.+/)||aKV[i].match(/imits_phenotype.+/)||aKV[i].match(/marker_type.+/)||aKV[i].match(/status.+/)||aKV[i].match(/pipeline_stable_id.+/)||aKV[i].match(/procedure_stable_id.+/)){hashParams.fq=aKV[i].replace("fq=","")}}}}}}return hashParams};$.fn.fetchEmptyTable=function(theadStr,colNum,id){var table=$("<table></table>").attr({id:id});var thead=theadStr;var tds="";for(var i=0;i<colNum;i++){tds+="<td></td>"}var tbody=$("<tbody><tr>"+tds+"</tr></tbody>");table.append(thead,tbody);return table},$.fn.invokeDataTable=function(oInfos){var oDtable=$("table#"+oInfos.mode).dataTable({bSort:false,bProcessing:true,bServerSide:true,sDom:"<'row-fluid'<'#exportSpinner'><'#tableTool'>r>t<'row-fluid'<'span6'i><'span6'p>>",sPaginationType:"bootstrap",fnDrawCallback:function(oSettings){if($("table#geneGrid").size()==1){$("table#geneGrid th:nth-child(1)").width("45%")}$("a.interest").click(function(){var mgiId=$(this).attr("id");var label=$(this).text();var regBtn=$(this);$.ajax({url:"/toggleflagfromjs/"+mgiId,success:function(response){function endsWith(str,suffix){return str.indexOf(suffix,str.length-suffix.length)!==-1}if(response==="null"){window.alert("Null error trying to register interest")}else{if(label=="Register interest"){regBtn.text("Unregister interest")}else{regBtn.text("Register interest")}}},error:function(){window.alert("AJAX error trying to register interest")}});return false});initDataTableDumpControl(oInfos)},sAjaxSource:oInfos.dataTablePath,fnServerParams:function(aoData){aoData.push({name:"solrParams",value:JSON.stringify(oInfos,null,2)})}})};function initDataTableDumpControl(oInfos){$("div#saveTable").remove();$("div#toolBox").remove();var saveTool=$("<div id='saveTable'></div>").html("Export table <img src='"+baseUrl+"/img/floppy.png' />").corner("4px");var toolBox=fetchSaveTableGui();$("div.dataTables_processing").siblings("div#tableTool").append(saveTool,toolBox);$("div#saveTable").click(function(){if($("div#toolBox").is(":visible")){$("div#toolBox").hide()}else{$("div#toolBox").show();if($.browser.msie&&parseInt($.browser.version,10)===8){$("div#toolBox").css({top:"-30px",left:"65px"})}var solrCoreName=oInfos.solrCoreName;var iActivePage=$("div.dataTables_paginate li.active a").text();var iRowStart=iActivePage==1?0:iActivePage*10-10;var showImgView=$("div.gridTitle div#imgView").attr("rel")=="imageView"?true:false;$("button.gridDump").unbind("click");$("button.gridDump").click(function(){initGridExporter($(this),{externalDbId:5,rowStart:iRowStart,solrCoreName:solrCoreName,params:oInfos.params,showImgView:showImgView,gridFields:MPI2.searchAndFacetConfig.facetParams[solrCoreName+"Facet"].gridFields,fileName:solrCoreName+"_table_dump"})}).corner("6px")}})}function initGridExporter(thisButt,conf){var classString=thisButt.attr("class");var fileType=thisButt.text();var dumpMode=thisButt.attr("class").indexOf("all")!=-1?"all":"page";var url=baseUrl+"/export";var sInputs="";var aParams=[];for(var k in conf){aParams.push(k+"="+conf[k]);sInputs+="<input type='text' name='"+k+"' value='"+conf[k]+"'>"}sInputs+="<input type='text' name='fileType' value='"+fileType.toLowerCase()+"'>";sInputs+="<input type='text' name='dumpMode' value='"+dumpMode+"'>";var form="<form action='"+url+"' method=get>"+sInputs+"</form>";if(dumpMode=="all"){if($("div.gridSubTitle").html()==""||$("div.gridSubTitle").size()==0){console.log("full");console.log(sInputs)}else{}var paramStr=conf.params+"&start="+conf.rowStart+"&rows=0";var url1;url1=MPI2.searchAndFacetConfig.solrBaseURL_ebi+conf.solrCoreName+"/select?";paramStr+="&wt=json";$.ajax({url:url1,data:paramStr,dataType:"jsonp",jsonp:"json.wrf",timeout:5000,success:function(json){if(json.response.numFound>3000){if(confirm("Download big dataset would take a while, would you like to proceed?")){_doDataExport(url,form)}}else{_doDataExport(url,form)}},error:function(jqXHR,textStatus,errorThrown){$("div#facetBrowser").html("Error fetching data ...")}})}else{_doDataExport(url,form)}$("div#toolBox").hide()}function _doDataExport(url,form){$.ajax({type:"GET",url:url,cache:false,data:$(form).serialize(),beforeSend:function(){$("div#exportSpinner").html(MPI2.searchAndFacetConfig.spinnerExport)},success:function(data){$(form).appendTo("body").submit().remove();$("div#exportSpinner").html("")},error:function(){}})}function fetchSaveTableGui(){var div=$("<div id='toolBox'></div>").corner("4px");div.append($("<div class='dataName'></div>").html("Current paginated entries in table"));div.append($.fn.loadFileExporterUI({label:"Export as:",formatSelector:{TSV:"tsv_grid",XLS:"xls_grid"},"class":"gridDump"}));div.append($("<div class='dataName'></div>").html("All entries in table"));div.append($.fn.loadFileExporterUI({label:"Export as:",formatSelector:{TSV:"tsv_all",XLS:"xls_all"},"class":"gridDump"}));return div}$.fn.initDataTable=function(jqObj,customConfig){var params={bLengthChange:false,bSort:true,bInfo:false,bAutoWidth:false,iDisplayLength:10000,bRetrieve:true,bFilter:false,sPaginationType:"bootstrap",};var oTbl=jqObj.dataTable($.extend({},params,customConfig)).fnSearchHighlighting();return oTbl};function naturalSort(a,b){var x=a.toString().toLowerCase()||"",y=b.toString().toLowerCase()||"",nC=String.fromCharCode(0),xN=x.replace(/([-]{0,1}[0-9.]{1,})/g,nC+"$1"+nC).split(nC),yN=y.replace(/([-]{0,1}[0-9.]{1,})/g,nC+"$1"+nC).split(nC),xD=(new Date(x)).getTime(),yD=(new Date(y)).getTime();if(xD&&yD&&xD<yD){return -1}else{if(xD&&yD&&xD>yD){return 1}}for(var cLoc=0,numS=Math.max(xN.length,yN.length);cLoc<numS;cLoc++){if((parseFloat(xN[cLoc])||xN[cLoc])<(parseFloat(yN[cLoc])||yN[cLoc])){return -1}else{if((parseFloat(xN[cLoc])||xN[cLoc])>(parseFloat(yN[cLoc])||yN[cLoc])){return 1}}}return 0}$.fn.toggleTableRows=function(oTable){var rowNum=$(oTable).find("tbody tr").length;var rowToggler;if(rowNum>10){$(oTable).find("tbody tr:gt(9):lt("+rowNum+")").hide();var txtShow10="Show all "+rowNum+" records";rowToggler=$("<span></span>").attr({"class":"rowToggler"}).text(txtShow10).toggle(function(){$(oTable).find("tbody tr:gt(9):lt("+rowNum+")").show();$(this).text("Show first 10 records")},function(){$(oTable).find("tbody tr:gt(9):lt("+rowNum+")").hide();$(this).text(txtShow10)})}return rowToggler};$.fn.inArray=function(item,list){var length=list.length;for(var i=0;i<length;i++){if(list[i]==item){return true}}console.log("compare: "+item+" --- "+list[i]);return false};$.fn.getUnique=function(list){var u={},a=[];for(var i=0,l=list.length;i<l;++i){if(list[i] in u){continue}a.push(list[i]);u[list[i]]=1}return a};$.fn.komp2_tooltip=function(options){var defaults={title:"",color:"black",bgcolor:"#F4F4F4",mozBr:"4px",webkitBr:"4px",khtmlBr:"4px",borderRadius:"4px"};var o=$.extend(defaults,options);return this.each(function(){var oC=$(this);var sTitle=oC.attr("title");if(sTitle){oC.removeAttr("title")}else{if(o.title!=""){sTitle=o.title}else{if(o.url!=""){$.ajax({url:o.url,success:function(data){sTitle=data}})}}}oC.hover(function(event){$('<div id="tooltip" />').appendTo("body").text(sTitle).css({"max-width":"150px","font-size":"10px",border:"1px solid gray",padding:"3px 5px",color:o.color,"background-color":o.bgcolor,"z-index":999,position:"absolute","-moz-border-radius":o.mozBr,"-webkit-border-radius":o.webkitBr,"-khtml-border-radius":o.khtmlBr,"border-radius":o.borderRadius}).komp2_updatePosition(event)},function(event){$("div#tooltip").remove()})})};$.fn.komp2_updatePosition=function(event){return this.each(function(){$("div#tooltip").css({left:event.pageX+10,top:event.pageY+15})})};$.fn.upperCaseFirstLetter=function(str){return str.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})}})(jQuery);$.fn.dataTableExt.oApi.fnSearchHighlighting=function(a){if(a==null){}else{a.oPreviousSearch.oSearchCaches={};a.oApi._fnCallbackReg(a,"aoRowCallback",function(d,e,h,l){var c=[];var j=this.oApi;var b=a.oPreviousSearch.oSearchCaches;if(a.oPreviousSearch.sSearch){c.push(a.oPreviousSearch.sSearch)}if((a.aoPreSearchCols)&&(a.aoPreSearchCols.length>0)){for(var f in a.aoPreSearchCols){if(a.aoPreSearchCols[f].sSearch){c.push(a.aoPreSearchCols[f].sSearch)}}}if(c.length>0){var g=c.join("|");if(!b[g]){b[g]=new RegExp("("+g+")(?!([^<]+)?>)","i")}var k=b[g]}$("td",d).each(function(n){var m=j._fnVisibleToColumnIndex(a,n);if(e[m]){if((typeof g!=="undefined")&&(g)){this.innerHTML=e[m].replace(k,function(o){return"<span class='hit'>"+o+"</span>"})}else{this.innerHTML=e[m]}}});return d},"row-highlight");return this}};$.fn.dataTableExt.oApi.fnPagingInfo=function(a){return{iStart:a._iDisplayStart,iEnd:a.fnDisplayEnd(),iLength:a._iDisplayLength,iTotal:a.fnRecordsTotal(),iFilteredTotal:a.fnRecordsDisplay(),iPage:Math.ceil(a._iDisplayStart/a._iDisplayLength),iTotalPages:Math.ceil(a.fnRecordsDisplay()/a._iDisplayLength)}};$.extend($.fn.dataTableExt.oPagination,{bootstrap:{fnInit:function(e,b,d){var a=e.oLanguage.oPaginate;var f=function(g){g.preventDefault();if(e.oApi._fnPageChange(e,g.data.action)){d(e)}};$(b).addClass("pagination pagination-small").append('<ul><li class="prev disabled"><a href="#">&larr; '+a.sPrevious+'</a></li><li class="next disabled"><a href="#">'+a.sNext+" &rarr; </a></li></ul>");var c=$("a",b);$(c[0]).bind("click.DT",{action:"previous"},f);$(c[1]).bind("click.DT",{action:"next"},f)},fnUpdate:function(c,k){var l=5;var e=c.oInstance.fnPagingInfo();var h=c.aanFeatures.p;var g,f,d,a,m,b=Math.floor(l/2);if(e.iTotalPages<l){a=1;m=e.iTotalPages}else{if(e.iPage<=b){a=1;m=l}else{if(e.iPage>=(e.iTotalPages-b)){a=e.iTotalPages-l+1;m=e.iTotalPages}else{a=e.iPage-b+1;m=a+l-1}}}for(g=0,iLen=h.length;g<iLen;g++){$("li:gt(0)",h[g]).filter(":not(:last)").remove();for(f=a;f<=m;f++){d=(f==e.iPage+1)?'class="active"':"";$("<li "+d+'><a href="#">'+f+"</a></li>").insertBefore($("li:last",h[g])[0]).bind("click",function(j){j.preventDefault();c._iDisplayStart=(parseInt($("a",this).text(),10)-1)*e.iLength;k(c)})}if(e.iPage===0){$("li:first",h[g]).addClass("disabled")}else{$("li:first",h[g]).removeClass("disabled")}if(e.iPage===e.iTotalPages-1||e.iTotalPages===0){$("li:last",h[g]).addClass("disabled")}else{$("li:last",h[g]).removeClass("disabled")}}}}});$.extend(true,$.fn.DataTable.TableTools.DEFAULTS.oTags,{collection:{container:"ul",button:"li",liner:"a"}});$.extend($.fn.dataTableExt.oStdClasses,{sWrapper:"dataTables_wrapper form-inline"});$.extend($.fn.dataTableExt.oSort,{"alt-string-pre":function(b){return b.match(/alt="(.*?)"/)[1].toLowerCase()},"alt-string-asc":function(d,c){return((d<c)?-1:((d>c)?1:0))},"alt-string-desc":function(d,c){return((d<c)?1:((d>c)?-1:0))}});(function(a){a.widget("MPI2.geneFacet",{options:{},_create:function(){var b=this;var d=b.element.attr("id");var c=b.element;delete MPI2.searchAndFacetConfig.commonSolrParams.rows;c.find("div.facetCat").click(function(){if(c.find("span.facetCount").text()!="0"){var e=MPI2.searchAndFacetConfig.facetParams[d].gridName;var l=MPI2.searchAndFacetConfig.facetParams[d].solrCoreName;c.parent().find("div.facetCat").removeClass("facetCatUp");if(c.find(".facetCatList").is(":visible")){c.parent().find("div.facetCatList").hide();c.find(".facetCatList").hide()}else{c.parent().find("div.facetCatList").hide();c.find(".facetCatList").show();a(this).addClass("facetCatUp");var m={};var j={};m=a.extend({},MPI2.searchAndFacetConfig.commonSolrParams,MPI2.searchAndFacetConfig.facetParams[d].filterParams);if(MPI2.searchAndFacetConfig.facetParams[d].subFacet_filter_params){m.fq=MPI2.searchAndFacetConfig.facetParams[d].subFacet_filter_params}m.q=b.options.data.q;var h=a.fn.parseHashString(window.location.hash.substring(1));j.q=b.options.data.q;j.core=l;j.fq=MPI2.searchAndFacetConfig.facetParams[d].fq;if(c.find("table#gFacet td.highlight").size()==0){window.location.hash=a.fn.stringifyJsonAsUrlParams(j)}else{if(b.options.data.core!=h.coreName){var f=c.find("table#gFacet td.highlight").text();if(c.find("table#gFacet td.highlight").hasClass("geneStatus")){j.fq='status:"'+f+'"'}else{if(c.find("table#gFacet td.highlight").hasClass("geneSubtype")){j.fq='marker_type:"'+f+'"'}else{if(c.find("table#gFacet td.highlight").hasClass("phenotypingStatus")){var g=MPI2.searchAndFacetConfig.phenotypingStatuses[f].fq;var k=MPI2.searchAndFacetConfig.phenotypingStatuses[f].val;j.fq=g+':"'+k+'"'}}}window.location.hash=a.fn.stringifyJsonAsUrlParams(j);b._reloadDataTableForHashUrl()}}if(a("table#"+e).size()!=1){a.fn.invokeFacetDataTable(m,d,e)}}}});c.find("span.facetCount").click(function(g){if(a(this).text()!="0"){var e=MPI2.searchAndFacetConfig.facetParams[d].gridName;var h=MPI2.searchAndFacetConfig.facetParams[d].solrCoreName;var j={};var f={};a("table#gFacet td").removeClass("highlight");j=a.extend({},MPI2.searchAndFacetConfig.commonSolrParams,MPI2.searchAndFacetConfig.facetParams[d].filterParams);j.facetCount=a(this).text();j.q=b.options.data.q;f.q=b.options.data.q;f.core=h;f.fq=MPI2.searchAndFacetConfig.facetParams[d].fq;window.location.hash=a.fn.stringifyJsonAsUrlParams(f);if(MPI2.setHashChange==1){MPI2.setHashChange=0;a.fn.invokeFacetDataTable(j,d,e)}}})},_init:function(){var b=this;b._initFacet();a.fn.openFacet(b.options.data.core)},_initFacet:function(){var c=this;var d=a.extend({},{rows:0,facet:"on","facet.mincount":1,"facet.limit":-1,"facet.field":"marker_type","facet.sort":"count",q:c.options.data.q},MPI2.searchAndFacetConfig.commonSolrParams,MPI2.searchAndFacetConfig.facetParams.geneFacet.filterParams);var b=a.fn.stringifyJsonAsUrlParams(d)+"&facet.field=status&facet.field=imits_phenotype_started&facet.field=imits_phenotype_complete&facet.field=imits_phenotype_status";a.ajax({url:solrUrl+"/gene/select",data:b,dataType:"jsonp",jsonp:"json.wrf",success:function(e){c._displayGeneSubTypeFacet(e)}})},_displayGeneSubTypeFacet:function(D){var v=this;var s=D.response.numFound;if(s>0){var E=a("<table id='gFacet' class='facetTable'></table>");E.append(a("<tr></tr>").attr({"class":"facetSubCat"}).append(a("<td></td>").attr({colspan:3}).text("IMPC Phenotyping Status")));var l={};var k={imits_phenotype_complete:"Complete",imits_phenotype_started:"Started",imits_phenotype_status:"Attempt Registered"};for(var H in k){var y=D.facet_counts.facet_fields[H];if(y.length!=0){for(var A=0;A<y.length;A+=2){if(y[A]=="Phenotype Attempt Registered"||y[A]==1){l[k[H]]=y[A+1]}}}}var h="";var C=["Complete","Started","Attempt Registered"];for(var B=0;B<C.length;B++){var f=MPI2.searchAndFacetConfig.phenotypingStatuses[C[B]].fq;var r=MPI2.searchAndFacetConfig.phenotypingStatuses[C[B]].val;var o=l[C[B]];if(o!==undefined){var q="gene|"+f+"|";var x=a("<input></input>").attr({type:"checkbox",rel:q+r});var b=a("<tr></tr>").attr({"class":"subFacet"});var e=a("<td></td>").attr({"class":"phenotypingStatus geneSubfacet",rel:o}).text(C[B]);var p=a("<a></a>").attr({rel:r,"class":f}).text(o);var d=a("<td></td>").attr({"class":"geneSubfacetCount",rel:r}).append(p);E.append(b.append(x,e,d))}}E.append(a("<tr></tr>").attr({"class":"facetSubCat"}).append(a("<td></td>").attr({colspan:3}).text("IMPC Mouse Production Status")));var u=D.facet_counts.facet_fields["status"];var m={};for(var B=0;B<u.length;B+=2){var g=u[B];var o=u[B+1];m[g]=o}for(var B=0;B<MPI2.searchAndFacetConfig.geneStatuses.length;B++){var z=MPI2.searchAndFacetConfig.geneStatuses[B];var o=m[MPI2.searchAndFacetConfig.geneStatuses[B]];if(o!==undefined){var q="gene|status|";var x=a("<input></input>").attr({type:"checkbox",rel:q+z});var b=a("<tr></tr>").attr({"class":"subFacet"});var e=a("<td></td>").attr({"class":"geneStatus geneSubfacet",rel:o}).text(z);var p=a("<a></a>").attr({rel:z,"class":"status"}).text(o);var d=a("<td></td>").attr({"class":"geneSubfacetCount",rel:z}).append(p);E.append(b.append(x,e,d))}}var F;E.append(a("<tr></tr>").attr({"class":"facetSubCat geneSubTypeTrCap"}).append(a("<td></td>").attr({colspan:3}).text("Subtype")));var n=D.facet_counts.facet_fields["marker_type"];var G;for(var B=0;B<n.length;B+=2){var g=n[B];var o=n[B+1];var q="gene|marker_type|";var x=a("<input></input>").attr({type:"checkbox",rel:q+g});var b=a("<tr></tr>").attr({"class":"geneSubTypeTr"});var e=a("<td></td>").attr({"class":"geneSubtype geneSubfacet",rel:o}).text(g);var p=a("<a></a>").attr({rel:g,"class":"marker_type"}).text(o);var d=a("<td></td>").attr({"class":"geneSubfacetCount",rel:g}).append(p);if(g!="unclassified gene"){E.append(b.append(x,e,d))}else{G=b.append(x,e,d)}}if(G){E.append(G)}a("div#geneFacet div.facetCatList").html(E);a("tr.geneSubTypeTrCap").toggle(function(){a("tr.geneSubTypeTr").show();a(this).find("td").addClass("unCollapse")},function(){a("tr.geneSubTypeTr").hide();a(this).find("td").removeClass("unCollapse")});v._applyGeneGridResultFilterByMarkerSubFacet(a("table#gFacet td.geneSubfacetCount a"));v._addFacetFilterControl(a("table#gFacet input"))}if(v.options.data.fq!=undefined){var w=v.options.data.fq.replace(/\w+:/,"").replace(/"/g,"");var t=a("div#geneFacet div.facetCatList").find("table#gFacet td[rel='"+w+"']").find("a");a.fn.fetchFilteredDataTable(t,"geneFacet",v.options.data.q)}else{if(v.options.data.fq==undefined){var c=a.extend({},MPI2.searchAndFacetConfig.commonSolrParams,MPI2.searchAndFacetConfig.facetParams.geneFacet.filterParams);c.q=v.options.data.q;c.coreName="gene";c.facetCount=v.options.data.facetCount;a.fn.invokeFacetDataTable(c,"geneFacet",MPI2.searchAndFacetConfig.facetParams.geneFacet.gridName)}}},_applyGeneGridResultFilterByMarkerSubFacet:function(c){var b=this;c.live("click",function(){a.fn.fetchFilteredDataTable(a(this),"geneFacet",b.options.data.q,"facetFilter")})},_addFacetFilterControl:function(b){b.click(function(){console.log(a(this).attr("rel"))})},_reloadDataTableForHashUrl:function(){var c=this;var b=a.fn.parseHashString(window.location.hash.substring(1));if(typeof b.fq!=="undefined"){var e=b.fq.split(":");var f=e[0];var d=e[1].replace(/"/g,"");a.fn.fetchFilteredDataTable(a('a[rel="'+d+'"]'),"geneFacet",c.options.data.q)}},destroy:function(){a.Widget.prototype.destroy.call(this)}})}(jQuery));(function(a){a.widget("MPI2.mpFacet",{options:{},_create:function(){var b=this;var d=b.element.attr("id");var c=b.element;delete MPI2.searchAndFacetConfig.commonSolrParams.rows;c.find("div.facetCat").click(function(){if(c.find("span.facetCount").text()!="0"){var e=MPI2.searchAndFacetConfig.facetParams[d].gridName;var j=MPI2.searchAndFacetConfig.facetParams[d].solrCoreName;c.parent().find("div.facetCat").removeClass("facetCatUp");if(c.find(".facetCatList").is(":visible")){c.parent().find("div.facetCatList").hide();c.find(".facetCatList").hide()}else{c.parent().find("div.facetCatList").hide();c.find(".facetCatList").show();a(this).addClass("facetCatUp");var k={};var h={};k=a.extend({},MPI2.searchAndFacetConfig.commonSolrParams,MPI2.searchAndFacetConfig.facetParams[d].filterParams);k.facetCount=a(this).text();k.q=b.options.data.q;var g=a.fn.parseHashString(window.location.hash.substring(1));h.q=b.options.data.q;h.core=j;h.fq=MPI2.searchAndFacetConfig.facetParams[d].fq;if(c.find("table#mpFacet td.highlight").size()==0){window.location.hash=a.fn.stringifyJsonAsUrlParams(h)}else{if(b.options.data.core!=g.coreName){var f=c.find("table#mpFacet td.highlight").text()+" phenotype";h.fq='ontology_subset:* AND top_level_mp_term:"'+f+'"';window.location.hash=a.fn.stringifyJsonAsUrlParams(h);b._reloadDataTableForHashUrl(f)}}if(a("table#"+e).size()!=1){a.fn.invokeFacetDataTable(k,d,e)}}}});c.find("span.facetCount").click(function(){if(a(this).text()!="0"){var e=MPI2.searchAndFacetConfig.facetParams[d].gridName;var g=MPI2.searchAndFacetConfig.facetParams[d].solrCoreName;var h={};var f={};a("table#mpFacet td").removeClass("highlight");h=a.extend({},MPI2.searchAndFacetConfig.facetParams[d].filterParams,MPI2.searchAndFacetConfig.commonSolrParams);MPI2.searchAndFacetConfig.facetParams[d].filterParams.fq="ontology_subset:*";h.facetCount=a(this).text();h.q=b.options.data.q;f.q=b.options.data.q;f.core=g;f.fq=MPI2.searchAndFacetConfig.facetParams[d].fq;window.location.hash=a.fn.stringifyJsonAsUrlParams(f);if(MPI2.setHashChange==1){MPI2.setHashChange=0;a.fn.invokeFacetDataTable(h,d,e)}}})},_init:function(){var b=this;b._initFacet();a.fn.openFacet(b.options.data.core)},_initFacet:function(){var b=this;var c=a.extend({},{fq:"ontology_subset:*",rows:0,facet:"on","facet.mincount":1,"facet.limit":-1,"facet.field":"top_level_mp_term","facet.sort":"index","q.option":"AND",q:b.options.data.q},MPI2.searchAndFacetConfig.commonSolrParams);a.ajax({url:solrUrl+"/mp/select",data:c,dataType:"jsonp",jsonp:"json.wrf",success:function(m){a("div#mpFacet span.facetCount").attr({title:"total number of unique phenotype terms"}).text(m.response.numFound);var l=a("<table id='mpFacet' class='facetTable'></table>");var d=m.facet_counts.facet_fields.top_level_mp_term;for(var g=0;g<d.length;g+=2){var h=a("<tr></tr>").attr({rel:d[g],id:"topLevelMpTr"+g});var k=a("<input>").attr({type:"checkbox",name:"mp_"+d[g]});var f=a("<td></td>").attr({"class":"mpTopLevel",rel:d[g+1]}).text(d[g].replace(" phenotype",""));var j=a("<a></a>").attr({rel:d[g]}).text(d[g+1]);var e=a("<td></td>").attr({"class":"mpTopLevelCount"}).append(j);l.append(h.append(k,f,e))}b._displayOntologyFacet(m,"mpFacet",l)}})},_displayOntologyFacet:function(e,d,g){var c=this;var f=MPI2.searchAndFacetConfig.facetParams[d].ontology;if(e.response.numFound==0){g=null}a("div#"+d+" .facetCatList").html(g);a("table#"+f+"Facet td a").click(function(){a.fn.fetchFilteredDataTable(a(this),d,c.options.data.q,"facetFilter")});if(c.options.data.fq!="ontology_subset:*"){var b=c.options.data.fq.replace("ontology_subset:* AND top_level_mp_term:","").replace(/"/g,"");a.fn.fetchFilteredDataTable(a('a[rel="'+b+'"]'),"mpFacet",c.options.data.q)}else{var h=a.extend({},MPI2.searchAndFacetConfig.facetParams.mpFacet.filterParams,MPI2.searchAndFacetConfig.commonSolrParams);h.q=c.options.data.q;h.coreName="mp";h.facetCount=c.options.data.facetCount;a.fn.invokeFacetDataTable(h,"mpFacet",MPI2.searchAndFacetConfig.facetParams.mpFacet.gridName,c.options.data.q)}},_reloadDataTableForHashUrl:function(b){var c=this;a.fn.fetchFilteredDataTable(a('a[rel="'+b+'"]'),"mpFacet",c.options.data.q)},destroy:function(){a.Widget.prototype.destroy.call(this)}})}(jQuery));(function(a){a.widget("MPI2.maFacet",{options:{},_create:function(){var b=this;var d=b.element.attr("id");var c=b.element;delete MPI2.searchAndFacetConfig.commonSolrParams.rows;c.find("div.facetCat").click(function(){if(c.find("span.facetCount").text()!="0"){var e=MPI2.searchAndFacetConfig.facetParams[d].gridName;var j=MPI2.searchAndFacetConfig.facetParams[d].solrCoreName;c.parent().find("div.facetCat").removeClass("facetCatUp");if(c.find(".facetCatList").is(":visible")){c.parent().find("div.facetCatList").hide();c.find(".facetCatList").hide()}else{c.parent().find("div.facetCatList").hide();c.find(".facetCatList").show();a(this).addClass("facetCatUp");var k={};var h={};k=a.extend({},MPI2.searchAndFacetConfig.commonSolrParams,MPI2.searchAndFacetConfig.facetParams[d].filterParams);k.q=b.options.data.q;var g=a.fn.parseHashString(window.location.hash.substring(1));h.q=b.options.data.q;h.core=j;h.fq=MPI2.searchAndFacetConfig.facetParams[d].fq;if(c.find("table#maFacet td.highlight").size()==0){k.facetCount=a(this).siblings("span.facetCount").text();window.location.hash=a.fn.stringifyJsonAsUrlParams(h)}else{k.facetCount=c.find("table#maFacet td.highlight").attr("rel");if(b.options.data.core!=g.coreName){var f=c.find("table#maFacet td.highlight").text();k.topLevelName=f;h.fq=k.fq='ontology_subset:IMPC_Terms AND selected_top_level_ma_term:"'+f+'"';window.location.hash=a.fn.stringifyJsonAsUrlParams(h);b._reloadDataTableForHashUrl(f)}}if(a("table#"+e).size()!=1){a.fn.invokeFacetDataTable(k,d,e)}}}});MPI2.searchAndFacetConfig.facetParams.maFacet.srchParams.rows=1000;c.find("span.facetCount").click(function(){if(a(this).text()!="0"){var e=MPI2.searchAndFacetConfig.facetParams[d].gridName;var g=MPI2.searchAndFacetConfig.facetParams[d].solrCoreName;var h={};var f={};a("table#maFacet td").removeClass("highlight");h=a.extend({},MPI2.searchAndFacetConfig.facetParams[d].filterParams,MPI2.searchAndFacetConfig.commonSolrParams);h.facetCount=a(this).text();h.q=b.options.data.q;f.q=b.options.data.q;f.core=g;f.fq=MPI2.searchAndFacetConfig.facetParams[d].fq;window.location.hash=a.fn.stringifyJsonAsUrlParams(f);if(MPI2.setHashChange==1){MPI2.setHashChange=0;a.fn.invokeFacetDataTable(h,d,e)}}})},_init:function(){var b=this;b._initFacet();a.fn.openFacet(b.options.data.core)},_initFacet:function(){var b=this;var c=a.extend({},{fq:MPI2.searchAndFacetConfig.facetParams.maFacet.filterParams.fq,rows:0,facet:"on","facet.mincount":1,"facet.limit":-1,"facet.field":"selected_top_level_ma_term","facet.sort":"index","q.option":"AND",q:b.options.data.q},MPI2.searchAndFacetConfig.commonSolrParams);a.ajax({url:solrUrl+"/ma/select",data:c,dataType:"jsonp",jsonp:"json.wrf",success:function(m){a("div#maFacet span.facetCount").attr({title:"total number of unique MA terms"}).text(m.response.numFound);var l=a("<table id='maFacet' class='facetTable'></table>");var d=m.facet_counts.facet_fields.selected_top_level_ma_term;for(var g=0;g<d.length;g+=2){var h=a("<tr></tr>").attr({rel:d[g],id:"topLevelMaTr"+g});var k="<input type=checkbox name=ma_"+d[g]+">";var f=a("<td></td>").attr({"class":"maTopLevel",rel:d[g+1]}).text(d[g]);var j=a("<a></a>").attr({rel:d[g]}).text(d[g+1]);var e=a("<td></td>").attr({"class":"maTopLevelCount"}).append(j);l.append(h.append(k,f,e))}b._displayOntologyFacet(m,"maFacet",l)}})},_displayOntologyFacet:function(e,d,g){var c=this;var f=MPI2.searchAndFacetConfig.facetParams[d].ontology;if(e.response.numFound==0){g=null}a("div#"+d+" .facetCatList").html(g);a("table#"+f+"Facet td a").click(function(){a.fn.fetchFilteredDataTable(a(this),d,c.options.data.q,"facetFilter")});if(c.options.data.fq!="ontology_subset:IMPC_Terms AND selected_top_level_ma_term:*"){var b=c.options.data.fq.replace("ontology_subset:IMPC_Terms AND selected_top_level_ma_term:","").replace(/"/g,"");a.fn.fetchFilteredDataTable(a('a[rel="'+b+'"]'),"maFacet",c.options.data.q)}else{var h=a.extend({},MPI2.searchAndFacetConfig.facetParams.maFacet.filterParams,MPI2.searchAndFacetConfig.commonSolrParams);h.q=c.options.data.q;h.coreName="ma";h.facetCount=c.options.data.facetCount;a.fn.invokeFacetDataTable(h,"maFacet",MPI2.searchAndFacetConfig.facetParams.maFacet.gridName,c.options.data.q)}},_reloadDataTableForHashUrl:function(b){var c=this;a.fn.fetchFilteredDataTable(a('a[rel="'+b+'"]'),"maFacet",c.options.data.q)},destroy:function(){a.Widget.prototype.destroy.call(this)}})}(jQuery));(function(a){a.widget("MPI2.pipelineFacet",{options:{},_create:function(){var b=this;var d=b.element.attr("id");var c=b.element;delete MPI2.searchAndFacetConfig.commonSolrParams.rows;c.find("div.facetCat").click(function(){if(c.find("span.facetCount").text()!="0"){var e=MPI2.searchAndFacetConfig.facetParams[d].gridName;var j=MPI2.searchAndFacetConfig.facetParams[d].solrCoreName;c.parent().find("div.facetCat").removeClass("facetCatUp");if(c.find(".facetCatList").is(":visible")){c.parent().find("div.facetCatList").hide();c.find(".facetCatList").hide()}else{c.parent().find("div.facetCatList").hide();c.find(".facetCatList").show();a(this).addClass("facetCatUp");var k={};var h={};k=a.extend({},MPI2.searchAndFacetConfig.commonSolrParams,MPI2.searchAndFacetConfig.facetParams[d].filterParams);k.facetCount=a(this).text();k.q=b.options.data.q;var g=a.fn.parseHashString(window.location.hash.substring(1));h.q=b.options.data.q;h.core=j;h.fq=MPI2.searchAndFacetConfig.facetParams[d].fq;if(c.find("table#pipeline td.highlight").size()==0){window.location.hash=a.fn.stringifyJsonAsUrlParams(h)}else{if(b.options.data.core!=g.coreName){var f=c.find("table#pipeline td.highlight").siblings("td").find("a").attr("rel");h.fq="procedure_stable_id:"+f;window.location.hash=a.fn.stringifyJsonAsUrlParams(h);b._reloadDataTableForHashUrl(f)}}if(a("table#"+e).size()!=1){a.fn.invokeFacetDataTable(k,d,e)}}}});c.find("span.facetCount").click(function(){if(a(this).text()!="0"){var e=MPI2.searchAndFacetConfig.facetParams[d].gridName;var g=MPI2.searchAndFacetConfig.facetParams[d].solrCoreName;var h={};var f={};a("table#pipeline td[class^=procedure]").removeClass("highlight");h=a.extend({},MPI2.searchAndFacetConfig.facetParams[d].filterParams,MPI2.searchAndFacetConfig.commonSolrParams);MPI2.searchAndFacetConfig.facetParams[d].filterParams.fq="pipeline_stable_id:IMPC_001";h.facetCount=a(this).text();h.q=b.options.data.q;f.q=b.options.data.q;f.core=g;f.fq=MPI2.searchAndFacetConfig.facetParams[d].fq;window.location.hash=a.fn.stringifyJsonAsUrlParams(f);if(MPI2.setHashChange==1){MPI2.setHashChange=0;a.fn.invokeFacetDataTable(h,d,e)}}})},_init:function(){var b=this;b._initFacet();a.fn.openFacet(b.options.data.core)},_initFacet:function(){var b=this;var d=[];var c=a.extend({},{fq:"pipeline_stable_id:IMPC_001",rows:500000,facet:"on","facet.mincount":1,"facet.limit":-1,"facet.field":"procedure_name","facet.sort":"index",fl:"parameter_name,parameter_stable_key,parameter_stable_id,procedure_name,procedure_stable_key,procedure_stable_id",q:b.options.data.q},MPI2.searchAndFacetConfig.commonSolrParams);a.ajax({url:solrUrl+"/pipeline/select",data:c,dataType:"jsonp",jsonp:"json.wrf",success:function(w){a("div#pipelineFacet .facetCount").attr({title:"total number of unique parameter terms"}).text(w.response.numFound);var h={};var p=0;var k=b._doNames2IdMapping(w.response);var j=k[0];var y=k[1];var A=w.facet_counts.facet_fields["procedure_name"];var x=a("<table id='pipeline' class='facetTable'></table>");var n=a("<tr></tr>").attr({"class":"facetSubCat"});x.append(n.append(a("<td></td>").attr({colspan:3}).text("IMPC")));for(var v=0;v<A.length;v+=2){var s=A[v];var e=A[v+1];var r="procedure"+v;var g=a("<tr></tr>").attr({"class":"subFacet"});var t="<input type=checkbox name=pipeline_"+j[s].stable_id+">";var o=a("<td></td>").attr({"class":r,rel:e});var m=a("<td></td>");var z=a("<a></a>").attr({"class":"paramCount",rel:j[s].stable_id}).text(e);x.append(g.append(t,o.text(s),m.append(z)))}if(w.response.numFound==0){x=null}a("div#pipelineFacet .facetCatList").html(x);a("table#pipeline td a.paramCount").click(function(){a.fn.fetchFilteredDataTable(a(this),"pipelineFacet",b.options.data.q,"facetFilter")});if(b.options.data.fq.match(/pipeline_stable_id.+/)){var l=a.extend({},MPI2.searchAndFacetConfig.facetParams.pipelineFacet.filterParams,MPI2.searchAndFacetConfig.commonSolrParams);l.q=b.options.data.q;l.coreName="pipeline";l.facetCount=b.options.data.facetCount;a.fn.invokeFacetDataTable(l,"pipelineFacet",MPI2.searchAndFacetConfig.facetParams.pipelineFacet.gridName,b.options.data.q)}else{var u=b.options.data.fq.replace("procedure_stable_id:","");var q=a("div#pipelineFacet div.facetCatList").find("table#pipeline a[rel='"+u+"']");a.fn.fetchFilteredDataTable(q,"pipelineFacet",b.options.data.q)}}})},_doNames2IdMapping:function(g){var c=g.docs;var m={};var f={};for(var d=0;d<c.length;d++){var e=c[d];var l=e.procedure_name;var j=e.procedure_stable_id;var b=e.procedure_stable_key;var h=e.parameter_name;var o=e.parameter_stable_id;var k=e.parameter_stable_key;if(!m[l]){m[l]={}}if(!f[h]){f[h]={}}m[l]={stable_id:j,stable_key:b};f[h]={stable_id:o,stable_key:k}}return[m,f]},_reloadDataTableForHashUrl:function(b){var c=this;a.fn.fetchFilteredDataTable(a('a[rel="'+b+'"]'),"pipelineFacet",c.options.data.q)},destroy:function(){a.Widget.prototype.destroy.call(this)}})}(jQuery));(function(a){a.widget("MPI2.imagesFacet",{options:{},_create:function(){var b=this;var d=b.element.attr("id");var c=b.element;delete MPI2.searchAndFacetConfig.commonSolrParams.rows;c.find("div.facetCat").click(function(){if(c.find("span.facetCount").text()!="0"){var e=MPI2.searchAndFacetConfig.facetParams[d].gridName;var j=MPI2.searchAndFacetConfig.facetParams[d].solrCoreName;c.parent().find("div.facetCat").removeClass("facetCatUp");if(c.find(".facetCatList").is(":visible")){c.parent().find("div.facetCatList").hide();c.find(".facetCatList").hide()}else{c.parent().find("div.facetCatList").hide();c.find(".facetCatList").show();a(this).addClass("facetCatUp");var k={};var h={};k=a.extend({},MPI2.searchAndFacetConfig.commonSolrParams,MPI2.searchAndFacetConfig.facetParams[d].filterParams);k.facetCount=a(this).text();k.q=b.options.data.q;var g=a.fn.parseHashString(window.location.hash.substring(1));h.q=b.options.data.q;h.core=j;h.fq=MPI2.searchAndFacetConfig.facetParams[d].fq;if(c.find("table#imgFacet td.highlight").size()==0){window.location.hash=a.fn.stringifyJsonAsUrlParams(h)}else{if(b.options.data.core!=g.coreName){var f=c.find("table#imgFacet td.highlight").siblings("td").find("a").attr("class");h.fq=f;window.location.hash=a.fn.stringifyJsonAsUrlParams(h);b._reloadDataTableForHashUrl(f)}}if(a("table#"+e).size()!=1){a.fn.invokeFacetDataTable(k,d,e,b.options.data.q)}}}});c.find("span.facetCount").click(function(){if(a(this).text()!="0"){var e=MPI2.searchAndFacetConfig.facetParams[d].gridName;var g=MPI2.searchAndFacetConfig.facetParams[d].solrCoreName;var h={};var f={};a("table#imgFacet td").removeClass("highlight");h=a.extend({},MPI2.searchAndFacetConfig.facetParams[d].filterParams,MPI2.searchAndFacetConfig.commonSolrParams);h.facetCount=a(this).text();h.q=b.options.data.q;f.q=b.options.data.q;f.core=g;f.fq=MPI2.searchAndFacetConfig.facetParams[d].fq;window.location.hash=a.fn.stringifyJsonAsUrlParams(f);if(MPI2.setHashChange==1){MPI2.setHashChange=0;a.fn.invokeFacetDataTable(h,d,e,b.options.data.q)}}})},_init:function(){var b=this;b._initFacet();a.fn.openFacet(b.options.data.core)},_initFacet:function(){var b=this;var c=a.extend({},{rows:0,facet:"on","facet.mincount":1,"facet.limit":-1,"facet.sort":"index",fl:"annotationTermId,annotationTermName,expName,symbol","q.option":"AND",q:b.options.data.q},MPI2.searchAndFacetConfig.commonSolrParams);var d=a.fn.stringifyJsonAsUrlParams(c)+"&facet.field=expName&facet.field=higherLevelMaTermName&facet.field=higherLevelMpTermName&facet.field=subtype";a.ajax({url:solrUrl+"/images/select",data:d,dataType:"jsonp",jsonp:"json.wrf",success:function(t){a("div#imagesFacet span.facetCount").attr({title:"total number of unique images"}).html(t.response.numFound);var u=a("<table id='imgFacet' class='facetTable'></table>");var v=t.facet_counts.facet_fields;var e={higherLevelMaTermName:"Anatomy",expName:"Procedure",higherLevelMpTermName:"Phenotype",subtype:"Gene"};for(var r in v){for(var s=0;s<v[r].length;s+=2){var k=v[r][s];var q=v[r][s+1];var n=e[r];var g=a("<tr></tr>").attr({rel:k,id:"topLevelImgTr"+s,"class":"subFacet"});var m=a("<td></td>").attr({"class":"imgSubfacet",rel:q}).text(k);var o=baseUrl+"/images?";var x="q="+b.options.data.q;x+="&q.option=AND&qf="+c.qf+"&defType=edismax&wt=json&fq="+r+":";x+='"'+k+'"';var h=r+':"'+k+'"';var A=o+x;var z='{params:"'+encodeURI(x)+'", fullLink:"'+encodeURI(A)+'",imgType:"'+n+'",imgSubName:"'+k+'", imgCount:"'+q+'", solrCoreName:"images", mode:"imageGrid"}';var y=a("<a></a>").attr({rel:z,"class":h}).text(q);var j=a("<td></td>").attr({"class":"imgSubfacetCount"}).append(y);if(s==0){var w=a("<tr></tr>").attr({"class":"facetSubCat"});var f=e[r];var l=a("<td></td>").attr({colspan:3}).text(f);w.append(l);u.append(w)}var p="<input type=checkbox name=images_"+h+">";u.append(g.append(p,m,j))}}b._displayImageFacet(t,"images","imagesFacet",u)}})},_displayImageFacet:function(e,b,d,f){var c=this;var h=c.options.solrBaseURL_ebi+b+"/select";if(e.response.numFound==0){f=null}else{a("div#"+d+" .facetCatList").html(f);f.find("td a").click(function(){MPI2.searchAndFacetConfig.facetParams[d].showImgView=true;a.fn.fetchFilteredDataTable(a(this),d,c.options.data.q,"facetFilter")})}if(c.options.data.fq.match(/annotationTermId.+/)){var j=a.extend({},MPI2.searchAndFacetConfig.facetParams[d].filterParams,MPI2.searchAndFacetConfig.commonSolrParams);j.q=c.options.data.q;j.coreName="images";j.facetCount=c.options.data.facetCount;if(j.q.indexOf("*")==-1){j.qf="text_search"}a.fn.invokeFacetDataTable(j,d,MPI2.searchAndFacetConfig.facetParams[d].gridName,true)}else{if(c.options.data.fq.match(/expName.+|higherLevel.+|subtype.+/)){var g=a("div#imagesFacet div.facetCatList").find("table#imgFacet a[class='"+c.options.data.fq+"']");a.fn.fetchFilteredDataTable(g,"imagesFacet",c.options.data.q)}}a("div#facetBrowser").html(MPI2.searchAndFacetConfig.endOfSearch)},_reloadDataTableForHashUrl:function(b){var c=this;a.fn.fetchFilteredDataTable(a('a[class="'+b+'"]'),"imagesFacet",c.options.data.q)},destroy:function(){a.Widget.prototype.destroy.call(this)}})}(jQuery));(function(d){d.fn.fetchSolrFacetCount=function(h){var j={};j.count={};MPI2.searchAndFacetConfig.facetParams.geneFacet.srchParams.q=h;d.ajax({url:solrUrl+"/gene/select",data:MPI2.searchAndFacetConfig.facetParams.geneFacet.srchParams,dataType:"jsonp",jsonp:"json.wrf",timeout:5000,success:function(k){d("div#geneFacet span.facetCount").html(MPI2.searchAndFacetConfig.searchSpin);j.count.gene=k.response.numFound;d("div#geneFacet span.facetCount").html(j.count.gene);g(k,h,j)},error:function(k,m,l){d("div#facetBrowser").html("Error fetching data ...")}})};function g(h,j,k){MPI2.searchAndFacetConfig.facetParams.mpFacet.srchParams.q=j;d.ajax({url:solrUrl+"/mp/select",data:MPI2.searchAndFacetConfig.facetParams.mpFacet.srchParams,dataType:"jsonp",jsonp:"json.wrf",timeout:5000,success:function(l){d("div#mpFacet span.facetCount").html(MPI2.searchAndFacetConfig.searchSpin);k.count.mp=l.response.numFound;d("div#mpFacet span.facetCount").html(k.count.mp);f(h,l,j,k)},error:function(l,n,m){d("div#facetBrowser").html("Error fetching data ...")}})}function f(h,j,k,l){MPI2.searchAndFacetConfig.facetParams.pipelineFacet.srchParams.q=k;d.ajax({url:solrUrl+"/pipeline/select",data:MPI2.searchAndFacetConfig.facetParams.pipelineFacet.srchParams,dataType:"jsonp",jsonp:"json.wrf",timeout:5000,success:function(m){d("div#pipelineFacet span.facetCount").html(MPI2.searchAndFacetConfig.searchSpin);l.count.pipeline=m.response.numFound;d("div#pipelineFacet span.facetCount").html(l.count.pipeline);b(h,j,m,k,l)},error:function(m,o,n){d("div#facetBrowser").html("Error fetching data ...")}})}function b(j,k,h,l,m){MPI2.searchAndFacetConfig.facetParams.maFacet.srchParams.q=l;MPI2.searchAndFacetConfig.facetParams.maFacet.srchParams.sort="ma_term asc";MPI2.searchAndFacetConfig.facetParams.maFacet.srchParams.fq=MPI2.searchAndFacetConfig.facetParams.maFacet.filterParams.fq;d.ajax({url:solrUrl+"/ma/select",data:MPI2.searchAndFacetConfig.facetParams.maFacet.srchParams,dataType:"jsonp",jsonp:"json.wrf",timeout:10000,success:function(n){d("div#maFacet span.facetCount").html(MPI2.searchAndFacetConfig.searchSpin);m.count.ma=n.response.numFound;d("div#maFacet span.facetCount").html(m.count.ma);a(j,k,h,n,l,m)},error:function(n,p,o){d("div#facetBrowser").html("Error fetching data ...")}})}function a(j,l,h,k,m,n){MPI2.searchAndFacetConfig.facetParams.imagesFacet.srchParams.q=m;d.ajax({url:solrUrl+"/images/select",data:MPI2.searchAndFacetConfig.facetParams.imagesFacet.srchParams,dataType:"jsonp",jsonp:"json.wrf",timeout:5000,success:function(t){d("div#imagesFacet span.facetCount").html(MPI2.searchAndFacetConfig.searchSpin);n.count.images=t.response.numFound;d("div#imagesFacet span.facetCount").html(n.count.images);var r=d.fn.parseHashString(window.location.hash.substring(1));var p=r.coreName?r.coreName:c(n.count);d("div#facetBrowser").html("Search results ...");if(!p){d("div#userKeyword").html("Search keyword: "+m+" has returned no entry in the database");d("div#mpi2-search").html("");d("div.facetCatList").html("");d("div.facetCat").removeClass("facetCatUp")}else{d("div.facetCatList").html("");var v=p+"Facet";window.jQuery("div#"+p+"Facet")[v]({data:{q:m,core:p,fq:r.fq?r.fq:MPI2.searchAndFacetConfig.facetParams[v].fq,qf:MPI2.searchAndFacetConfig.facetParams[v].qf,facetCount:n.count[p]},geneGridElem:"div#mpi2-search"});var o=MPI2.searchAndFacetConfig.cores;var s;for(var u=0;u<o.length;u++){if(o[u]==p){s=u}}o.splice(s,1);for(var u=0;u<o.length;u++){var q=o[u];if(n.count[q]!=0){e(q,m,n)}}}},error:function(o,q,p){d("div#facetBrowser").html("Error fetching data ...")}})}function e(h,k,l){var j=h+"Facet";window.jQuery("div#"+h+"Facet").click(function(){var n=window.jQuery(this);if(typeof n.data(j)==="undefined"){var m={};m.q=k;m.core=h;m.fq=MPI2.searchAndFacetConfig.facetParams[h+"Facet"].fq;window.location.hash=d.fn.stringifyJsonAsUrlParams(m);if(n.find(".facetCatList").html()==""&&n.find("span.facetCount").text()!="0"){n[j]({data:{q:k,core:h,fq:MPI2.searchAndFacetConfig.facetParams[h+"Facet"].fq,qf:MPI2.searchAndFacetConfig.facetParams[h+"Facet"].qf,facetCount:l.count[h]},geneGridElem:"div#mpi2-search"})}}})}function c(h){if(h.gene!=0){return"gene"}else{if(h.mp!=0){return"mp"}else{if(h.ma!=0){return"ma"}else{if(h.pipeline!=0){return"pipeline"}else{if(h.images!=0){return"images"}else{return false}}}}}}})(jQuery);$(document).ready(function(){$("span.facetCount").text("");$("input#userInput").val("");if(/search\/?$/.exec(location.href)){$.fn.fetchSolrFacetCount("*:*")}else{if(location.href.indexOf("/search#")!=-1){var a=$.fn.parseHashString(window.location.hash.substring(1));$.fn.fetchSolrFacetCount(a.q)}}$("input#userInput").keyup(function(c){if(c.keyCode==13){var b=$("input#userInput").val();console.log("user input search: "+b);if(b==""){document.location.href=baseUrl+"/search"}else{document.location.href=baseUrl+"/search#q="+b}}}).click(function(){$(this).val("")});$("button#acSearch").click(function(){var b=$("input#userInput").val();console.log("button search in search and facet= "+b);if(b==""){document.location.href=baseUrl+"/search"}else{document.location.href=baseUrl+"/search#q="+b}});window.jQuery(window).resize(function(){var b=window.jQuery("input#userInput").offset();window.jQuery("ul.ui-autocomplete").css({position:"absolute",top:b.top+26,left:b.left})})});